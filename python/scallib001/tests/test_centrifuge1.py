
import numpy as np
import pandas as pd
from scallib001.utils import dictn
import scallib001.relpermlib001 as rlplib
from scallib001.displacementmodel1D2P001 import DisplacementModel1D2P

# test_centrifuge_imbibition.py

def test_imbibition0():

   SW_TOLERANCE = 0.01

   reference = pd.DataFrame(
     columns = ['TIME','Sw'],
     data = [
       [ -1.00000000E-07 ,  0.00000000E+00 ],
       [  2.77777778E-04 ,  7.50000000E-02 ],
       [  6.11111111E-04 ,  7.50002271E-02 ],
       [  7.02791106E-04 ,  7.50010521E-02 ],
       [  7.35016344E-04 ,  7.50013833E-02 ],
       [  7.73686629E-04 ,  7.50014655E-02 ],
       [  8.20090972E-04 ,  7.50019104E-02 ],
       [  8.75776183E-04 ,  7.50029854E-02 ],
       [  9.42598436E-04 ,  7.50050424E-02 ],
       [  1.02278514E-03 ,  7.50086043E-02 ],
       [  1.11900918E-03 ,  7.50144687E-02 ],
       [  1.23447804E-03 ,  7.50238137E-02 ],
       [  1.37304066E-03 ,  7.50384325E-02 ],
       [  1.53931581E-03 ,  7.50611562E-02 ],
       [  1.73884599E-03 ,  7.50967775E-02 ],
       [  1.97828220E-03 ,  7.51542823E-02 ],
       [  2.26560566E-03 ,  7.52411796E-02 ],
       [  2.61039381E-03 ,  7.53373087E-02 ],
       [  3.02413959E-03 ,  7.54477204E-02 ],
       [  3.52063452E-03 ,  7.55750990E-02 ],
       [  4.11642844E-03 ,  7.57210632E-02 ],
       [  4.83138115E-03 ,  7.58873827E-02 ],
       [  5.68932439E-03 ,  7.60774149E-02 ],
       [  6.71885629E-03 ,  7.62968216E-02 ],
       [  7.95429456E-03 ,  7.65512905E-02 ],
       [  9.43682049E-03 ,  7.68448171E-02 ],
       [  1.12158516E-02 ,  7.71808012E-02 ],
       [  1.33506889E-02 ,  7.75633918E-02 ],
       [  1.59124937E-02 ,  7.80014676E-02 ],
       [  1.89866595E-02 ,  7.85070219E-02 ],
       [  2.26756584E-02 ,  7.90890009E-02 ],
       [  2.71024571E-02 ,  7.97529424E-02 ],
       [  3.24146156E-02 ,  8.05026029E-02 ],
       [  3.87892057E-02 ,  8.13505619E-02 ],
       [  4.64387139E-02 ,  8.23210429E-02 ],
       [  5.56181237E-02 ,  8.34323992E-02 ],
       [  6.66334154E-02 ,  8.46887475E-02 ],
       [  7.98517655E-02 ,  8.60845364E-02 ],
       [  9.57137856E-02 ,  8.76457530E-02 ],
       [  1.14748210E-01 ,  8.94045973E-02 ],
       [  1.37589519E-01 ,  9.13612011E-02 ],
       [  1.64999089E-01 ,  9.35091772E-02 ],
       [  1.97890574E-01 ,  9.58835609E-02 ],
       [  2.37360356E-01 ,  9.84798543E-02 ],
       [  2.84724095E-01 ,  1.01302593E-01 ],
       [  3.41560581E-01 ,  1.04362383E-01 ],
       [  4.09764364E-01 ,  1.07657488E-01 ],
       [  4.91608903E-01 ,  1.11181130E-01 ],
       [  5.89822351E-01 ,  1.14931293E-01 ],
       [  7.07678488E-01 ,  1.18885770E-01 ],
       [  8.49105853E-01 ,  1.23039426E-01 ],
       [  1.01881869E+00 ,  1.27356301E-01 ],
       [  1.22247410E+00 ,  1.31811965E-01 ],
       [  1.46686058E+00 ,  1.36374956E-01 ],
       [  1.76012437E+00 ,  1.41000508E-01 ],
       [  2.11204091E+00 ,  1.45646489E-01 ],
       [  2.53434075E+00 ,  1.50266700E-01 ],
       [  3.04110057E+00 ,  1.54810172E-01 ],
       [  3.64921235E+00 ,  1.59231638E-01 ],
       [  4.37894649E+00 ,  1.63476744E-01 ],
       [  5.25462745E+00 ,  1.67502882E-01 ],
       [  6.30544461E+00 ,  1.71274326E-01 ],
       [  7.56642520E+00 ,  1.74751045E-01 ],
       [  9.07960191E+00 ,  1.77915836E-01 ],
       [  1.08954140E+01 ,  1.80752079E-01 ],
       [  1.30743884E+01 ,  1.83257557E-01 ],
       [  1.56891578E+01 ,  1.85440756E-01 ],
       [  1.88268810E+01 ,  1.87322707E-01 ],
       [  2.25921489E+01 ,  1.88932398E-01 ],
       [  2.71104703E+01 ,  1.90300863E-01 ],
       [  3.25324560E+01 ,  1.91467245E-01 ],
       [  3.80880116E+01 ,  1.92353637E-01 ],
       [  4.10000000E+01 ,  1.92752548E-01 ],
       [  4.65555556E+01 ,  1.93353434E-01 ],
       [  4.80000000E+01 ,  1.93499699E-01 ],
       [  4.80002778E+01 ,  1.93499728E-01 ],
       [  4.80005556E+01 ,  1.93523088E-01 ],
       [  4.80008333E+01 ,  1.93570597E-01 ],
       [  4.80011667E+01 ,  1.93634182E-01 ],
       [  4.80015667E+01 ,  1.93708975E-01 ],
       [  4.80020467E+01 ,  1.93798117E-01 ],
       [  4.80026227E+01 ,  1.93904375E-01 ],
       [  4.80033139E+01 ,  1.94031020E-01 ],
       [  4.80041433E+01 ,  1.94181929E-01 ],
       [  4.80051386E+01 ,  1.94361686E-01 ],
       [  4.80063330E+01 ,  1.94575710E-01 ],
       [  4.80077663E+01 ,  1.94830386E-01 ],
       [  4.80094862E+01 ,  1.95133222E-01 ],
       [  4.80115501E+01 ,  1.95493028E-01 ],
       [  4.80140268E+01 ,  1.95920100E-01 ],
       [  4.80169989E+01 ,  1.96426433E-01 ],
       [  4.80205653E+01 ,  1.97025934E-01 ],
       [  4.80248450E+01 ,  1.97734643E-01 ],
       [  4.80299807E+01 ,  1.98570949E-01 ],
       [  4.80361435E+01 ,  1.99555780E-01 ],
       [  4.80435389E+01 ,  2.00712720E-01 ],
       [  4.80524133E+01 ,  2.02068106E-01 ],
       [  4.80630627E+01 ,  2.03650983E-01 ],
       [  4.80758419E+01 ,  2.05492854E-01 ],
       [  4.80911769E+01 ,  2.07627246E-01 ],
       [  4.81095790E+01 ,  2.10088912E-01 ],
       [  4.81316614E+01 ,  2.12912676E-01 ],
       [  4.81581604E+01 ,  2.16132040E-01 ],
       [  4.81899591E+01 ,  2.19777022E-01 ],
       [  4.82281176E+01 ,  2.23872512E-01 ],
       [  4.82739078E+01 ,  2.28435458E-01 ],
       [  4.83288560E+01 ,  2.33473467E-01 ],
       [  4.83947939E+01 ,  2.38980920E-01 ],
       [  4.84739193E+01 ,  2.44937982E-01 ],
       [  4.85688698E+01 ,  2.51303231E-01 ],
       [  4.86828105E+01 ,  2.58018048E-01 ],
       [  4.88195392E+01 ,  2.64996865E-01 ],
       [  4.89836137E+01 ,  2.72132728E-01 ],
       [  4.91805031E+01 ,  2.79308741E-01 ],
       [  4.94167704E+01 ,  2.86400331E-01 ],
       [  4.97002912E+01 ,  2.93277211E-01 ],
       [  5.00405161E+01 ,  2.99822687E-01 ],
       [  5.04487859E+01 ,  3.05921396E-01 ],
       [  5.09387098E+01 ,  3.11468253E-01 ],
       [  5.15266184E+01 ,  3.16394103E-01 ],
       [  5.22321088E+01 ,  3.20659347E-01 ],
       [  5.30786972E+01 ,  3.24261730E-01 ],
       [  5.40946033E+01 ,  3.27239296E-01 ],
       [  5.53136906E+01 ,  3.29638094E-01 ],
       [  5.67765954E+01 ,  3.31538268E-01 ],
       [  5.85320812E+01 ,  3.33033210E-01 ],
       [  6.06386641E+01 ,  3.34200876E-01 ],
       [  6.31665636E+01 ,  3.35113380E-01 ],
       [  6.62000430E+01 ,  3.35833824E-01 ],
       [  6.98402182E+01 ,  3.36416934E-01 ],
       [  7.42084285E+01 ,  3.36893914E-01 ],
       [  7.94502809E+01 ,  3.37289066E-01 ],
       [  8.20000000E+01 ,  3.37449990E-01 ],
       [  8.75555556E+01 ,  3.37715219E-01 ],
       [  9.31111111E+01 ,  3.37927020E-01 ],
       [  9.86666667E+01 ,  3.38102180E-01 ],
       [  9.93300000E+01 ,  3.38122591E-01 ],
       [  9.93302778E+01 ,  3.38122599E-01 ],
       [  9.93305556E+01 ,  3.38141106E-01 ],
       [  9.93308333E+01 ,  3.38177179E-01 ],
       [  9.93311667E+01 ,  3.38224173E-01 ],
       [  9.93315667E+01 ,  3.38279329E-01 ],
       [  9.93320467E+01 ,  3.38345456E-01 ],
       [  9.93326227E+01 ,  3.38424732E-01 ],
       [  9.93333139E+01 ,  3.38519754E-01 ],
       [  9.93341433E+01 ,  3.38633623E-01 ],
       [  9.93351386E+01 ,  3.38770044E-01 ],
       [  9.93363330E+01 ,  3.38933431E-01 ],
       [  9.93377663E+01 ,  3.39129042E-01 ],
       [  9.93394862E+01 ,  3.39363127E-01 ],
       [  9.93415501E+01 ,  3.39643102E-01 ],
       [  9.93440268E+01 ,  3.39977750E-01 ],
       [  9.93469989E+01 ,  3.40377441E-01 ],
       [  9.93505653E+01 ,  3.40854379E-01 ],
       [  9.93548450E+01 ,  3.41422883E-01 ],
       [  9.93599807E+01 ,  3.42099643E-01 ],
       [  9.93661435E+01 ,  3.42904025E-01 ],
       [  9.93735389E+01 ,  3.43858330E-01 ],
       [  9.93824133E+01 ,  3.44988011E-01 ],
       [  9.93930627E+01 ,  3.46321856E-01 ],
       [  9.94058419E+01 ,  3.47891923E-01 ],
       [  9.94211769E+01 ,  3.49733298E-01 ],
       [  9.94395790E+01 ,  3.51883776E-01 ],
       [  9.94616614E+01 ,  3.54382612E-01 ],
       [  9.94881604E+01 ,  3.57269320E-01 ],
       [  9.95199591E+01 ,  3.60582118E-01 ],
       [  9.95581176E+01 ,  3.64354665E-01 ],
       [  9.96039078E+01 ,  3.68613275E-01 ],
       [  9.96588560E+01 ,  3.73373105E-01 ],
       [  9.97247939E+01 ,  3.78634150E-01 ],
       [  9.98039193E+01 ,  3.84380046E-01 ],
       [  9.98988698E+01 ,  3.90566797E-01 ],
       [  1.00012810E+02 ,  3.97122599E-01 ],
       [  1.00149539E+02 ,  4.03957336E-01 ],
       [  1.00313614E+02 ,  4.10937851E-01 ],
       [  1.00510503E+02 ,  4.17930205E-01 ],
       [  1.00746770E+02 ,  4.24779989E-01 ],
       [  1.01030291E+02 ,  4.31333578E-01 ],
       [  1.01370516E+02 ,  4.37475420E-01 ],
       [  1.01778786E+02 ,  4.43086336E-01 ],
       [  1.02268710E+02 ,  4.48089690E-01 ],
       [  1.02856618E+02 ,  4.52458333E-01 ],
       [  1.03562109E+02 ,  4.56177003E-01 ],
       [  1.04408697E+02 ,  4.59252814E-01 ],
       [  1.05424603E+02 ,  4.61731064E-01 ],
       [  1.06643691E+02 ,  4.63678282E-01 ],
       [  1.08106595E+02 ,  4.65164421E-01 ],
       [  1.09862081E+02 ,  4.66261528E-01 ],
       [  1.11968664E+02 ,  4.67046380E-01 ],
       [  1.14496564E+02 ,  4.67596210E-01 ],
       [  1.17530043E+02 ,  4.67978940E-01 ],
       [  1.21170218E+02 ,  4.68248332E-01 ],
       [  1.23000000E+02 ,  4.68351921E-01 ],
       [  1.27368210E+02 ,  4.68511787E-01 ],
       [  1.32610063E+02 ,  4.68643747E-01 ],
       [  1.38165618E+02 ,  4.68748485E-01 ],
       [  1.43721174E+02 ,  4.68832020E-01 ],
       [  1.47300000E+02 ,  4.68879001E-01 ],
       [  1.47300278E+02 ,  4.68879004E-01 ],
       [  1.47300556E+02 ,  4.68897315E-01 ],
       [  1.47300833E+02 ,  4.68932581E-01 ],
       [  1.47301167E+02 ,  4.68978377E-01 ],
       [  1.47301567E+02 ,  4.69032056E-01 ],
       [  1.47302047E+02 ,  4.69096381E-01 ],
       [  1.47302623E+02 ,  4.69173450E-01 ],
       [  1.47303314E+02 ,  4.69265760E-01 ],
       [  1.47304143E+02 ,  4.69376282E-01 ],
       [  1.47305139E+02 ,  4.69508552E-01 ],
       [  1.47306333E+02 ,  4.69666764E-01 ],
       [  1.47307766E+02 ,  4.69855886E-01 ],
       [  1.47309486E+02 ,  4.70081787E-01 ],
       [  1.47311550E+02 ,  4.70351377E-01 ],
       [  1.47314027E+02 ,  4.70672759E-01 ],
       [  1.47316999E+02 ,  4.71055394E-01 ],
       [  1.47320565E+02 ,  4.71510269E-01 ],
       [  1.47324845E+02 ,  4.72050107E-01 ],
       [  1.47329981E+02 ,  4.72689433E-01 ],
       [  1.47336144E+02 ,  4.73444706E-01 ],
       [  1.47343539E+02 ,  4.74334355E-01 ],
       [  1.47352413E+02 ,  4.75378696E-01 ],
       [  1.47363063E+02 ,  4.76600263E-01 ],
       [  1.47375842E+02 ,  4.78022333E-01 ],
       [  1.47391177E+02 ,  4.79668912E-01 ],
       [  1.47409579E+02 ,  4.81565214E-01 ],
       [  1.47431661E+02 ,  4.83733345E-01 ],
       [  1.47458160E+02 ,  4.86192717E-01 ],
       [  1.47489959E+02 ,  4.88959602E-01 ],
       [  1.47528118E+02 ,  4.92043295E-01 ],
       [  1.47573908E+02 ,  4.95444422E-01 ],
       [  1.47628856E+02 ,  4.99155251E-01 ],
       [  1.47694794E+02 ,  5.03155540E-01 ],
       [  1.47773919E+02 ,  5.07405103E-01 ],
       [  1.47868870E+02 ,  5.11844241E-01 ],
       [  1.47982810E+02 ,  5.16412518E-01 ],
       [  1.48119539E+02 ,  5.21048037E-01 ],
       [  1.48283614E+02 ,  5.25665012E-01 ],
       [  1.48480503E+02 ,  5.30175888E-01 ],
       [  1.48716770E+02 ,  5.34521939E-01 ],
       [  1.49000291E+02 ,  5.38668511E-01 ],
       [  1.49340516E+02 ,  5.42591963E-01 ],
       [  1.49748786E+02 ,  5.46275642E-01 ],
       [  1.50238710E+02 ,  5.49711810E-01 ],
       [  1.50826618E+02 ,  5.52904128E-01 ],
       [  1.51532109E+02 ,  5.55866671E-01 ],
       [  1.52378697E+02 ,  5.58619203E-01 ],
       [  1.53394603E+02 ,  5.61178455E-01 ],
       [  1.54613691E+02 ,  5.63551687E-01 ],
       [  1.56076595E+02 ,  5.65734956E-01 ],
       [  1.57832081E+02 ,  5.67716785E-01 ],
       [  1.59938664E+02 ,  5.69484398E-01 ],
       [  1.62466564E+02 ,  5.71029089E-01 ],
       [  1.64000000E+02 ,  5.71802608E-01 ],
       [  1.67033479E+02 ,  5.72909761E-01 ],
       [  1.70673655E+02 ,  5.73846033E-01 ],
       [  1.75041865E+02 ,  5.74614486E-01 ],
       [  1.80283717E+02 ,  5.75223452E-01 ],
       [  1.85839273E+02 ,  5.75650082E-01 ],
       [  1.91394828E+02 ,  5.75936585E-01 ],
       [  1.93200000E+02 ,  5.76017119E-01 ],
       [  1.93200278E+02 ,  5.76017132E-01 ],
       [  1.93200556E+02 ,  5.76037594E-01 ],
       [  1.93200833E+02 ,  5.76073856E-01 ],
       [  1.93201111E+02 ,  5.76128604E-01 ],
       [  1.93201389E+02 ,  5.76202867E-01 ],
       [  1.93201722E+02 ,  5.76304186E-01 ],
       [  1.93202122E+02 ,  5.76422869E-01 ],
       [  1.93202602E+02 ,  5.76564911E-01 ],
       [  1.93203178E+02 ,  5.76734827E-01 ],
       [  1.93203869E+02 ,  5.76937958E-01 ],
       [  1.93204699E+02 ,  5.77180617E-01 ],
       [  1.93205694E+02 ,  5.77470235E-01 ],
       [  1.93206889E+02 ,  5.77815648E-01 ],
       [  1.93208322E+02 ,  5.78227043E-01 ],
       [  1.93210042E+02 ,  5.78716309E-01 ],
       [  1.93212106E+02 ,  5.79297173E-01 ],
       [  1.93214582E+02 ,  5.79985349E-01 ],
       [  1.93217554E+02 ,  5.80798630E-01 ],
       [  1.93221121E+02 ,  5.81756886E-01 ],
       [  1.93225401E+02 ,  5.82883251E-01 ],
       [  1.93230536E+02 ,  5.84201065E-01 ],
       [  1.93236699E+02 ,  5.85735333E-01 ],
       [  1.93244094E+02 ,  5.87513100E-01 ],
       [  1.93252969E+02 ,  5.89562367E-01 ],
       [  1.93263618E+02 ,  5.91910248E-01 ],
       [  1.93276397E+02 ,  5.94579374E-01 ],
       [  1.93291732E+02 ,  5.97583696E-01 ],
       [  1.93310135E+02 ,  6.00931377E-01 ],
       [  1.93332217E+02 ,  6.04623910E-01 ],
       [  1.93358716E+02 ,  6.08662583E-01 ],
       [  1.93390515E+02 ,  6.13029318E-01 ],
       [  1.93428673E+02 ,  6.17650586E-01 ],
       [  1.93474463E+02 ,  6.22431159E-01 ],
       [  1.93529412E+02 ,  6.27333236E-01 ],
       [  1.93595349E+02 ,  6.32309898E-01 ],
       [  1.93674475E+02 ,  6.37222557E-01 ],
       [  1.93769425E+02 ,  6.41933107E-01 ],
       [  1.93883366E+02 ,  6.46400066E-01 ],
       [  1.94020095E+02 ,  6.50639495E-01 ],
       [  1.94184169E+02 ,  6.54656264E-01 ],
       [  1.94381059E+02 ,  6.58435320E-01 ],
       [  1.94617326E+02 ,  6.61969838E-01 ],
       [  1.94900847E+02 ,  6.65281080E-01 ],
       [  1.95241072E+02 ,  6.68411912E-01 ],
       [  1.95649342E+02 ,  6.71407188E-01 ],
       [  1.96139265E+02 ,  6.74300186E-01 ],
       [  1.96727174E+02 ,  6.77107999E-01 ],
       [  1.97432664E+02 ,  6.79834453E-01 ],
       [  1.98279253E+02 ,  6.82474627E-01 ],
       [  1.99295159E+02 ,  6.85021325E-01 ],
       [  2.00514246E+02 ,  6.87469387E-01 ],
       [  2.01977151E+02 ,  6.89817986E-01 ],
       [  2.03732637E+02 ,  6.92071510E-01 ],
       [  2.05000000E+02 ,  6.93477204E-01 ],
       [  2.07106583E+02 ,  6.95393311E-01 ],
       [  2.09634482E+02 ,  6.97275613E-01 ],
       [  2.12667962E+02 ,  6.99115274E-01 ],
       [  2.16308137E+02 ,  7.00894115E-01 ],
       [  2.20676347E+02 ,  7.02583585E-01 ],
       [  2.25918200E+02 ,  7.04146047E-01 ],
       [  2.31473755E+02 ,  7.05415162E-01 ],
       [  2.37029311E+02 ,  7.06391599E-01 ],
       [  2.40100000E+02 ,  7.06855134E-01 ],
       [  2.40100278E+02 ,  7.06855176E-01 ],
       [  2.40100556E+02 ,  7.06877508E-01 ],
       [  2.40100833E+02 ,  7.06917543E-01 ],
       [  2.40101111E+02 ,  7.06974235E-01 ],
       [  2.40101389E+02 ,  7.07050522E-01 ],
       [  2.40101722E+02 ,  7.07154076E-01 ],
       [  2.40102122E+02 ,  7.07275143E-01 ],
       [  2.40102602E+02 ,  7.07419532E-01 ],
       [  2.40103178E+02 ,  7.07591533E-01 ],
       [  2.40103869E+02 ,  7.07796126E-01 ],
       [  2.40104699E+02 ,  7.08039430E-01 ],
       [  2.40105694E+02 ,  7.08328131E-01 ],
       [  2.40106889E+02 ,  7.08669974E-01 ],
       [  2.40108322E+02 ,  7.09073712E-01 ],
       [  2.40110042E+02 ,  7.09549094E-01 ],
       [  2.40112106E+02 ,  7.10106762E-01 ],
       [  2.40114582E+02 ,  7.10758033E-01 ],
       [  2.40117554E+02 ,  7.11514521E-01 ],
       [  2.40121121E+02 ,  7.12391784E-01 ],
       [  2.40125401E+02 ,  7.13403411E-01 ],
       [  2.40130536E+02 ,  7.14563617E-01 ],
       [  2.40136699E+02 ,  7.15884967E-01 ],
       [  2.40144094E+02 ,  7.17374779E-01 ],
       [  2.40152969E+02 ,  7.19030340E-01 ],
       [  2.40163618E+02 ,  7.20847414E-01 ],
       [  2.40176397E+02 ,  7.22816573E-01 ],
       [  2.40191732E+02 ,  7.24925359E-01 ],
       [  2.40210135E+02 ,  7.27156053E-01 ],
       [  2.40232217E+02 ,  7.29491434E-01 ],
       [  2.40258716E+02 ,  7.31917425E-01 ],
       [  2.40290515E+02 ,  7.34409227E-01 ],
       [  2.40328673E+02 ,  7.36908808E-01 ],
       [  2.40374463E+02 ,  7.39335436E-01 ],
       [  2.40429412E+02 ,  7.41622257E-01 ],
       [  2.40495349E+02 ,  7.43739866E-01 ],
       [  2.40574475E+02 ,  7.45693268E-01 ],
       [  2.40669425E+02 ,  7.47506397E-01 ],
       [  2.40783366E+02 ,  7.49208507E-01 ],
       [  2.40920095E+02 ,  7.50826465E-01 ],
       [  2.41084169E+02 ,  7.52381037E-01 ],
       [  2.41281059E+02 ,  7.53885848E-01 ],
       [  2.41517326E+02 ,  7.55348681E-01 ],
       [  2.41800847E+02 ,  7.56772308E-01 ],
       [  2.42141072E+02 ,  7.58156846E-01 ],
       [  2.42549342E+02 ,  7.59501876E-01 ],
       [  2.43039265E+02 ,  7.60807915E-01 ],
       [  2.43627174E+02 ,  7.62078078E-01 ],
       [  2.44332664E+02 ,  7.63318384E-01 ],
       [  2.45179253E+02 ,  7.64537228E-01 ],
       [  2.46000000E+02 ,  7.65542147E-01 ],
       [  2.47015906E+02 ,  7.66598926E-01 ],
       [  2.48234993E+02 ,  7.67679846E-01 ],
       [  2.49697898E+02 ,  7.68787186E-01 ],
       [  2.51453384E+02 ,  7.69919917E-01 ],
       [  2.53559967E+02 ,  7.71072505E-01 ],
       [  2.56087866E+02 ,  7.72233940E-01 ],
       [  2.59121346E+02 ,  7.73387119E-01 ],
       [  2.62761521E+02 ,  7.74509090E-01 ],
       [  2.67129731E+02 ,  7.75573137E-01 ],
       [  2.72371584E+02 ,  7.76550313E-01 ],
       [  2.77927139E+02 ,  7.77336378E-01 ],
       [  2.83482695E+02 ,  7.77933945E-01 ],
       [  2.87000000E+02 ,  7.78249144E-01 ],
       [  2.88100000E+02 ,  7.78341904E-01 ],
       [  2.88100278E+02 ,  7.78341927E-01 ],
       [  2.88100611E+02 ,  7.78370111E-01 ],
       [  2.88101011E+02 ,  7.78428332E-01 ],
       [  2.88101491E+02 ,  7.78546558E-01 ],
       [  2.88102001E+02 ,  7.78734988E-01 ],
       [  2.88102512E+02 ,  7.78992877E-01 ],
       [  2.88103022E+02 ,  7.79322397E-01 ],
       [  2.88103634E+02 ,  7.79708773E-01 ],
       [  2.88104369E+02 ,  7.80163235E-01 ],
       [  2.88105251E+02 ,  7.80697208E-01 ],
       [  2.88106309E+02 ,  7.81322306E-01 ],
       [  2.88107579E+02 ,  7.82050533E-01 ],
       [  2.88109103E+02 ,  7.82893505E-01 ],
       [  2.88110931E+02 ,  7.83861211E-01 ],
       [  2.88113125E+02 ,  7.84960312E-01 ],
       [  2.88115758E+02 ,  7.86192459E-01 ],
       [  2.88118918E+02 ,  7.87575761E-01 ],
       [  2.88122710E+02 ,  7.89121448E-01 ],
       [  2.88127260E+02 ,  7.90839728E-01 ],
       [  2.88132720E+02 ,  7.92740359E-01 ],
       [  2.88139271E+02 ,  7.94831543E-01 ],
       [  2.88147134E+02 ,  7.97093381E-01 ],
       [  2.88156568E+02 ,  7.99431677E-01 ],
       [  2.88167890E+02 ,  8.01748746E-01 ],
       [  2.88181476E+02 ,  8.04003825E-01 ],
       [  2.88197779E+02 ,  8.06164870E-01 ],
       [  2.88217343E+02 ,  8.08209407E-01 ],
       [  2.88240819E+02 ,  8.10128017E-01 ],
       [  2.88268991E+02 ,  8.11923140E-01 ],
       [  2.88302797E+02 ,  8.13605469E-01 ],
       [  2.88343365E+02 ,  8.15190334E-01 ],
       [  2.88392046E+02 ,  8.16693978E-01 ],
       [  2.88450463E+02 ,  8.18130241E-01 ],
       [  2.88520563E+02 ,  8.19511207E-01 ],
       [  2.88604684E+02 ,  8.20846242E-01 ],
       [  2.88705629E+02 ,  8.22140495E-01 ],
       [  2.88826763E+02 ,  8.23396035E-01 ],
       [  2.88972123E+02 ,  8.24613847E-01 ],
       [  2.89146556E+02 ,  8.25794998E-01 ],
       [  2.89355875E+02 ,  8.26940361E-01 ],
       [  2.89607058E+02 ,  8.28051572E-01 ],
       [  2.89908477E+02 ,  8.29134080E-01 ],
       [  2.90270181E+02 ,  8.30196371E-01 ],
       [  2.90704225E+02 ,  8.31248641E-01 ],
       [  2.91225078E+02 ,  8.32300867E-01 ],
       [  2.91850101E+02 ,  8.33361479E-01 ],
       [  2.92600130E+02 ,  8.34435782E-01 ],
       [  2.93500163E+02 ,  8.35525951E-01 ],
       [  2.94580204E+02 ,  8.36631278E-01 ],
       [  2.95876253E+02 ,  8.37747923E-01 ],
       [  2.97431511E+02 ,  8.38867886E-01 ],
       [  2.99297822E+02 ,  8.39978436E-01 ],
       [  3.01537394E+02 ,  8.41061703E-01 ],
       [  3.04224881E+02 ,  8.42095604E-01 ],
       [  3.07449865E+02 ,  8.43052174E-01 ],
       [  3.11319846E+02 ,  8.43900233E-01 ],
       [  3.12100000E+02 ,  8.44059883E-01 ],
       [  3.12100278E+02 ,  8.44059940E-01 ],
       [  3.12100611E+02 ,  8.44081773E-01 ],
       [  3.12101011E+02 ,  8.44139881E-01 ],
       [  3.12101491E+02 ,  8.44251628E-01 ],
       [  3.12102067E+02 ,  8.44446678E-01 ],
       [  3.12102758E+02 ,  8.44768274E-01 ],
       [  3.12103524E+02 ,  8.45242095E-01 ],
       [  3.12104289E+02 ,  8.45843770E-01 ],
       [  3.12105208E+02 ,  8.46571999E-01 ],
       [  3.12106310E+02 ,  8.47369194E-01 ],
       [  3.12107633E+02 ,  8.48274532E-01 ],
       [  3.12109220E+02 ,  8.49301525E-01 ],
       [  3.12111125E+02 ,  8.50463400E-01 ],
       [  3.12113410E+02 ,  8.51766911E-01 ],
       [  3.12116153E+02 ,  8.53185967E-01 ],
       [  3.12119444E+02 ,  8.54635732E-01 ],
       [  3.12123394E+02 ,  8.56052968E-01 ],
       [  3.12128133E+02 ,  8.57441949E-01 ],
       [  3.12133820E+02 ,  8.58780754E-01 ],
       [  3.12140645E+02 ,  8.60050750E-01 ],
       [  3.12148835E+02 ,  8.61241402E-01 ],
       [  3.12158663E+02 ,  8.62348863E-01 ],
       [  3.12170456E+02 ,  8.63375760E-01 ],
       [  3.12184608E+02 ,  8.64330200E-01 ],
       [  3.12201590E+02 ,  8.65223397E-01 ],
       [  3.12221969E+02 ,  8.66066612E-01 ],
       [  3.12246423E+02 ,  8.66868954E-01 ],
       [  3.12275769E+02 ,  8.67636976E-01 ],
       [  3.12310983E+02 ,  8.68375270E-01 ],
       [  3.12353240E+02 ,  8.69087389E-01 ],
       [  3.12403949E+02 ,  8.69776824E-01 ],
       [  3.12464800E+02 ,  8.70447368E-01 ],
       [  3.12537821E+02 ,  8.71102372E-01 ],
       [  3.12625445E+02 ,  8.71743691E-01 ],
       [  3.12730595E+02 ,  8.72374172E-01 ],
       [  3.12856775E+02 ,  8.72998281E-01 ],
       [  3.13008190E+02 ,  8.73621658E-01 ],
       [  3.13189889E+02 ,  8.74249601E-01 ],
       [  3.13407928E+02 ,  8.74886251E-01 ],
       [  3.13669574E+02 ,  8.75534719E-01 ],
       [  3.13983549E+02 ,  8.76197420E-01 ],
       [  3.14360320E+02 ,  8.76876119E-01 ],
       [  3.14812445E+02 ,  8.77572282E-01 ],
       [  3.15354994E+02 ,  8.78287412E-01 ],
       [  3.16006054E+02 ,  8.79022552E-01 ],
       [  3.16787325E+02 ,  8.79778002E-01 ],
       [  3.17724851E+02 ,  8.80552522E-01 ],
       [  3.18849882E+02 ,  8.81340400E-01 ],
       [  3.20199919E+02 ,  8.82128810E-01 ],
       [  3.21819964E+02 ,  8.82896229E-01 ],
       [  3.23764017E+02 ,  8.83616823E-01 ],
       [  3.26096881E+02 ,  8.84268320E-01 ],
       [  3.28000000E+02 ,  8.84689825E-01 ],
       [  3.30799437E+02 ,  8.85144218E-01 ],
       [  3.30900000E+02 ,  8.85160331E-01 ],
       [  3.30900278E+02 ,  8.85160375E-01 ],
       [  3.30900611E+02 ,  8.85184678E-01 ],
       [  3.30901011E+02 ,  8.85238325E-01 ],
       [  3.30901491E+02 ,  8.85336459E-01 ],
       [  3.30902067E+02 ,  8.85500064E-01 ],
       [  3.30902758E+02 ,  8.85756775E-01 ],
       [  3.30903588E+02 ,  8.86141967E-01 ],
       [  3.30904583E+02 ,  8.86695297E-01 ],
       [  3.30905777E+02 ,  8.87508192E-01 ],
       [  3.30907053E+02 ,  8.88577028E-01 ],
       [  3.30908584E+02 ,  8.89852435E-01 ],
       [  3.30910421E+02 ,  8.91079159E-01 ],
       [  3.30912626E+02 ,  8.92186538E-01 ],
       [  3.30915271E+02 ,  8.93188537E-01 ],
       [  3.30918445E+02 ,  8.94083853E-01 ],
       [  3.30922255E+02 ,  8.94874972E-01 ],
       [  3.30926826E+02 ,  8.95575931E-01 ],
       [  3.30932311E+02 ,  8.96206413E-01 ],
       [  3.30938894E+02 ,  8.96784019E-01 ],
       [  3.30946793E+02 ,  8.97319718E-01 ],
       [  3.30956272E+02 ,  8.97820208E-01 ],
       [  3.30967646E+02 ,  8.98289899E-01 ],
       [  3.30981296E+02 ,  8.98732345E-01 ],
       [  3.30997675E+02 ,  8.99151022E-01 ],
       [  3.31017330E+02 ,  8.99549483E-01 ],
       [  3.31040916E+02 ,  8.99931570E-01 ],
       [  3.31069220E+02 ,  9.00301250E-01 ],
       [  3.31103184E+02 ,  9.00662398E-01 ],
       [  3.31143941E+02 ,  9.01018691E-01 ],
       [  3.31192850E+02 ,  9.01373588E-01 ],
       [  3.31251540E+02 ,  9.01730279E-01 ],
       [  3.31321968E+02 ,  9.02091659E-01 ],
       [  3.31406482E+02 ,  9.02460376E-01 ],
       [  3.31507898E+02 ,  9.02838565E-01 ],
       [  3.31629598E+02 ,  9.03226719E-01 ],
       [  3.31775638E+02 ,  9.03624809E-01 ],
       [  3.31950886E+02 ,  9.04033333E-01 ],
       [  3.32161183E+02 ,  9.04453966E-01 ],
       [  3.32413540E+02 ,  9.04889496E-01 ],
       [  3.32716368E+02 ,  9.05343114E-01 ],
       [  3.33079762E+02 ,  9.05817892E-01 ],
       [  3.33515835E+02 ,  9.06316227E-01 ],
       [  3.34039122E+02 ,  9.06838865E-01 ],
       [  3.34667066E+02 ,  9.07385453E-01 ],
       [  3.35420600E+02 ,  9.07953276E-01 ],
       [  3.36324840E+02 ,  9.08534059E-01 ],
       [  3.37409928E+02 ,  9.09116863E-01 ],
       [  3.38712034E+02 ,  9.09688077E-01 ],
       [  3.40274561E+02 ,  9.10231555E-01 ],
       [  3.42149594E+02 ,  9.10729810E-01 ],
       [  3.44399633E+02 ,  9.11165136E-01 ],
       [  3.47099679E+02 ,  9.11522700E-01 ],
       [  3.50339736E+02 ,  9.11797372E-01 ],
       [  3.54227803E+02 ,  9.11992751E-01 ],
       [  3.58893484E+02 ,  9.12120174E-01 ],
       [  3.64449039E+02 ,  9.12195411E-01 ],
       [  3.69000000E+02 ,  9.12228870E-01 ],
       [  3.74555556E+02 ,  9.12248931E-01 ],
       [  3.78900000E+02 ,  9.12257580E-01 ],
       [  3.78900278E+02 ,  9.12257581E-01 ],
       [  3.78900611E+02 ,  9.12283873E-01 ],
       [  3.78901011E+02 ,  9.12331841E-01 ],
       [  3.78901491E+02 ,  9.12408958E-01 ],
       [  3.78902067E+02 ,  9.12524913E-01 ],
       [  3.78902758E+02 ,  9.12697984E-01 ],
       [  3.78903588E+02 ,  9.12948292E-01 ],
       [  3.78904583E+02 ,  9.13302958E-01 ],
       [  3.78905777E+02 ,  9.13799638E-01 ],
       [  3.78907211E+02 ,  9.14458348E-01 ],
       [  3.78908931E+02 ,  9.15224886E-01 ],
       [  3.78910995E+02 ,  9.16099924E-01 ],
       [  3.78913471E+02 ,  9.16656435E-01 ],
       [  3.78916443E+02 ,  9.17090513E-01 ],
       [  3.78920010E+02 ,  9.17441428E-01 ],
       [  3.78924289E+02 ,  9.17735533E-01 ],
       [  3.78929425E+02 ,  9.17989509E-01 ],
       [  3.78935588E+02 ,  9.18214105E-01 ],
       [  3.78942983E+02 ,  9.18416888E-01 ],
       [  3.78951858E+02 ,  9.18603881E-01 ],
       [  3.78962507E+02 ,  9.18780416E-01 ],
       [  3.78975286E+02 ,  9.18951509E-01 ],
       [  3.78990621E+02 ,  9.19120420E-01 ],
       [  3.79009023E+02 ,  9.19288911E-01 ],
       [  3.79031106E+02 ,  9.19458092E-01 ],
       [  3.79057605E+02 ,  9.19628855E-01 ],
       [  3.79089404E+02 ,  9.19802053E-01 ],
       [  3.79127562E+02 ,  9.19978529E-01 ],
       [  3.79173352E+02 ,  9.20159165E-01 ],
       [  3.79228300E+02 ,  9.20344908E-01 ],
       [  3.79294238E+02 ,  9.20536569E-01 ],
       [  3.79373364E+02 ,  9.20734506E-01 ],
       [  3.79468314E+02 ,  9.20938326E-01 ],
       [  3.79582255E+02 ,  9.21148391E-01 ],
       [  3.79718984E+02 ,  9.21366152E-01 ],
       [  3.79883058E+02 ,  9.21593745E-01 ],
       [  3.80079948E+02 ,  9.21833296E-01 ],
       [  3.80316215E+02 ,  9.22086218E-01 ],
       [  3.80599736E+02 ,  9.22352630E-01 ],
       [  3.80939961E+02 ,  9.22630943E-01 ],
       [  3.81348230E+02 ,  9.22916606E-01 ],
       [  3.81838154E+02 ,  9.23201804E-01 ],
       [  3.82426063E+02 ,  9.23478353E-01 ],
       [  3.83131553E+02 ,  9.23737083E-01 ],
       [  3.83978142E+02 ,  9.23969171E-01 ],
       [  3.84994048E+02 ,  9.24168212E-01 ],
       [  3.86213135E+02 ,  9.24331231E-01 ],
       [  3.87676040E+02 ,  9.24458779E-01 ],
       [  3.89431526E+02 ,  9.24554010E-01 ],
       [  3.91538109E+02 ,  9.24621847E-01 ],
       [  3.94066008E+02 ,  9.24667576E-01 ],
       [  3.97099487E+02 ,  9.24696505E-01 ],
       [  4.00739663E+02 ,  9.24713647E-01 ],
       [  4.01613305E+02 ,  9.24716962E-01 ],
       [  4.02661675E+02 ,  9.24720064E-01 ],
       [  4.03919720E+02 ,  9.24722863E-01 ],
       [  4.05429373E+02 ,  9.24725291E-01 ],
       [  4.07240957E+02 ,  9.24727306E-01 ],
       [  4.09414858E+02 ,  9.24728905E-01 ],
       [  4.10000000E+02 ,  9.24729284E-01 ],
     ]
   )

   rlptbl = pd.DataFrame(
     columns = ['Sat','kr1','kr2'],
     data = [
       [  7.31000000E-02 ,  0.00000000E+00 ,  5.00499750E-01 ],
       [  7.39619000E-02 ,  8.00000000E-13 ,  4.98502248E-01 ],
       [  7.48238000E-02 ,  1.28000000E-11 ,  4.96510735E-01 ],
       [  7.74095000E-02 ,  5.00000000E-10 ,  4.90572002E-01 ],
       [  8.17190000E-02 ,  8.00000000E-09 ,  4.80792758E-01 ],
       [  9.03380000E-02 ,  1.28000000E-07 ,  4.61673835E-01 ],
       [  1.16195000E-01 ,  5.00000000E-06 ,  4.07727888E-01 ],
       [  1.59290000E-01 ,  8.00000000E-05 ,  3.28499775E-01 ],
       [  2.45480000E-01 ,  1.28000000E-03 ,  2.05199800E-01 ],
       [  3.31670000E-01 ,  6.48000000E-03 ,  1.20399825E-01 ],
       [  4.17860000E-01 ,  2.04800000E-02 ,  6.50998501E-02 ],
       [  5.04050000E-01 ,  5.00000000E-02 ,  3.14998751E-02 ],
       [  5.90240000E-01 ,  1.03680000E-01 ,  1.29999000E-02 ],
       [  6.76430000E-01 ,  1.92080000E-01 ,  4.19992504E-03 ],
       [  7.62620000E-01 ,  3.27680000E-01 ,  8.99950025E-04 ],
       [  8.48810000E-01 ,  5.24880000E-01 ,  9.99750125E-05 ],
       [  8.91905000E-01 ,  6.51605000E-01 ,  2.81125062E-05 ],
       [  9.17762000E-01 ,  7.37894528E-01 ,  1.00750025E-05 ],
       [  9.26381000E-01 ,  7.68476808E-01 ,  5.00250125E-06 ],
       [  9.30690500E-01 ,  7.84119600E-01 ,  2.49906312E-06 ],
       [  9.33276200E-01 ,  7.93619174E-01 ,  9.99508250E-07 ],
       [  9.34138100E-01 ,  7.96804797E-01 ,  4.99750625E-07 ],
       [  9.35000000E-01 ,  8.00000000E-01 ,  0.00000000E+00 ],
     ]
   )

   cprtbl = pd.DataFrame(
     columns = ['Sat','Pc'],
     data = [
       [  7.31000000E-02 , -0.00000000E+00 ],
       [  7.50000000E-02 , -2.04990000E-02 ],
       [  2.96000000E-01 , -8.63860000E-02 ],
       [  5.72000000E-01 , -1.89330000E-01 ],
       [  6.52000000E-01 , -2.38750000E-01 ],
       [  7.98000000E-01 , -3.58170000E-01 ],
       [  8.80600000E-01 , -5.31120000E-01 ],
       [  9.10000000E-01 , -9.77370000E-01 ],
       [  9.18000000E-01 , -1.94100000E+00 ],
       [  9.25600000E-01 , -4.31980000E+00 ],
       [  9.32600000E-01 , -9.31980000E+00 ],
       [  9.35000000E-01 , -2.10260000E+01 ],
     ]
   )

   schedule = pd.DataFrame(
     columns = ['StartTime','WellList','InjRate','Acceleration'],
     data = [
       [  0.00000000E+00 ,  7.68100000E+03 ,  0.00000000E+00 , -8.43700000E+02 ],
       [  4.80000000E+01 ,  7.68100000E+03 ,  0.00000000E+00 , -1.49990000E+03 ],
       [  9.93300000E+01 ,  7.68100000E+03 ,  0.00000000E+00 , -2.34360000E+03 ],
       [  1.47300000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -3.37480000E+03 ],
       [  1.93200000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -5.99960000E+03 ],
       [  2.40100000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -9.37440000E+03 ],
       [  2.88100000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -1.83738000E+04 ],
       [  3.12100000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -3.74976000E+04 ],
       [  3.30900000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -8.43697000E+04 ],
       [  3.78900000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -1.81488600E+05 ],
     ]
   )

   movie_schedule = np.array([
     2.77777778E-04 ,     6.11111111E-04 ,     7.02791106E-04 ,     7.35016344E-04 ,     7.73686629E-04 ,
     8.20090972E-04 ,     8.75776183E-04 ,     9.42598436E-04 ,     1.02278514E-03 ,     1.11900918E-03 ,
     1.23447804E-03 ,     1.37304066E-03 ,     1.53931581E-03 ,     1.73884599E-03 ,     1.97828220E-03 ,
     2.26560566E-03 ,     2.61039381E-03 ,     3.02413959E-03 ,     3.52063452E-03 ,     4.11642844E-03 ,
     4.83138115E-03 ,     5.68932439E-03 ,     6.71885629E-03 ,     7.95429456E-03 ,     9.43682049E-03 ,
     1.12158516E-02 ,     1.33506889E-02 ,     1.59124937E-02 ,     1.89866595E-02 ,     2.26756584E-02 ,
     2.71024571E-02 ,     3.24146156E-02 ,     3.87892057E-02 ,     4.64387139E-02 ,     5.56181237E-02 ,
     6.66334154E-02 ,     7.98517655E-02 ,     9.57137856E-02 ,     1.14748210E-01 ,     1.37589519E-01 ,
     1.64999089E-01 ,     1.97890574E-01 ,     2.37360356E-01 ,     2.84724095E-01 ,     3.41560581E-01 ,
     4.09764364E-01 ,     4.91608903E-01 ,     5.89822351E-01 ,     7.07678488E-01 ,     8.49105853E-01 ,
     1.01881869E+00 ,     1.22247410E+00 ,     1.46686058E+00 ,     1.76012437E+00 ,     2.11204091E+00 ,
     2.53434075E+00 ,     3.04110057E+00 ,     3.64921235E+00 ,     4.37894649E+00 ,     5.25462745E+00 ,
     6.30544461E+00 ,     7.56642520E+00 ,     9.07960191E+00 ,     1.08954140E+01 ,     1.30743884E+01 ,
     1.56891578E+01 ,     1.88268810E+01 ,     2.25921489E+01 ,     2.71104703E+01 ,     3.25324560E+01 ,
     3.80880116E+01 ,     4.10000000E+01 ,     4.65555556E+01 ,     4.80000000E+01 ,     4.80002778E+01 ,
     4.80005556E+01 ,     4.80008333E+01 ,     4.80011667E+01 ,     4.80015667E+01 ,     4.80020467E+01 ,
     4.80026227E+01 ,     4.80033139E+01 ,     4.80041433E+01 ,     4.80051386E+01 ,     4.80063330E+01 ,
     4.80077663E+01 ,     4.80094862E+01 ,     4.80115501E+01 ,     4.80140268E+01 ,     4.80169989E+01 ,
     4.80205653E+01 ,     4.80248450E+01 ,     4.80299807E+01 ,     4.80361435E+01 ,     4.80435389E+01 ,
     4.80524133E+01 ,     4.80630627E+01 ,     4.80758419E+01 ,     4.80911769E+01 ,     4.81095790E+01 ,
     4.81316614E+01 ,     4.81581604E+01 ,     4.81899591E+01 ,     4.82281176E+01 ,     4.82739078E+01 ,
     4.83288560E+01 ,     4.83947939E+01 ,     4.84739193E+01 ,     4.85688698E+01 ,     4.86828105E+01 ,
     4.88195392E+01 ,     4.89836137E+01 ,     4.91805031E+01 ,     4.94167704E+01 ,     4.97002912E+01 ,
     5.00405161E+01 ,     5.04487859E+01 ,     5.09387098E+01 ,     5.15266184E+01 ,     5.22321088E+01 ,
     5.30786972E+01 ,     5.40946033E+01 ,     5.53136906E+01 ,     5.67765954E+01 ,     5.85320812E+01 ,
     6.06386641E+01 ,     6.31665636E+01 ,     6.62000430E+01 ,     6.98402182E+01 ,     7.42084285E+01 ,
     7.94502809E+01 ,     8.20000000E+01 ,     8.75555556E+01 ,     9.31111111E+01 ,     9.86666667E+01 ,
     9.93300000E+01 ,     9.93302778E+01 ,     9.93305556E+01 ,     9.93308333E+01 ,     9.93311667E+01 ,
     9.93315667E+01 ,     9.93320467E+01 ,     9.93326227E+01 ,     9.93333139E+01 ,     9.93341433E+01 ,
     9.93351386E+01 ,     9.93363330E+01 ,     9.93377663E+01 ,     9.93394862E+01 ,     9.93415501E+01 ,
     9.93440268E+01 ,     9.93469989E+01 ,     9.93505653E+01 ,     9.93548450E+01 ,     9.93599807E+01 ,
     9.93661435E+01 ,     9.93735389E+01 ,     9.93824133E+01 ,     9.93930627E+01 ,     9.94058419E+01 ,
     9.94211769E+01 ,     9.94395790E+01 ,     9.94616614E+01 ,     9.94881604E+01 ,     9.95199591E+01 ,
     9.95581176E+01 ,     9.96039078E+01 ,     9.96588560E+01 ,     9.97247939E+01 ,     9.98039193E+01 ,
     9.98988698E+01 ,     1.00012810E+02 ,     1.00149539E+02 ,     1.00313614E+02 ,     1.00510503E+02 ,
     1.00746770E+02 ,     1.01030291E+02 ,     1.01370516E+02 ,     1.01778786E+02 ,     1.02268710E+02 ,
     1.02856618E+02 ,     1.03562109E+02 ,     1.04408697E+02 ,     1.05424603E+02 ,     1.06643691E+02 ,
     1.08106595E+02 ,     1.09862081E+02 ,     1.11968664E+02 ,     1.14496564E+02 ,     1.17530043E+02 ,
     1.21170218E+02 ,     1.23000000E+02 ,     1.27368210E+02 ,     1.32610063E+02 ,     1.38165618E+02 ,
     1.43721174E+02 ,     1.47300000E+02 ,     1.47300278E+02 ,     1.47300556E+02 ,     1.47300833E+02 ,
     1.47301167E+02 ,     1.47301567E+02 ,     1.47302047E+02 ,     1.47302623E+02 ,     1.47303314E+02 ,
     1.47304143E+02 ,     1.47305139E+02 ,     1.47306333E+02 ,     1.47307766E+02 ,     1.47309486E+02 ,
     1.47311550E+02 ,     1.47314027E+02 ,     1.47316999E+02 ,     1.47320565E+02 ,     1.47324845E+02 ,
     1.47329981E+02 ,     1.47336144E+02 ,     1.47343539E+02 ,     1.47352413E+02 ,     1.47363063E+02 ,
     1.47375842E+02 ,     1.47391177E+02 ,     1.47409579E+02 ,     1.47431661E+02 ,     1.47458160E+02 ,
     1.47489959E+02 ,     1.47528118E+02 ,     1.47573908E+02 ,     1.47628856E+02 ,     1.47694794E+02 ,
     1.47773919E+02 ,     1.47868870E+02 ,     1.47982810E+02 ,     1.48119539E+02 ,     1.48283614E+02 ,
     1.48480503E+02 ,     1.48716770E+02 ,     1.49000291E+02 ,     1.49340516E+02 ,     1.49748786E+02 ,
     1.50238710E+02 ,     1.50826618E+02 ,     1.51532109E+02 ,     1.52378697E+02 ,     1.53394603E+02 ,
     1.54613691E+02 ,     1.56076595E+02 ,     1.57832081E+02 ,     1.59938664E+02 ,     1.62466564E+02 ,
     1.64000000E+02 ,     1.67033479E+02 ,     1.70673655E+02 ,     1.75041865E+02 ,     1.80283717E+02 ,
     1.85839273E+02 ,     1.91394828E+02 ,     1.93200000E+02 ,     1.93200278E+02 ,     1.93200556E+02 ,
     1.93200833E+02 ,     1.93201111E+02 ,     1.93201389E+02 ,     1.93201722E+02 ,     1.93202122E+02 ,
     1.93202602E+02 ,     1.93203178E+02 ,     1.93203869E+02 ,     1.93204699E+02 ,     1.93205694E+02 ,
     1.93206889E+02 ,     1.93208322E+02 ,     1.93210042E+02 ,     1.93212106E+02 ,     1.93214582E+02 ,
     1.93217554E+02 ,     1.93221121E+02 ,     1.93225401E+02 ,     1.93230536E+02 ,     1.93236699E+02 ,
     1.93244094E+02 ,     1.93252969E+02 ,     1.93263618E+02 ,     1.93276397E+02 ,     1.93291732E+02 ,
     1.93310135E+02 ,     1.93332217E+02 ,     1.93358716E+02 ,     1.93390515E+02 ,     1.93428673E+02 ,
     1.93474463E+02 ,     1.93529412E+02 ,     1.93595349E+02 ,     1.93674475E+02 ,     1.93769425E+02 ,
     1.93883366E+02 ,     1.94020095E+02 ,     1.94184169E+02 ,     1.94381059E+02 ,     1.94617326E+02 ,
     1.94900847E+02 ,     1.95241072E+02 ,     1.95649342E+02 ,     1.96139265E+02 ,     1.96727174E+02 ,
     1.97432664E+02 ,     1.98279253E+02 ,     1.99295159E+02 ,     2.00514246E+02 ,     2.01977151E+02 ,
     2.03732637E+02 ,     2.05000000E+02 ,     2.07106583E+02 ,     2.09634482E+02 ,     2.12667962E+02 ,
     2.16308137E+02 ,     2.20676347E+02 ,     2.25918200E+02 ,     2.31473755E+02 ,     2.37029311E+02 ,
     2.40100000E+02 ,     2.40100278E+02 ,     2.40100556E+02 ,     2.40100833E+02 ,     2.40101111E+02 ,
     2.40101389E+02 ,     2.40101722E+02 ,     2.40102122E+02 ,     2.40102602E+02 ,     2.40103178E+02 ,
     2.40103869E+02 ,     2.40104699E+02 ,     2.40105694E+02 ,     2.40106889E+02 ,     2.40108322E+02 ,
     2.40110042E+02 ,     2.40112106E+02 ,     2.40114582E+02 ,     2.40117554E+02 ,     2.40121121E+02 ,
     2.40125401E+02 ,     2.40130536E+02 ,     2.40136699E+02 ,     2.40144094E+02 ,     2.40152969E+02 ,
     2.40163618E+02 ,     2.40176397E+02 ,     2.40191732E+02 ,     2.40210135E+02 ,     2.40232217E+02 ,
     2.40258716E+02 ,     2.40290515E+02 ,     2.40328673E+02 ,     2.40374463E+02 ,     2.40429412E+02 ,
     2.40495349E+02 ,     2.40574475E+02 ,     2.40669425E+02 ,     2.40783366E+02 ,     2.40920095E+02 ,
     2.41084169E+02 ,     2.41281059E+02 ,     2.41517326E+02 ,     2.41800847E+02 ,     2.42141072E+02 ,
     2.42549342E+02 ,     2.43039265E+02 ,     2.43627174E+02 ,     2.44332664E+02 ,     2.45179253E+02 ,
     2.46000000E+02 ,     2.47015906E+02 ,     2.48234993E+02 ,     2.49697898E+02 ,     2.51453384E+02 ,
     2.53559967E+02 ,     2.56087866E+02 ,     2.59121346E+02 ,     2.62761521E+02 ,     2.67129731E+02 ,
     2.72371584E+02 ,     2.77927139E+02 ,     2.83482695E+02 ,     2.87000000E+02 ,     2.88100000E+02 ,
     2.88100278E+02 ,     2.88100611E+02 ,     2.88101011E+02 ,     2.88101491E+02 ,     2.88102001E+02 ,
     2.88102512E+02 ,     2.88103022E+02 ,     2.88103634E+02 ,     2.88104369E+02 ,     2.88105251E+02 ,
     2.88106309E+02 ,     2.88107579E+02 ,     2.88109103E+02 ,     2.88110931E+02 ,     2.88113125E+02 ,
     2.88115758E+02 ,     2.88118918E+02 ,     2.88122710E+02 ,     2.88127260E+02 ,     2.88132720E+02 ,
     2.88139271E+02 ,     2.88147134E+02 ,     2.88156568E+02 ,     2.88167890E+02 ,     2.88181476E+02 ,
     2.88197779E+02 ,     2.88217343E+02 ,     2.88240819E+02 ,     2.88268991E+02 ,     2.88302797E+02 ,
     2.88343365E+02 ,     2.88392046E+02 ,     2.88450463E+02 ,     2.88520563E+02 ,     2.88604684E+02 ,
     2.88705629E+02 ,     2.88826763E+02 ,     2.88972123E+02 ,     2.89146556E+02 ,     2.89355875E+02 ,
     2.89607058E+02 ,     2.89908477E+02 ,     2.90270181E+02 ,     2.90704225E+02 ,     2.91225078E+02 ,
     2.91850101E+02 ,     2.92600130E+02 ,     2.93500163E+02 ,     2.94580204E+02 ,     2.95876253E+02 ,
     2.97431511E+02 ,     2.99297822E+02 ,     3.01537394E+02 ,     3.04224881E+02 ,     3.07449865E+02 ,
     3.11319846E+02 ,     3.12100000E+02 ,     3.12100278E+02 ,     3.12100611E+02 ,     3.12101011E+02 ,
     3.12101491E+02 ,     3.12102067E+02 ,     3.12102758E+02 ,     3.12103524E+02 ,     3.12104289E+02 ,
     3.12105208E+02 ,     3.12106310E+02 ,     3.12107633E+02 ,     3.12109220E+02 ,     3.12111125E+02 ,
     3.12113410E+02 ,     3.12116153E+02 ,     3.12119444E+02 ,     3.12123394E+02 ,     3.12128133E+02 ,
     3.12133820E+02 ,     3.12140645E+02 ,     3.12148835E+02 ,     3.12158663E+02 ,     3.12170456E+02 ,
     3.12184608E+02 ,     3.12201590E+02 ,     3.12221969E+02 ,     3.12246423E+02 ,     3.12275769E+02 ,
     3.12310983E+02 ,     3.12353240E+02 ,     3.12403949E+02 ,     3.12464800E+02 ,     3.12537821E+02 ,
     3.12625445E+02 ,     3.12730595E+02 ,     3.12856775E+02 ,     3.13008190E+02 ,     3.13189889E+02 ,
     3.13407928E+02 ,     3.13669574E+02 ,     3.13983549E+02 ,     3.14360320E+02 ,     3.14812445E+02 ,
     3.15354994E+02 ,     3.16006054E+02 ,     3.16787325E+02 ,     3.17724851E+02 ,     3.18849882E+02 ,
     3.20199919E+02 ,     3.21819964E+02 ,     3.23764017E+02 ,     3.26096881E+02 ,     3.28000000E+02 ,
     3.30799437E+02 ,     3.30900000E+02 ,     3.30900278E+02 ,     3.30900611E+02 ,     3.30901011E+02 ,
     3.30901491E+02 ,     3.30902067E+02 ,     3.30902758E+02 ,     3.30903588E+02 ,     3.30904583E+02 ,
     3.30905777E+02 ,     3.30907053E+02 ,     3.30908584E+02 ,     3.30910421E+02 ,     3.30912626E+02 ,
     3.30915271E+02 ,     3.30918445E+02 ,     3.30922255E+02 ,     3.30926826E+02 ,     3.30932311E+02 ,
     3.30938894E+02 ,     3.30946793E+02 ,     3.30956272E+02 ,     3.30967646E+02 ,     3.30981296E+02 ,
     3.30997675E+02 ,     3.31017330E+02 ,     3.31040916E+02 ,     3.31069220E+02 ,     3.31103184E+02 ,
     3.31143941E+02 ,     3.31192850E+02 ,     3.31251540E+02 ,     3.31321968E+02 ,     3.31406482E+02 ,
     3.31507898E+02 ,     3.31629598E+02 ,     3.31775638E+02 ,     3.31950886E+02 ,     3.32161183E+02 ,
     3.32413540E+02 ,     3.32716368E+02 ,     3.33079762E+02 ,     3.33515835E+02 ,     3.34039122E+02 ,
     3.34667066E+02 ,     3.35420600E+02 ,     3.36324840E+02 ,     3.37409928E+02 ,     3.38712034E+02 ,
     3.40274561E+02 ,     3.42149594E+02 ,     3.44399633E+02 ,     3.47099679E+02 ,     3.50339736E+02 ,
     3.54227803E+02 ,     3.58893484E+02 ,     3.64449039E+02 ,     3.69000000E+02 ,     3.74555556E+02 ,
     3.78900000E+02 ,     3.78900278E+02 ,     3.78900611E+02 ,     3.78901011E+02 ,     3.78901491E+02 ,
     3.78902067E+02 ,     3.78902758E+02 ,     3.78903588E+02 ,     3.78904583E+02 ,     3.78905777E+02 ,
     3.78907211E+02 ,     3.78908931E+02 ,     3.78910995E+02 ,     3.78913471E+02 ,     3.78916443E+02 ,
     3.78920010E+02 ,     3.78924289E+02 ,     3.78929425E+02 ,     3.78935588E+02 ,     3.78942983E+02 ,
     3.78951858E+02 ,     3.78962507E+02 ,     3.78975286E+02 ,     3.78990621E+02 ,     3.79009023E+02 ,
     3.79031106E+02 ,     3.79057605E+02 ,     3.79089404E+02 ,     3.79127562E+02 ,     3.79173352E+02 ,
     3.79228300E+02 ,     3.79294238E+02 ,     3.79373364E+02 ,     3.79468314E+02 ,     3.79582255E+02 ,
     3.79718984E+02 ,     3.79883058E+02 ,     3.80079948E+02 ,     3.80316215E+02 ,     3.80599736E+02 ,
     3.80939961E+02 ,     3.81348230E+02 ,     3.81838154E+02 ,     3.82426063E+02 ,     3.83131553E+02 ,
     3.83978142E+02 ,     3.84994048E+02 ,     3.86213135E+02 ,     3.87676040E+02 ,     3.89431526E+02 ,
     3.91538109E+02 ,     3.94066008E+02 ,     3.97099487E+02 ,     4.00739663E+02 ,     4.01613305E+02 ,
     4.02661675E+02 ,     4.03919720E+02 ,     4.05429373E+02 ,     4.07240957E+02 ,     4.09414858E+02 ,
     4.10000000E+02 ,     4.12608681E+02 
   ])


   
   rlp_model = rlplib.Rlp2PCubic( rlptbl.Sat.values, 
                                  rlptbl.kr1.values, 
                                  rlptbl.kr2.values, 
                                  lex=0, rex=0 )    
                                  
   cpr_model = rlplib.CubicInterpolator( cprtbl.Sat.values, 
                                         cprtbl.Pc.values, 
                                         lex=0, rex=0 )
   
   model_parameters = dictn(    
        NX                 = 50, 
        core_length        = 4.905, # cm
        core_area          = 11.26, # cm2
        permeability       = 25.3, # mDarcy
        porosity           = 0.292, # v/v
        sw_initial         = 0.075, # v/v
        viscosity_w        = 0.426, # cP
        viscosity_n        = 1.4, # cP
        density_w          = 1098.0, # kg/m3
        density_n          = 782.0, # kg/m3
        rlp_model          = rlp_model,
        cpr_model          = cpr_model,
        time_end           = 410.0, # hour
        gravity_multiplier = 1.0, # 0: horizonal 1: vertical
        verbose            = 0,
        nr_tolerance       = 1e-5,
        max_dsw            = 0.1,
        start_step_size    = 10,
        max_nr_iter        = 10,
        centrifuge_rmid    = 13.6775,  # cm
        flow_direction     = "imbibition",
        acceleration_schedule  = schedule,
        movie_schedule         = movie_schedule, # hour

    )
     
   sns_model = DisplacementModel1D2P(**model_parameters)
    
   results = sns_model.solve().results

   tss = results.tss_table

   sw_ref = np.interp( tss.TIME, reference.TIME.values, reference.Sw.values )

   delta_sw = tss.Sw_avg.values - sw_ref

   assert np.abs(delta_sw).mean() < SW_TOLERANCE
    

def test_imbibition1():

   SW_TOLERANCE = 0.01

   reference = pd.DataFrame(
     columns = ['TIME','Sw'],
     data = [
       [ -1.00000000E-07 ,  0.00000000E+00 ],
       [  5.55555556E-05 ,  2.40000000E-01 ],
       [  1.22222222E-04 ,  2.40058583E-01 ],
       [  1.71829788E-04 ,  2.40102183E-01 ],
       [  2.31358867E-04 ,  2.40154513E-01 ],
       [  3.02793762E-04 ,  2.40217324E-01 ],
       [  3.88515635E-04 ,  2.40292718E-01 ],
       [  4.91381884E-04 ,  2.40383222E-01 ],
       [  6.14821382E-04 ,  2.40491870E-01 ],
       [  7.62948780E-04 ,  2.40622309E-01 ],
       [  9.40701657E-04 ,  2.40778924E-01 ],
       [  1.15400511E-03 ,  2.40966988E-01 ],
       [  1.40996925E-03 ,  2.41192844E-01 ],
       [  1.71712623E-03 ,  2.41464126E-01 ],
       [  2.08571459E-03 ,  2.41790026E-01 ],
       [  2.52802063E-03 ,  2.42181618E-01 ],
       [  3.05878788E-03 ,  2.42652257E-01 ],
       [  3.69570858E-03 ,  2.43218056E-01 ],
       [  4.46001341E-03 ,  2.43898483E-01 ],
       [  5.37717922E-03 ,  2.44717090E-01 ],
       [  6.47777818E-03 ,  2.45702422E-01 ],
       [  7.79849694E-03 ,  2.46889150E-01 ],
       [  9.38335945E-03 ,  2.48319498E-01 ],
       [  1.12851945E-02 ,  2.50045047E-01 ],
       [  1.35673965E-02 ,  2.52129051E-01 ],
       [  1.63060389E-02 ,  2.54649402E-01 ],
       [  1.95924098E-02 ,  2.57702519E-01 ],
       [  2.35360549E-02 ,  2.61408465E-01 ],
       [  2.82684290E-02 ,  2.65917821E-01 ],
       [  3.39472779E-02 ,  2.71420871E-01 ],
       [  4.07618966E-02 ,  2.78158912E-01 ],
       [  4.89394390E-02 ,  2.86431500E-01 ],
       [  5.87524899E-02 ,  2.96574666E-01 ],
       [  7.05281510E-02 ,  3.08864434E-01 ],
       [  8.46589444E-02 ,  3.23342234E-01 ],
       [  1.01615896E-01 ,  3.39690536E-01 ],
       [  1.21964239E-01 ,  3.57314496E-01 ],
       [  1.46382250E-01 ,  3.75613616E-01 ],
       [  1.75683863E-01 ,  3.94537939E-01 ],
       [  2.10845798E-01 ,  4.14199001E-01 ],
       [  2.53040121E-01 ,  4.34685848E-01 ],
       [  3.03673308E-01 ,  4.55951133E-01 ],
       [  3.64433133E-01 ,  4.77720701E-01 ],
       [  4.37344923E-01 ,  4.99506414E-01 ],
       [  5.24839071E-01 ,  5.20696253E-01 ],
       [  6.29832048E-01 ,  5.40579534E-01 ],
       [  7.55823621E-01 ,  5.58527576E-01 ],
       [  9.07013508E-01 ,  5.74114924E-01 ],
       [  1.08844137E+00 ,  5.87187585E-01 ],
       [  1.30615481E+00 ,  5.97818724E-01 ],
       [  1.56741094E+00 ,  6.06238697E-01 ],
       [  1.88091829E+00 ,  6.12778660E-01 ],
       [  2.00000000E+00 ,  6.14865518E-01 ],
       [  2.37620882E+00 ,  6.19215790E-01 ],
       [  2.82765940E+00 ,  6.22657649E-01 ],
       [  3.36940011E+00 ,  6.25359540E-01 ],
       [  4.00000000E+00 ,  6.27402145E-01 ],
       [  4.75671987E+00 ,  6.28958663E-01 ],
       [  5.66478372E+00 ,  6.30122524E-01 ],
       [  6.00000000E+00 ,  6.30478880E-01 ],
       [  7.08967662E+00 ,  6.31211263E-01 ],
       [  8.00000000E+00 ,  6.31641260E-01 ],
       [  9.30761194E+00 ,  6.32048687E-01 ],
       [  1.00000000E+01 ,  6.32222165E-01 ],
       [  1.15691343E+01 ,  6.32489789E-01 ],
       [  1.20000000E+01 ,  6.32555414E-01 ],
       [  1.38829612E+01 ,  6.32753805E-01 ],
       [  1.40000000E+01 ,  6.32765810E-01 ],
       [  1.60000000E+01 ,  6.32912746E-01 ],
       [  1.80000000E+01 ,  6.33022293E-01 ],
       [  2.00000000E+01 ,  6.33106722E-01 ],
     ]
   )

   rlptbl = pd.DataFrame(
     columns = ['Sat','kr1','kr2'],
     data = [
       [  0.00000000E+00 ,  0.00000000E+00 ,  1.00000000E+00 ],
       [  3.20000000E-01 ,  3.20000000E-01 ,  1.82014053E-01 ],
       [  3.31000000E-01 ,  3.31000000E-01 ,  1.71111497E-01 ],
       [  3.41000000E-01 ,  3.41000000E-01 ,  1.61688797E-01 ],
       [  3.63000000E-01 ,  3.63000000E-01 ,  1.42879021E-01 ],
       [  4.10000000E-01 ,  4.10000000E-01 ,  1.08240599E-01 ],
       [  4.78000000E-01 ,  4.78000000E-01 ,  6.70442904E-02 ],
       [  5.62000000E-01 ,  5.62000000E-01 ,  2.84896120E-02 ],
       [  6.15000000E-01 ,  6.15000000E-01 ,  1.12224009E-02 ],
       [  6.55000000E-01 ,  6.55000000E-01 ,  2.57892764E-03 ],
       [  6.86000000E-01 ,  6.86000000E-01 ,  0.00000000E+00 ],
       [  7.10000000E-01 ,  7.10000000E-01 ,  0.00000000E+00 ],
       [  7.39000000E-01 ,  7.39000000E-01 ,  0.00000000E+00 ],
       [  7.58000000E-01 ,  7.58000000E-01 ,  0.00000000E+00 ],
       [  7.66000000E-01 ,  7.66000000E-01 ,  0.00000000E+00 ],
       [  1.00000000E+00 ,  1.00000000E+00 ,  0.00000000E+00 ],
     ]
   )

   cprtbl = pd.DataFrame(
     columns = ['Sat','Pc'],
     data = [
       [  0.00000000E+00 , -0.00000000E+00 ],
       [  2.40000000E-01 , -0.00000000E+00 ],
       [  4.00000000E-01 , -3.80000000E-02 ],
       [  6.24000000E-01 , -1.14000000E-01 ],
       [  6.98000000E-01 , -2.28000000E-01 ],
       [  7.55000000E-01 , -4.56000000E-01 ],
       [  7.80000000E-01 , -6.10000000E-01 ],
       [  1.00000000E+00 , -1.00000000E+01 ],
     ]
   )

   schedule = pd.DataFrame(
     columns = ['StartTime','WellList','InjRate','Acceleration'],
     data = [
       [  0.00000000E+00 ,  7.68100000E+03 ,  0.00000000E+00 , -6.40000000E+03 ],
     ]
   )

   movie_schedule = np.array([
     5.55555556E-05 ,     1.22222222E-04 ,     1.71829788E-04 ,     2.31358867E-04 ,     3.02793762E-04 ,
     3.88515635E-04 ,     4.91381884E-04 ,     6.14821382E-04 ,     7.62948780E-04 ,     9.40701657E-04 ,
     1.15400511E-03 ,     1.40996925E-03 ,     1.71712623E-03 ,     2.08571459E-03 ,     2.52802063E-03 ,
     3.05878788E-03 ,     3.69570858E-03 ,     4.46001341E-03 ,     5.37717922E-03 ,     6.47777818E-03 ,
     7.79849694E-03 ,     9.38335945E-03 ,     1.12851945E-02 ,     1.35673965E-02 ,     1.63060389E-02 ,
     1.95924098E-02 ,     2.35360549E-02 ,     2.82684290E-02 ,     3.39472779E-02 ,     4.07618966E-02 ,
     4.89394390E-02 ,     5.87524899E-02 ,     7.05281510E-02 ,     8.46589444E-02 ,     1.01615896E-01 ,
     1.21964239E-01 ,     1.46382250E-01 ,     1.75683863E-01 ,     2.10845798E-01 ,     2.53040121E-01 ,
     3.03673308E-01 ,     3.64433133E-01 ,     4.37344923E-01 ,     5.24839071E-01 ,     6.29832048E-01 ,
     7.55823621E-01 ,     9.07013508E-01 ,     1.08844137E+00 ,     1.30615481E+00 ,     1.56741094E+00 ,
     1.88091829E+00 ,     2.00000000E+00 ,     2.37620882E+00 ,     2.82765940E+00 ,     3.36940011E+00 ,
     4.00000000E+00 ,     4.75671987E+00 ,     5.66478372E+00 ,     6.00000000E+00 ,     7.08967662E+00 ,
     8.00000000E+00 ,     9.30761194E+00 ,     1.00000000E+01 ,     1.15691343E+01 ,     1.20000000E+01 ,
     1.38829612E+01 ,     1.40000000E+01 ,     1.60000000E+01 ,     1.80000000E+01 ,     2.00000000E+01 ,
     2.20000000E+01 
   ])


   
   rlp_model = rlplib.Rlp2PCubic( rlptbl.Sat.values, 
                                  rlptbl.kr1.values, 
                                  rlptbl.kr2.values, 
                                  lex=0, rex=0 )    
                                  
   cpr_model = rlplib.CubicInterpolator( cprtbl.Sat.values, 
                                         cprtbl.Pc.values, 
                                         lex=0, rex=0 )
   
   model_parameters = dictn(    
        NX                 = 40, 
        core_length        = 5.0, # cm
        core_area          = 4.9, # cm2
        permeability       = 190.0, # mDarcy
        porosity           = 0.25, # v/v
        sw_initial         = 0.24, # v/v
        viscosity_w        = 0.01, # cP
        viscosity_n        = 20.0, # cP
        density_w          = 1000.0, # kg/m3
        density_n          = 810.0, # kg/m3
        rlp_model          = rlp_model,
        cpr_model          = cpr_model,
        time_end           = 20.0, # hour
        gravity_multiplier = 1.0, # 0: horizonal 1: vertical
        verbose            = 0,
        nr_tolerance       = 1e-5,
        max_dsw            = 0.1,
        start_step_size    = 10,
        max_nr_iter        = 10,
        centrifuge_rmid    = 13.5,  # cm
        flow_direction     = "imbibition",
        acceleration_schedule  = schedule,
        movie_schedule         = movie_schedule, # hour

    )
     
   sns_model = DisplacementModel1D2P(**model_parameters)
    
   results = sns_model.solve().results

   tss = results.tss_table

   sw_ref = np.interp( tss.TIME, reference.TIME.values, reference.Sw.values )

   delta_sw = tss.Sw_avg.values - sw_ref

   assert np.abs(delta_sw).mean() < SW_TOLERANCE
    

def test_imbibition2():

   SW_TOLERANCE = 0.01

   reference = pd.DataFrame(
     columns = ['TIME','Sw'],
     data = [
       [ -1.00000000E-07 ,  0.00000000E+00 ],
       [  1.11111111E-05 ,  2.40000000E-01 ],
       [  2.44444444E-05 ,  2.40011712E-01 ],
       [  3.71443701E-05 ,  2.40022869E-01 ],
       [  5.23842809E-05 ,  2.40036257E-01 ],
       [  7.06721739E-05 ,  2.40052324E-01 ],
       [  9.26176455E-05 ,  2.40071605E-01 ],
       [  1.18952211E-04 ,  2.40094745E-01 ],
       [  1.50553690E-04 ,  2.40122516E-01 ],
       [  1.88475465E-04 ,  2.40155845E-01 ],
       [  2.33981595E-04 ,  2.40195844E-01 ],
       [  2.88588951E-04 ,  2.40243852E-01 ],
       [  3.54117778E-04 ,  2.40301472E-01 ],
       [  4.32752370E-04 ,  2.40370631E-01 ],
       [  5.27113881E-04 ,  2.40453643E-01 ],
       [  6.40347694E-04 ,  2.40553290E-01 ],
       [  7.76228270E-04 ,  2.40672910E-01 ],
       [  9.39284961E-04 ,  2.40816518E-01 ],
       [  1.13495299E-03 ,  2.40988941E-01 ],
       [  1.36975462E-03 ,  2.41195981E-01 ],
       [  1.65151659E-03 ,  2.41444624E-01 ],
       [  1.98963094E-03 ,  2.41743277E-01 ],
       [  2.39536817E-03 ,  2.42102066E-01 ],
       [  2.88225284E-03 ,  2.42533202E-01 ],
       [  3.46651444E-03 ,  2.43051417E-01 ],
       [  4.16762836E-03 ,  2.43674505E-01 ],
       [  5.00896507E-03 ,  2.44423988E-01 ],
       [  6.01856912E-03 ,  2.45325946E-01 ],
       [  7.23009399E-03 ,  2.46412025E-01 ],
       [  8.68392382E-03 ,  2.47720727E-01 ],
       [  1.04285196E-02 ,  2.49299012E-01 ],
       [  1.25220346E-02 ,  2.51204355E-01 ],
       [  1.50342525E-02 ,  2.53507364E-01 ],
       [  1.80489141E-02 ,  2.56295198E-01 ],
       [  2.16665079E-02 ,  2.59676043E-01 ],
       [  2.60076206E-02 ,  2.63785089E-01 ],
       [  3.12169557E-02 ,  2.68792626E-01 ],
       [  3.74681579E-02 ,  2.74915209E-01 ],
       [  4.49696005E-02 ,  2.82431138E-01 ],
       [  5.39713316E-02 ,  2.91699573E-01 ],
       [  6.47734090E-02 ,  3.03166021E-01 ],
       [  7.77359018E-02 ,  3.17289345E-01 ],
       [  9.32908932E-02 ,  3.34320285E-01 ],
       [  1.11956883E-01 ,  3.54056538E-01 ],
       [  1.34356071E-01 ,  3.75882063E-01 ],
       [  1.61235096E-01 ,  3.99123530E-01 ],
       [  1.93489926E-01 ,  4.23378984E-01 ],
       [  2.32195722E-01 ,  4.48575503E-01 ],
       [  2.78642677E-01 ,  4.74816531E-01 ],
       [  3.34379024E-01 ,  5.02157230E-01 ],
       [  4.01262640E-01 ,  5.30053943E-01 ],
       [  4.81522979E-01 ,  5.57019470E-01 ],
       [  5.77835386E-01 ,  5.81707887E-01 ],
       [  6.93410274E-01 ,  6.03242253E-01 ],
       [  8.32100140E-01 ,  6.21209282E-01 ],
       [  9.98527979E-01 ,  6.35669507E-01 ],
       [  1.19824139E+00 ,  6.47005871E-01 ],
       [  1.43789747E+00 ,  6.55738996E-01 ],
       [  1.72548478E+00 ,  6.62359363E-01 ],
       [  2.00000000E+00 ,  6.66675789E-01 ],
       [  2.34510477E+00 ,  6.70464626E-01 ],
       [  2.75923049E+00 ,  6.73717125E-01 ],
       [  3.25618135E+00 ,  6.76402959E-01 ],
       [  3.85252239E+00 ,  6.78461069E-01 ],
       [  4.00000000E+00 ,  6.78910886E-01 ],
       [  4.71560924E+00 ,  6.80303484E-01 ],
       [  5.57434034E+00 ,  6.81381571E-01 ],
       [  6.00000000E+00 ,  6.81815899E-01 ],
       [  7.03047731E+00 ,  6.82528975E-01 ],
       [  8.00000000E+00 ,  6.83022007E-01 ],
       [  9.23657277E+00 ,  6.83475575E-01 ],
       [  1.00000000E+01 ,  6.83706510E-01 ],
       [  1.14838873E+01 ,  6.84037644E-01 ],
       [  1.20000000E+01 ,  6.84141033E-01 ],
       [  1.37806648E+01 ,  6.84406226E-01 ],
       [  1.40000000E+01 ,  6.84437633E-01 ],
       [  1.60000000E+01 ,  6.84653330E-01 ],
       [  1.80000000E+01 ,  6.84820919E-01 ],
       [  2.00000000E+01 ,  6.84954473E-01 ],
     ]
   )

   rlptbl = pd.DataFrame(
     columns = ['Sat','kr1','kr2'],
     data = [
       [  0.00000000E+00 ,  0.00000000E+00 ,  1.00000000E+00 ],
       [  3.20000000E-01 ,  3.20000000E-01 ,  1.82014053E-01 ],
       [  3.31000000E-01 ,  3.31000000E-01 ,  1.71111497E-01 ],
       [  3.41000000E-01 ,  3.41000000E-01 ,  1.61688797E-01 ],
       [  3.63000000E-01 ,  3.63000000E-01 ,  1.42879021E-01 ],
       [  4.10000000E-01 ,  4.10000000E-01 ,  1.08240599E-01 ],
       [  4.78000000E-01 ,  4.78000000E-01 ,  6.70442904E-02 ],
       [  5.62000000E-01 ,  5.62000000E-01 ,  2.84896120E-02 ],
       [  6.15000000E-01 ,  6.15000000E-01 ,  1.12224009E-02 ],
       [  6.55000000E-01 ,  6.55000000E-01 ,  2.57892764E-03 ],
       [  6.86000000E-01 ,  6.86000000E-01 ,  0.00000000E+00 ],
       [  7.10000000E-01 ,  7.10000000E-01 ,  0.00000000E+00 ],
       [  7.39000000E-01 ,  7.39000000E-01 ,  0.00000000E+00 ],
       [  7.58000000E-01 ,  7.58000000E-01 ,  0.00000000E+00 ],
       [  7.66000000E-01 ,  7.66000000E-01 ,  0.00000000E+00 ],
       [  1.00000000E+00 ,  1.00000000E+00 ,  0.00000000E+00 ],
     ]
   )

   cprtbl = pd.DataFrame(
     columns = ['Sat','Pc'],
     data = [
       [  0.00000000E+00 , -0.00000000E+00 ],
       [  1.00000000E+00 , -0.00000000E+00 ],
     ]
   )

   schedule = pd.DataFrame(
     columns = ['StartTime','WellList','InjRate','Acceleration'],
     data = [
       [  0.00000000E+00 ,  7.68100000E+03 ,  0.00000000E+00 , -6.40000000E+03 ],
     ]
   )

   movie_schedule = np.array([
     1.11111111E-05 ,     2.44444444E-05 ,     3.71443701E-05 ,     5.23842809E-05 ,     7.06721739E-05 ,
     9.26176455E-05 ,     1.18952211E-04 ,     1.50553690E-04 ,     1.88475465E-04 ,     2.33981595E-04 ,
     2.88588951E-04 ,     3.54117778E-04 ,     4.32752370E-04 ,     5.27113881E-04 ,     6.40347694E-04 ,
     7.76228270E-04 ,     9.39284961E-04 ,     1.13495299E-03 ,     1.36975462E-03 ,     1.65151659E-03 ,
     1.98963094E-03 ,     2.39536817E-03 ,     2.88225284E-03 ,     3.46651444E-03 ,     4.16762836E-03 ,
     5.00896507E-03 ,     6.01856912E-03 ,     7.23009399E-03 ,     8.68392382E-03 ,     1.04285196E-02 ,
     1.25220346E-02 ,     1.50342525E-02 ,     1.80489141E-02 ,     2.16665079E-02 ,     2.60076206E-02 ,
     3.12169557E-02 ,     3.74681579E-02 ,     4.49696005E-02 ,     5.39713316E-02 ,     6.47734090E-02 ,
     7.77359018E-02 ,     9.32908932E-02 ,     1.11956883E-01 ,     1.34356071E-01 ,     1.61235096E-01 ,
     1.93489926E-01 ,     2.32195722E-01 ,     2.78642677E-01 ,     3.34379024E-01 ,     4.01262640E-01 ,
     4.81522979E-01 ,     5.77835386E-01 ,     6.93410274E-01 ,     8.32100140E-01 ,     9.98527979E-01 ,
     1.19824139E+00 ,     1.43789747E+00 ,     1.72548478E+00 ,     2.00000000E+00 ,     2.34510477E+00 ,
     2.75923049E+00 ,     3.25618135E+00 ,     3.85252239E+00 ,     4.00000000E+00 ,     4.71560924E+00 ,
     5.57434034E+00 ,     6.00000000E+00 ,     7.03047731E+00 ,     8.00000000E+00 ,     9.23657277E+00 ,
     1.00000000E+01 ,     1.14838873E+01 ,     1.20000000E+01 ,     1.37806648E+01 ,     1.40000000E+01 ,
     1.60000000E+01 ,     1.80000000E+01 ,     2.00000000E+01 ,     2.20000000E+01 
   ])


   
   rlp_model = rlplib.Rlp2PCubic( rlptbl.Sat.values, 
                                  rlptbl.kr1.values, 
                                  rlptbl.kr2.values, 
                                  lex=0, rex=0 )    
                                  
   cpr_model = rlplib.CubicInterpolator( cprtbl.Sat.values, 
                                         cprtbl.Pc.values, 
                                         lex=0, rex=0 )
   
   model_parameters = dictn(    
        NX                 = 320, 
        core_length        = 5.0, # cm
        core_area          = 4.9, # cm2
        permeability       = 190.0, # mDarcy
        porosity           = 0.25, # v/v
        sw_initial         = 0.24, # v/v
        viscosity_w        = 0.01, # cP
        viscosity_n        = 20.0, # cP
        density_w          = 1000.0, # kg/m3
        density_n          = 810.0, # kg/m3
        rlp_model          = rlp_model,
        cpr_model          = cpr_model,
        time_end           = 20.0, # hour
        gravity_multiplier = 1.0, # 0: horizonal 1: vertical
        verbose            = 0,
        nr_tolerance       = 1e-5,
        max_dsw            = 0.1,
        start_step_size    = 10,
        max_nr_iter        = 10,
        centrifuge_rmid    = 13.5,  # cm
        flow_direction     = "imbibition",
        acceleration_schedule  = schedule,
        movie_schedule         = movie_schedule, # hour

    )
     
   sns_model = DisplacementModel1D2P(**model_parameters)
    
   results = sns_model.solve().results

   tss = results.tss_table

   sw_ref = np.interp( tss.TIME, reference.TIME.values, reference.Sw.values )

   delta_sw = tss.Sw_avg.values - sw_ref

   assert np.abs(delta_sw).mean() < SW_TOLERANCE
    

def test_imbibition3():

   SW_TOLERANCE = 0.01

   reference = pd.DataFrame(
     columns = ['TIME','Sw'],
     data = [
       [ -1.00000000E-07 ,  0.00000000E+00 ],
       [  2.77777778E-04 ,  2.40000000E-01 ],
       [  6.11111111E-04 ,  2.40293570E-01 ],
       [  1.01111111E-03 ,  2.40646312E-01 ],
       [  1.49111111E-03 ,  2.41070264E-01 ],
       [  2.06711111E-03 ,  2.41579963E-01 ],
       [  2.75831111E-03 ,  2.42192982E-01 ],
       [  3.58775111E-03 ,  2.42930588E-01 ],
       [  4.58307911E-03 ,  2.43818567E-01 ],
       [  5.77747271E-03 ,  2.44888237E-01 ],
       [  7.21074503E-03 ,  2.46177722E-01 ],
       [  8.93067182E-03 ,  2.47733544E-01 ],
       [  1.09945840E-02 ,  2.49612637E-01 ],
       [  1.34712785E-02 ,  2.51884886E-01 ],
       [  1.64433120E-02 ,  2.54636304E-01 ],
       [  2.00097522E-02 ,  2.57972934E-01 ],
       [  2.42894804E-02 ,  2.62025591E-01 ],
       [  2.94251543E-02 ,  2.66953449E-01 ],
       [  3.55879629E-02 ,  2.72946970E-01 ],
       [  4.29833332E-02 ,  2.80223475E-01 ],
       [  5.18577777E-02 ,  2.89011659E-01 ],
       [  6.25071110E-02 ,  2.99519725E-01 ],
       [  7.52863110E-02 ,  3.11888350E-01 ],
       [  9.06213509E-02 ,  3.26156729E-01 ],
       [  1.09023399E-01 ,  3.42247676E-01 ],
       [  1.31105856E-01 ,  3.59988711E-01 ],
       [  1.57604806E-01 ,  3.79218241E-01 ],
       [  1.89403544E-01 ,  3.99775962E-01 ],
       [  2.27562031E-01 ,  4.21604158E-01 ],
       [  2.73352215E-01 ,  4.44739055E-01 ],
       [  3.28300436E-01 ,  4.69215937E-01 ],
       [  3.94238301E-01 ,  4.94456135E-01 ],
       [  4.73363739E-01 ,  5.19653839E-01 ],
       [  5.68314264E-01 ,  5.43979673E-01 ],
       [  6.82254895E-01 ,  5.66720458E-01 ],
       [  8.18983652E-01 ,  5.87348769E-01 ],
       [  9.83058160E-01 ,  6.05450390E-01 ],
       [  1.17994757E+00 ,  6.20947408E-01 ],
       [  1.41621486E+00 ,  6.33885092E-01 ],
       [  1.69973561E+00 ,  6.44492310E-01 ],
       [  2.00000000E+00 ,  6.52303902E-01 ],
       [  2.36031727E+00 ,  6.58654087E-01 ],
       [  2.79269799E+00 ,  6.63874855E-01 ],
       [  3.31155485E+00 ,  6.68294314E-01 ],
       [  3.93418309E+00 ,  6.72048305E-01 ],
       [  4.00000000E+00 ,  6.72429229E-01 ],
       [  4.74715388E+00 ,  6.75303638E-01 ],
       [  5.64373855E+00 ,  6.77567797E-01 ],
       [  6.00000000E+00 ,  6.78325757E-01 ],
       [  7.07590159E+00 ,  6.79857865E-01 ],
       [  8.00000000E+00 ,  6.80821218E-01 ],
       [  9.29108191E+00 ,  6.81760414E-01 ],
       [  1.00000000E+01 ,  6.82185493E-01 ],
       [  1.15492983E+01 ,  6.82848468E-01 ],
       [  1.20000000E+01 ,  6.83022555E-01 ],
       [  1.38591580E+01 ,  6.83541437E-01 ],
       [  1.40000000E+01 ,  6.83579679E-01 ],
       [  1.60000000E+01 ,  6.83980439E-01 ],
       [  1.80000000E+01 ,  6.84286479E-01 ],
       [  2.00000000E+01 ,  6.84526799E-01 ],
     ]
   )

   rlptbl = pd.DataFrame(
     columns = ['Sat','kr1','kr2'],
     data = [
       [  0.00000000E+00 ,  0.00000000E+00 ,  1.00000000E+00 ],
       [  3.20000000E-01 ,  3.20000000E-01 ,  1.82014053E-01 ],
       [  3.31000000E-01 ,  3.31000000E-01 ,  1.71111497E-01 ],
       [  3.41000000E-01 ,  3.41000000E-01 ,  1.61688797E-01 ],
       [  3.63000000E-01 ,  3.63000000E-01 ,  1.42879021E-01 ],
       [  4.10000000E-01 ,  4.10000000E-01 ,  1.08240599E-01 ],
       [  4.78000000E-01 ,  4.78000000E-01 ,  6.70442904E-02 ],
       [  5.62000000E-01 ,  5.62000000E-01 ,  2.84896120E-02 ],
       [  6.15000000E-01 ,  6.15000000E-01 ,  1.12224009E-02 ],
       [  6.55000000E-01 ,  6.55000000E-01 ,  2.57892764E-03 ],
       [  6.86000000E-01 ,  6.86000000E-01 ,  0.00000000E+00 ],
       [  7.10000000E-01 ,  7.10000000E-01 ,  0.00000000E+00 ],
       [  7.39000000E-01 ,  7.39000000E-01 ,  0.00000000E+00 ],
       [  7.58000000E-01 ,  7.58000000E-01 ,  0.00000000E+00 ],
       [  7.66000000E-01 ,  7.66000000E-01 ,  0.00000000E+00 ],
       [  1.00000000E+00 ,  1.00000000E+00 ,  0.00000000E+00 ],
     ]
   )

   cprtbl = pd.DataFrame(
     columns = ['Sat','Pc'],
     data = [
       [  0.00000000E+00 , -0.00000000E+00 ],
       [  1.00000000E+00 , -0.00000000E+00 ],
     ]
   )

   schedule = pd.DataFrame(
     columns = ['StartTime','WellList','InjRate','Acceleration'],
     data = [
       [  0.00000000E+00 ,  7.68100000E+03 ,  0.00000000E+00 , -6.40000000E+03 ],
     ]
   )

   movie_schedule = np.array([
     2.77777778E-04 ,     6.11111111E-04 ,     1.01111111E-03 ,     1.49111111E-03 ,     2.06711111E-03 ,
     2.75831111E-03 ,     3.58775111E-03 ,     4.58307911E-03 ,     5.77747271E-03 ,     7.21074503E-03 ,
     8.93067182E-03 ,     1.09945840E-02 ,     1.34712785E-02 ,     1.64433120E-02 ,     2.00097522E-02 ,
     2.42894804E-02 ,     2.94251543E-02 ,     3.55879629E-02 ,     4.29833332E-02 ,     5.18577777E-02 ,
     6.25071110E-02 ,     7.52863110E-02 ,     9.06213509E-02 ,     1.09023399E-01 ,     1.31105856E-01 ,
     1.57604806E-01 ,     1.89403544E-01 ,     2.27562031E-01 ,     2.73352215E-01 ,     3.28300436E-01 ,
     3.94238301E-01 ,     4.73363739E-01 ,     5.68314264E-01 ,     6.82254895E-01 ,     8.18983652E-01 ,
     9.83058160E-01 ,     1.17994757E+00 ,     1.41621486E+00 ,     1.69973561E+00 ,     2.00000000E+00 ,
     2.36031727E+00 ,     2.79269799E+00 ,     3.31155485E+00 ,     3.93418309E+00 ,     4.00000000E+00 ,
     4.74715388E+00 ,     5.64373855E+00 ,     6.00000000E+00 ,     7.07590159E+00 ,     8.00000000E+00 ,
     9.29108191E+00 ,     1.00000000E+01 ,     1.15492983E+01 ,     1.20000000E+01 ,     1.38591580E+01 ,
     1.40000000E+01 ,     1.60000000E+01 ,     1.80000000E+01 ,     2.00000000E+01 ,     2.20000000E+01 
   ])


   
   rlp_model = rlplib.Rlp2PCubic( rlptbl.Sat.values, 
                                  rlptbl.kr1.values, 
                                  rlptbl.kr2.values, 
                                  lex=0, rex=0 )    
                                  
   cpr_model = rlplib.CubicInterpolator( cprtbl.Sat.values, 
                                         cprtbl.Pc.values, 
                                         lex=0, rex=0 )
   
   model_parameters = dictn(    
        NX                 = 12, 
        core_length        = 5.0, # cm
        core_area          = 4.9, # cm2
        permeability       = 190.0, # mDarcy
        porosity           = 0.25, # v/v
        sw_initial         = 0.24, # v/v
        viscosity_w        = 0.01, # cP
        viscosity_n        = 20.0, # cP
        density_w          = 1000.0, # kg/m3
        density_n          = 810.0, # kg/m3
        rlp_model          = rlp_model,
        cpr_model          = cpr_model,
        time_end           = 20.0, # hour
        gravity_multiplier = 1.0, # 0: horizonal 1: vertical
        verbose            = 0,
        nr_tolerance       = 1e-5,
        max_dsw            = 0.1,
        start_step_size    = 10,
        max_nr_iter        = 10,
        centrifuge_rmid    = 13.5,  # cm
        flow_direction     = "imbibition",
        acceleration_schedule  = schedule,
        movie_schedule         = movie_schedule, # hour

    )
     
   sns_model = DisplacementModel1D2P(**model_parameters)
    
   results = sns_model.solve().results

   tss = results.tss_table

   sw_ref = np.interp( tss.TIME, reference.TIME.values, reference.Sw.values )

   delta_sw = tss.Sw_avg.values - sw_ref

   assert np.abs(delta_sw).mean() < SW_TOLERANCE
    

def test_imbibition4():

   SW_TOLERANCE = 0.01

   reference = pd.DataFrame(
     columns = ['TIME','Sw'],
     data = [
       [ -1.00000000E-07 ,  0.00000000E+00 ],
       [  2.77777778E-04 ,  2.40000000E-01 ],
       [  6.11111111E-04 ,  2.40000035E-01 ],
       [  1.01111111E-03 ,  2.40000238E-01 ],
       [  1.49111111E-03 ,  2.40000922E-01 ],
       [  2.06711111E-03 ,  2.40002548E-01 ],
       [  2.75831111E-03 ,  2.40010118E-01 ],
       [  3.58775111E-03 ,  2.40026205E-01 ],
       [  4.58307911E-03 ,  2.40046291E-01 ],
       [  4.82195783E-03 ,  2.40059246E-01 ],
       [  5.10861230E-03 ,  2.40076182E-01 ],
       [  5.45259765E-03 ,  2.40090170E-01 ],
       [  5.86538008E-03 ,  2.40108850E-01 ],
       [  5.96444786E-03 ,  2.40113153E-01 ],
       [  6.08332920E-03 ,  2.40118495E-01 ],
       [  6.22598681E-03 ,  2.40125170E-01 ],
       [  6.39717594E-03 ,  2.40133571E-01 ],
       [  6.60260289E-03 ,  2.40144232E-01 ],
       [  6.84911524E-03 ,  2.40157886E-01 ],
       [  7.14493005E-03 ,  2.40175555E-01 ],
       [  7.49990783E-03 ,  2.40201064E-01 ],
       [  7.92588116E-03 ,  2.40234408E-01 ],
       [  8.43704916E-03 ,  2.40275432E-01 ],
       [  9.05045076E-03 ,  2.40331499E-01 ],
       [  9.78653268E-03 ,  2.40404825E-01 ],
       [  1.06698310E-02 ,  2.40496506E-01 ],
       [  1.17297889E-02 ,  2.40602335E-01 ],
       [  1.30017385E-02 ,  2.40729351E-01 ],
       [  1.45280780E-02 ,  2.40881425E-01 ],
       [  1.63596853E-02 ,  2.41063092E-01 ],
       [  1.85576142E-02 ,  2.41279563E-01 ],
       [  2.11951288E-02 ,  2.41536793E-01 ],
       [  2.43601463E-02 ,  2.41842053E-01 ],
       [  2.81581673E-02 ,  2.42190029E-01 ],
       [  3.27157925E-02 ,  2.42599527E-01 ],
       [  3.81849428E-02 ,  2.43082773E-01 ],
       [  4.47479231E-02 ,  2.43652334E-01 ],
       [  5.26234995E-02 ,  2.44323364E-01 ],
       [  6.20741912E-02 ,  2.45112684E-01 ],
       [  7.34150212E-02 ,  2.46039278E-01 ],
       [  8.70240172E-02 ,  2.47125857E-01 ],
       [  1.03354812E-01 ,  2.48398184E-01 ],
       [  1.22951767E-01 ,  2.49882476E-01 ],
       [  1.46468112E-01 ,  2.51613295E-01 ],
       [  1.74687726E-01 ,  2.53622432E-01 ],
       [  2.08551263E-01 ,  2.55953244E-01 ],
       [  2.49187507E-01 ,  2.58645095E-01 ],
       [  2.97951000E-01 ,  2.61745103E-01 ],
       [  3.56467192E-01 ,  2.65306148E-01 ],
       [  4.26686622E-01 ,  2.69378185E-01 ],
       [  5.10949938E-01 ,  2.74011576E-01 ],
       [  6.12065918E-01 ,  2.79257422E-01 ],
       [  7.33405093E-01 ,  2.85154842E-01 ],
       [  8.79012104E-01 ,  2.91730078E-01 ],
       [  1.05374052E+00 ,  2.98984755E-01 ],
       [  1.26341461E+00 ,  3.06895168E-01 ],
       [  1.50000000E+00 ,  3.14937872E-01 ],
       [  1.78390247E+00 ,  3.23493470E-01 ],
       [  2.12458543E+00 ,  3.32418286E-01 ],
       [  2.53340498E+00 ,  3.41517344E-01 ],
       [  3.00000000E+00 ,  3.50177219E-01 ],
       [  3.55991403E+00 ,  3.58577221E-01 ],
       [  4.23181086E+00 ,  3.66458435E-01 ],
       [  4.50000000E+00 ,  3.69284359E-01 ],
       [  5.00000000E+00 ,  3.73654370E-01 ],
       [  5.00027778E+00 ,  3.73656798E-01 ],
       [  5.00061111E+00 ,  3.73661477E-01 ],
       [  5.00101111E+00 ,  3.73669298E-01 ],
       [  5.00149111E+00 ,  3.73681805E-01 ],
       [  5.00206711E+00 ,  3.73701444E-01 ],
       [  5.00275831E+00 ,  3.73732001E-01 ],
       [  5.00348601E+00 ,  3.73773699E-01 ],
       [  5.00421371E+00 ,  3.73825975E-01 ],
       [  5.00508695E+00 ,  3.73889782E-01 ],
       [  5.00613483E+00 ,  3.73965617E-01 ],
       [  5.00739230E+00 ,  3.74056464E-01 ],
       [  5.00890126E+00 ,  3.74165383E-01 ],
       [  5.01071200E+00 ,  3.74295965E-01 ],
       [  5.01288490E+00 ,  3.74452494E-01 ],
       [  5.01549238E+00 ,  3.74640093E-01 ],
       [  5.01862135E+00 ,  3.74864880E-01 ],
       [  5.02237612E+00 ,  3.75134154E-01 ],
       [  5.02688184E+00 ,  3.75456619E-01 ],
       [  5.03228870E+00 ,  3.75842630E-01 ],
       [  5.03877694E+00 ,  3.76304498E-01 ],
       [  5.04656283E+00 ,  3.76856818E-01 ],
       [  5.05590589E+00 ,  3.77516852E-01 ],
       [  5.06711756E+00 ,  3.78304956E-01 ],
       [  5.08057157E+00 ,  3.79245030E-01 ],
       [  5.09671639E+00 ,  3.80364992E-01 ],
       [  5.11609016E+00 ,  3.81697234E-01 ],
       [  5.13933869E+00 ,  3.83279031E-01 ],
       [  5.16723693E+00 ,  3.85152805E-01 ],
       [  5.20071481E+00 ,  3.87366117E-01 ],
       [  5.24088827E+00 ,  3.89971157E-01 ],
       [  5.28909642E+00 ,  3.93023800E-01 ],
       [  5.34694620E+00 ,  3.96581573E-01 ],
       [  5.41636593E+00 ,  4.00700541E-01 ],
       [  5.49966962E+00 ,  4.05429996E-01 ],
       [  5.59963404E+00 ,  4.10804251E-01 ],
       [  5.71959134E+00 ,  4.16834745E-01 ],
       [  5.86354011E+00 ,  4.23507199E-01 ],
       [  6.00000000E+00 ,  4.29353799E-01 ],
       [  6.17273852E+00 ,  4.36033608E-01 ],
       [  6.38002474E+00 ,  4.43129818E-01 ],
       [  6.62876821E+00 ,  4.50482870E-01 ],
       [  6.92726037E+00 ,  4.57870290E-01 ],
       [  7.28545096E+00 ,  4.65087141E-01 ],
       [  7.50000000E+00 ,  4.68876948E-01 ],
       [  7.92982871E+00 ,  4.74830512E-01 ],
       [  8.00000000E+00 ,  4.75760736E-01 ],
       [  8.00027778E+00 ,  4.75764417E-01 ],
       [  8.00061111E+00 ,  4.75770880E-01 ],
       [  8.00101111E+00 ,  4.75781030E-01 ],
       [  8.00149111E+00 ,  4.75796553E-01 ],
       [  8.00206711E+00 ,  4.75820097E-01 ],
       [  8.00275831E+00 ,  4.75855685E-01 ],
       [  8.00358775E+00 ,  4.75909413E-01 ],
       [  8.00458308E+00 ,  4.75990605E-01 ],
       [  8.00561220E+00 ,  4.76096928E-01 ],
       [  8.00684715E+00 ,  4.76238164E-01 ],
       [  8.00832908E+00 ,  4.76405264E-01 ],
       [  8.01010741E+00 ,  4.76605324E-01 ],
       [  8.01224139E+00 ,  4.76844922E-01 ],
       [  8.01480218E+00 ,  4.77131767E-01 ],
       [  8.01787512E+00 ,  4.77475008E-01 ],
       [  8.02156265E+00 ,  4.77885490E-01 ],
       [  8.02598768E+00 ,  4.78376025E-01 ],
       [  8.03129773E+00 ,  4.78961717E-01 ],
       [  8.03766978E+00 ,  4.79660280E-01 ],
       [  8.04531624E+00 ,  4.80492443E-01 ],
       [  8.05449199E+00 ,  4.81482181E-01 ],
       [  8.06550290E+00 ,  4.82657034E-01 ],
       [  8.07871598E+00 ,  4.84048383E-01 ],
       [  8.09457169E+00 ,  4.85691544E-01 ],
       [  8.11359853E+00 ,  4.87625250E-01 ],
       [  8.13643074E+00 ,  4.89890905E-01 ],
       [  8.16382940E+00 ,  4.92531700E-01 ],
       [  8.19670778E+00 ,  4.95589542E-01 ],
       [  8.23616184E+00 ,  4.99103453E-01 ],
       [  8.28350672E+00 ,  5.03104716E-01 ],
       [  8.34032057E+00 ,  5.07608341E-01 ],
       [  8.40849719E+00 ,  5.12607450E-01 ],
       [  8.49030913E+00 ,  5.18079184E-01 ],
       [  8.58848347E+00 ,  5.23966163E-01 ],
       [  8.70629267E+00 ,  5.30161634E-01 ],
       [  8.84766371E+00 ,  5.36503466E-01 ],
       [  9.00000000E+00 ,  5.42269211E-01 ],
       [  9.18280355E+00 ,  5.47963760E-01 ],
       [  9.40216782E+00 ,  5.53427539E-01 ],
       [  9.66540493E+00 ,  5.58519986E-01 ],
       [  9.98128948E+00 ,  5.63139718E-01 ],
       [  1.03603509E+01 ,  5.67231575E-01 ],
       [  1.05000000E+01 ,  5.68571877E-01 ],
       [  1.09548737E+01 ,  5.71774066E-01 ],
       [  1.10000000E+01 ,  5.72080906E-01 ],
       [  1.10002778E+01 ,  5.72082795E-01 ],
       [  1.10006111E+01 ,  5.72095759E-01 ],
       [  1.10010111E+01 ,  5.72104155E-01 ],
       [  1.10014911E+01 ,  5.72117674E-01 ],
       [  1.10020671E+01 ,  5.72139244E-01 ],
       [  1.10027583E+01 ,  5.72173076E-01 ],
       [  1.10035878E+01 ,  5.72225477E-01 ],
       [  1.10045831E+01 ,  5.72305949E-01 ],
       [  1.10057775E+01 ,  5.72428869E-01 ],
       [  1.10072107E+01 ,  5.72616065E-01 ],
       [  1.10086661E+01 ,  5.72857930E-01 ],
       [  1.10104126E+01 ,  5.73144167E-01 ],
       [  1.10125084E+01 ,  5.73484957E-01 ],
       [  1.10150233E+01 ,  5.73890602E-01 ],
       [  1.10180412E+01 ,  5.74372601E-01 ],
       [  1.10216627E+01 ,  5.74944084E-01 ],
       [  1.10260085E+01 ,  5.75620302E-01 ],
       [  1.10312235E+01 ,  5.76417933E-01 ],
       [  1.10374814E+01 ,  5.77354996E-01 ],
       [  1.10449910E+01 ,  5.78450526E-01 ],
       [  1.10540024E+01 ,  5.79724583E-01 ],
       [  1.10648161E+01 ,  5.81197777E-01 ],
       [  1.10777926E+01 ,  5.82886827E-01 ],
       [  1.10933644E+01 ,  5.84804172E-01 ],
       [  1.11120505E+01 ,  5.86959059E-01 ],
       [  1.11165352E+01 ,  5.87468272E-01 ],
       [  1.11219168E+01 ,  5.88067921E-01 ],
       [  1.11283747E+01 ,  5.88771308E-01 ],
       [  1.11361242E+01 ,  5.89592470E-01 ],
       [  1.11454236E+01 ,  5.90545645E-01 ],
       [  1.11565829E+01 ,  5.91644479E-01 ],
       [  1.11699741E+01 ,  5.92901016E-01 ],
       [  1.11860435E+01 ,  5.94324510E-01 ],
       [  1.12053267E+01 ,  5.95920005E-01 ],
       [  1.12099547E+01 ,  5.96296555E-01 ],
       [  1.12155083E+01 ,  5.96739455E-01 ],
       [  1.12221726E+01 ,  5.97258391E-01 ],
       [  1.12301697E+01 ,  5.97863655E-01 ],
       [  1.12397663E+01 ,  5.98565841E-01 ],
       [  1.12512822E+01 ,  5.99375450E-01 ],
       [  1.12651013E+01 ,  6.00302415E-01 ],
       [  1.12816842E+01 ,  6.01354629E-01 ],
       [  1.13015837E+01 ,  6.02537096E-01 ],
       [  1.13254630E+01 ,  6.03850875E-01 ],
       [  1.13541183E+01 ,  6.05292213E-01 ],
       [  1.13885046E+01 ,  6.06852283E-01 ],
       [  1.14297681E+01 ,  6.08516167E-01 ],
       [  1.14396714E+01 ,  6.08904002E-01 ],
       [  1.14515553E+01 ,  6.09353638E-01 ],
       [  1.14658160E+01 ,  6.09871776E-01 ],
       [  1.14829288E+01 ,  6.10464727E-01 ],
       [  1.15034642E+01 ,  6.11137980E-01 ],
       [  1.15281067E+01 ,  6.11895708E-01 ],
       [  1.15576776E+01 ,  6.12740256E-01 ],
       [  1.15931628E+01 ,  6.13671618E-01 ],
       [  1.16357449E+01 ,  6.14687176E-01 ],
       [  1.16868436E+01 ,  6.15781662E-01 ],
       [  1.17481619E+01 ,  6.16947666E-01 ],
       [  1.18217439E+01 ,  6.18176895E-01 ],
       [  1.19100423E+01 ,  6.19462048E-01 ],
       [  1.20000000E+01 ,  6.20617349E-01 ],
       [  1.21079493E+01 ,  6.21835454E-01 ],
       [  1.22374884E+01 ,  6.23116195E-01 ],
       [  1.23929353E+01 ,  6.24462738E-01 ],
       [  1.25794716E+01 ,  6.25879344E-01 ],
       [  1.28033151E+01 ,  6.27369631E-01 ],
       [  1.30719274E+01 ,  6.28933957E-01 ],
       [  1.33942622E+01 ,  6.30565627E-01 ],
       [  1.35000000E+01 ,  6.31076936E-01 ],
       [  1.38868017E+01 ,  6.32691651E-01 ],
       [  1.43509637E+01 ,  6.34336671E-01 ],
       [  1.49079581E+01 ,  6.35975028E-01 ],
       [  1.50000000E+01 ,  6.36237031E-01 ],
     ]
   )

   rlptbl = pd.DataFrame(
     columns = ['Sat','kr1','kr2'],
     data = [
       [  0.00000000E+00 ,  0.00000000E+00 ,  1.00000000E+00 ],
       [  2.40000000E-01 ,  0.00000000E+00 ,  2.89500000E-01 ],
       [  2.40800000E-01 ,  1.00000000E-09 ,  2.88960000E-01 ],
       [  2.41500000E-01 ,  8.00000000E-09 ,  2.88430000E-01 ],
       [  2.43800000E-01 ,  1.25000000E-07 ,  2.86020000E-01 ],
       [  2.47600000E-01 ,  1.00000000E-06 ,  2.79900000E-01 ],
       [  2.55200000E-01 ,  8.00000000E-06 ,  2.63780000E-01 ],
       [  2.78000000E-01 ,  1.25000000E-04 ,  2.28540000E-01 ],
       [  3.16000000E-01 ,  1.00000000E-03 ,  1.86060000E-01 ],
       [  3.20000000E-01 ,  1.15330000E-03 ,  1.82010000E-01 ],
       [  3.31000000E-01 ,  1.72430000E-03 ,  1.71110000E-01 ],
       [  3.41000000E-01 ,  2.42000000E-03 ,  1.61690000E-01 ],
       [  3.63000000E-01 ,  4.46350000E-03 ,  1.42880000E-01 ],
       [  3.92000000E-01 ,  8.00000000E-03 ,  1.20810000E-01 ],
       [  4.10000000E-01 ,  1.10290000E-02 ,  1.08240000E-01 ],
       [  4.68000000E-01 ,  2.70000000E-02 ,  7.26500000E-02 ],
       [  4.78000000E-01 ,  3.05520000E-02 ,  6.70440000E-02 ],
       [  5.44000000E-01 ,  6.40000000E-02 ,  3.55120000E-02 ],
       [  5.62000000E-01 ,  7.58710000E-02 ,  2.84900000E-02 ],
       [  6.15000000E-01 ,  1.20240000E-01 ,  1.12220000E-02 ],
       [  6.20000000E-01 ,  1.25000000E-01 ,  9.85540000E-03 ],
       [  6.55000000E-01 ,  1.62780000E-01 ,  2.57890000E-03 ],
       [  6.98000000E-01 ,  2.02270000E-01 ,  1.57890000E-04 ],
       [  7.03000000E-01 ,  2.16000000E-01 ,  0.00000000E+00 ],
       [  7.10000000E-01 ,  2.36320000E-01 ,  0.00000000E+00 ],
       [  7.39000000E-01 ,  2.83110000E-01 ,  0.00000000E+00 ],
       [  7.58000000E-01 ,  3.16820000E-01 ,  0.00000000E+00 ],
       [  7.66000000E-01 ,  3.31650000E-01 ,  0.00000000E+00 ],
       [  7.72000000E-01 ,  3.43000000E-01 ,  0.00000000E+00 ],
       [  8.48000000E-01 ,  5.12000000E-01 ,  0.00000000E+00 ],
       [  9.24000000E-01 ,  7.29000000E-01 ,  0.00000000E+00 ],
       [  9.62000000E-01 ,  8.57370000E-01 ,  0.00000000E+00 ],
       [  9.84800000E-01 ,  9.41190000E-01 ,  0.00000000E+00 ],
       [  9.92400000E-01 ,  9.70300000E-01 ,  0.00000000E+00 ],
       [  9.96200000E-01 ,  9.85070000E-01 ,  0.00000000E+00 ],
       [  9.98500000E-01 ,  9.94010000E-01 ,  0.00000000E+00 ],
       [  9.99200000E-01 ,  9.97000000E-01 ,  0.00000000E+00 ],
       [  1.00000000E+00 ,  1.00000000E+00 ,  0.00000000E+00 ],
     ]
   )

   cprtbl = pd.DataFrame(
     columns = ['Sat','Pc'],
     data = [
       [  0.00000000E+00 , -0.00000000E+00 ],
       [  2.40000000E-01 , -0.00000000E+00 ],
       [  4.00000000E-01 , -3.80000000E-02 ],
       [  6.24000000E-01 , -1.14000000E-01 ],
       [  6.98000000E-01 , -2.28000000E-01 ],
       [  7.55000000E-01 , -4.56000000E-01 ],
       [  7.80000000E-01 , -6.10000000E-01 ],
       [  1.00000000E+00 , -1.00000000E+01 ],
     ]
   )

   schedule = pd.DataFrame(
     columns = ['StartTime','WellList','InjRate','Acceleration'],
     data = [
       [  0.00000000E+00 ,  7.68100000E+03 ,  0.00000000E+00 , -8.00000000E+02 ],
       [  5.00000000E+00 ,  7.68100000E+03 ,  0.00000000E+00 , -1.60000000E+03 ],
       [  8.00000000E+00 ,  7.68100000E+03 ,  0.00000000E+00 , -3.20000000E+03 ],
       [  1.10000000E+01 ,  7.68100000E+03 ,  0.00000000E+00 , -6.40000000E+03 ],
     ]
   )

   movie_schedule = np.array([
     2.77777778E-04 ,     6.11111111E-04 ,     1.01111111E-03 ,     1.49111111E-03 ,     2.06711111E-03 ,
     2.75831111E-03 ,     3.58775111E-03 ,     4.58307911E-03 ,     4.82195783E-03 ,     5.10861230E-03 ,
     5.45259765E-03 ,     5.86538008E-03 ,     5.96444786E-03 ,     6.08332920E-03 ,     6.22598681E-03 ,
     6.39717594E-03 ,     6.60260289E-03 ,     6.84911524E-03 ,     7.14493005E-03 ,     7.49990783E-03 ,
     7.92588116E-03 ,     8.43704916E-03 ,     9.05045076E-03 ,     9.78653268E-03 ,     1.06698310E-02 ,
     1.17297889E-02 ,     1.30017385E-02 ,     1.45280780E-02 ,     1.63596853E-02 ,     1.85576142E-02 ,
     2.11951288E-02 ,     2.43601463E-02 ,     2.81581673E-02 ,     3.27157925E-02 ,     3.81849428E-02 ,
     4.47479231E-02 ,     5.26234995E-02 ,     6.20741912E-02 ,     7.34150212E-02 ,     8.70240172E-02 ,
     1.03354812E-01 ,     1.22951767E-01 ,     1.46468112E-01 ,     1.74687726E-01 ,     2.08551263E-01 ,
     2.49187507E-01 ,     2.97951000E-01 ,     3.56467192E-01 ,     4.26686622E-01 ,     5.10949938E-01 ,
     6.12065918E-01 ,     7.33405093E-01 ,     8.79012104E-01 ,     1.05374052E+00 ,     1.26341461E+00 ,
     1.50000000E+00 ,     1.78390247E+00 ,     2.12458543E+00 ,     2.53340498E+00 ,     3.00000000E+00 ,
     3.55991403E+00 ,     4.23181086E+00 ,     4.50000000E+00 ,     5.00000000E+00 ,     5.00027778E+00 ,
     5.00061111E+00 ,     5.00101111E+00 ,     5.00149111E+00 ,     5.00206711E+00 ,     5.00275831E+00 ,
     5.00348601E+00 ,     5.00421371E+00 ,     5.00508695E+00 ,     5.00613483E+00 ,     5.00739230E+00 ,
     5.00890126E+00 ,     5.01071200E+00 ,     5.01288490E+00 ,     5.01549238E+00 ,     5.01862135E+00 ,
     5.02237612E+00 ,     5.02688184E+00 ,     5.03228870E+00 ,     5.03877694E+00 ,     5.04656283E+00 ,
     5.05590589E+00 ,     5.06711756E+00 ,     5.08057157E+00 ,     5.09671639E+00 ,     5.11609016E+00 ,
     5.13933869E+00 ,     5.16723693E+00 ,     5.20071481E+00 ,     5.24088827E+00 ,     5.28909642E+00 ,
     5.34694620E+00 ,     5.41636593E+00 ,     5.49966962E+00 ,     5.59963404E+00 ,     5.71959134E+00 ,
     5.86354011E+00 ,     6.00000000E+00 ,     6.17273852E+00 ,     6.38002474E+00 ,     6.62876821E+00 ,
     6.92726037E+00 ,     7.28545096E+00 ,     7.50000000E+00 ,     7.92982871E+00 ,     8.00000000E+00 ,
     8.00027778E+00 ,     8.00061111E+00 ,     8.00101111E+00 ,     8.00149111E+00 ,     8.00206711E+00 ,
     8.00275831E+00 ,     8.00358775E+00 ,     8.00458308E+00 ,     8.00561220E+00 ,     8.00684715E+00 ,
     8.00832908E+00 ,     8.01010741E+00 ,     8.01224139E+00 ,     8.01480218E+00 ,     8.01787512E+00 ,
     8.02156265E+00 ,     8.02598768E+00 ,     8.03129773E+00 ,     8.03766978E+00 ,     8.04531624E+00 ,
     8.05449199E+00 ,     8.06550290E+00 ,     8.07871598E+00 ,     8.09457169E+00 ,     8.11359853E+00 ,
     8.13643074E+00 ,     8.16382940E+00 ,     8.19670778E+00 ,     8.23616184E+00 ,     8.28350672E+00 ,
     8.34032057E+00 ,     8.40849719E+00 ,     8.49030913E+00 ,     8.58848347E+00 ,     8.70629267E+00 ,
     8.84766371E+00 ,     9.00000000E+00 ,     9.18280355E+00 ,     9.40216782E+00 ,     9.66540493E+00 ,
     9.98128948E+00 ,     1.03603509E+01 ,     1.05000000E+01 ,     1.09548737E+01 ,     1.10000000E+01 ,
     1.10002778E+01 ,     1.10006111E+01 ,     1.10010111E+01 ,     1.10014911E+01 ,     1.10020671E+01 ,
     1.10027583E+01 ,     1.10035878E+01 ,     1.10045831E+01 ,     1.10057775E+01 ,     1.10072107E+01 ,
     1.10086661E+01 ,     1.10104126E+01 ,     1.10125084E+01 ,     1.10150233E+01 ,     1.10180412E+01 ,
     1.10216627E+01 ,     1.10260085E+01 ,     1.10312235E+01 ,     1.10374814E+01 ,     1.10449910E+01 ,
     1.10540024E+01 ,     1.10648161E+01 ,     1.10777926E+01 ,     1.10933644E+01 ,     1.11120505E+01 ,
     1.11165352E+01 ,     1.11219168E+01 ,     1.11283747E+01 ,     1.11361242E+01 ,     1.11454236E+01 ,
     1.11565829E+01 ,     1.11699741E+01 ,     1.11860435E+01 ,     1.12053267E+01 ,     1.12099547E+01 ,
     1.12155083E+01 ,     1.12221726E+01 ,     1.12301697E+01 ,     1.12397663E+01 ,     1.12512822E+01 ,
     1.12651013E+01 ,     1.12816842E+01 ,     1.13015837E+01 ,     1.13254630E+01 ,     1.13541183E+01 ,
     1.13885046E+01 ,     1.14297681E+01 ,     1.14396714E+01 ,     1.14515553E+01 ,     1.14658160E+01 ,
     1.14829288E+01 ,     1.15034642E+01 ,     1.15281067E+01 ,     1.15576776E+01 ,     1.15931628E+01 ,
     1.16357449E+01 ,     1.16868436E+01 ,     1.17481619E+01 ,     1.18217439E+01 ,     1.19100423E+01 ,
     1.20000000E+01 ,     1.21079493E+01 ,     1.22374884E+01 ,     1.23929353E+01 ,     1.25794716E+01 ,
     1.28033151E+01 ,     1.30719274E+01 ,     1.33942622E+01 ,     1.35000000E+01 ,     1.38868017E+01 ,
     1.43509637E+01 ,     1.49079581E+01 ,     1.50000000E+01 ,     1.56683933E+01 
   ])


   
   rlp_model = rlplib.Rlp2PCubic( rlptbl.Sat.values, 
                                  rlptbl.kr1.values, 
                                  rlptbl.kr2.values, 
                                  lex=0, rex=0 )    
                                  
   cpr_model = rlplib.CubicInterpolator( cprtbl.Sat.values, 
                                         cprtbl.Pc.values, 
                                         lex=0, rex=0 )
   
   model_parameters = dictn(    
        NX                 = 40, 
        core_length        = 5.0, # cm
        core_area          = 4.9, # cm2
        permeability       = 190.0, # mDarcy
        porosity           = 0.25, # v/v
        sw_initial         = 0.24, # v/v
        viscosity_w        = 1.0, # cP
        viscosity_n        = 20.0, # cP
        density_w          = 1000.0, # kg/m3
        density_n          = 810.0, # kg/m3
        rlp_model          = rlp_model,
        cpr_model          = cpr_model,
        time_end           = 15.0, # hour
        gravity_multiplier = 1.0, # 0: horizonal 1: vertical
        verbose            = 0,
        nr_tolerance       = 1e-5,
        max_dsw            = 0.1,
        start_step_size    = 10,
        max_nr_iter        = 10,
        centrifuge_rmid    = 13.5,  # cm
        flow_direction     = "imbibition",
        acceleration_schedule  = schedule,
        movie_schedule         = movie_schedule, # hour

    )
     
   sns_model = DisplacementModel1D2P(**model_parameters)
    
   results = sns_model.solve().results

   tss = results.tss_table

   sw_ref = np.interp( tss.TIME, reference.TIME.values, reference.Sw.values )

   delta_sw = tss.Sw_avg.values - sw_ref

   assert np.abs(delta_sw).mean() < SW_TOLERANCE
    

def test_imbibition5():

   SW_TOLERANCE = 0.01

   reference = pd.DataFrame(
     columns = ['TIME','Sw'],
     data = [
       [ -1.00000000E-07 ,  0.00000000E+00 ],
       [  4.96903995E-04 ,  2.40000000E-01 ],
       [  1.09318879E-03 ,  2.40000201E-01 ],
       [  1.80873054E-03 ,  2.40001459E-01 ],
       [  2.66738065E-03 ,  2.40005007E-01 ],
       [  3.69776077E-03 ,  2.40023674E-01 ],
       [  4.93421692E-03 ,  2.40049710E-01 ],
       [  6.41796430E-03 ,  2.40102156E-01 ],
       [  6.62208359E-03 ,  2.40112782E-01 ],
       [  6.86702673E-03 ,  2.40126385E-01 ],
       [  7.16095851E-03 ,  2.40143977E-01 ],
       [  7.51367664E-03 ,  2.40169485E-01 ],
       [  7.93693840E-03 ,  2.40202781E-01 ],
       [  8.44485251E-03 ,  2.40243529E-01 ],
       [  9.05434945E-03 ,  2.40299169E-01 ],
       [  9.78574577E-03 ,  2.40376445E-01 ],
       [  1.06634213E-02 ,  2.40485667E-01 ],
       [  1.17166320E-02 ,  2.40642780E-01 ],
       [  1.29804849E-02 ,  2.40872897E-01 ],
       [  1.44971083E-02 ,  2.41224269E-01 ],
       [  1.48610979E-02 ,  2.41332977E-01 ],
       [  1.52978855E-02 ,  2.41461984E-01 ],
       [  1.58220305E-02 ,  2.41627392E-01 ],
       [  1.64510046E-02 ,  2.41841459E-01 ],
       [  1.72057734E-02 ,  2.42121313E-01 ],
       [  1.81114961E-02 ,  2.42495599E-01 ],
       [  1.91983633E-02 ,  2.42994416E-01 ],
       [  2.05026039E-02 ,  2.43668180E-01 ],
       [  2.20676926E-02 ,  2.44581982E-01 ],
       [  2.39457991E-02 ,  2.45864686E-01 ],
       [  2.61995269E-02 ,  2.47681998E-01 ],
       [  2.89040002E-02 ,  2.50011770E-01 ],
       [  3.21493682E-02 ,  2.52784755E-01 ],
       [  3.60438098E-02 ,  2.56081186E-01 ],
       [  4.07171397E-02 ,  2.59989069E-01 ],
       [  4.63251356E-02 ,  2.64617719E-01 ],
       [  5.30547307E-02 ,  2.70090036E-01 ],
       [  6.11302448E-02 ,  2.76542390E-01 ],
       [  7.08208617E-02 ,  2.84135362E-01 ],
       [  7.31466097E-02 ,  2.85950941E-01 ],
       [  7.59375074E-02 ,  2.88120261E-01 ],
       [  7.92865846E-02 ,  2.90710875E-01 ],
       [  8.33054772E-02 ,  2.93794838E-01 ],
       [  8.81281484E-02 ,  2.97463852E-01 ],
       [  9.39153538E-02 ,  3.01821347E-01 ],
       [  1.00860000E-01 ,  3.06987037E-01 ],
       [  1.09193576E-01 ,  3.13090201E-01 ],
       [  1.19193867E-01 ,  3.20279503E-01 ],
       [  1.31194216E-01 ,  3.28718628E-01 ],
       [  1.45594635E-01 ,  3.38578540E-01 ],
       [  1.62875138E-01 ,  3.50035908E-01 ],
       [  1.83611741E-01 ,  3.63258612E-01 ],
       [  2.08495665E-01 ,  3.78379786E-01 ],
       [  2.38356374E-01 ,  3.95503929E-01 ],
       [  2.74189224E-01 ,  4.14628313E-01 ],
       [  3.17188645E-01 ,  4.35609496E-01 ],
       [  3.68787950E-01 ,  4.58116532E-01 ],
       [  4.30707115E-01 ,  4.81537873E-01 ],
       [  5.00000000E-01 ,  5.03746954E-01 ],
       [  5.83151461E-01 ,  5.25345337E-01 ],
       [  6.82933215E-01 ,  5.45429960E-01 ],
       [  8.02671320E-01 ,  5.63243078E-01 ],
       [  9.46357045E-01 ,  5.78262980E-01 ],
       [  9.57085636E-01 ,  5.79348349E-01 ],
       [  9.69959945E-01 ,  5.80601797E-01 ],
       [  9.85409116E-01 ,  5.82041180E-01 ],
       [  1.00000000E+00 ,  5.83346950E-01 ],
       [  1.01853901E+00 ,  5.84925126E-01 ],
       [  1.04078581E+00 ,  5.86710651E-01 ],
       [  1.06748198E+00 ,  5.88710120E-01 ],
       [  1.09951738E+00 ,  5.90923432E-01 ],
       [  1.10720588E+00 ,  5.91444183E-01 ],
       [  1.11643207E+00 ,  5.92054524E-01 ],
       [  1.12750351E+00 ,  5.92766805E-01 ],
       [  1.14078923E+00 ,  5.93593886E-01 ],
       [  1.15673209E+00 ,  5.94548581E-01 ],
       [  1.17586353E+00 ,  5.95642971E-01 ],
       [  1.19882126E+00 ,  5.96887472E-01 ],
       [  1.22637053E+00 ,  5.98289648E-01 ],
       [  1.25942966E+00 ,  5.99852920E-01 ],
       [  1.29910061E+00 ,  6.01575190E-01 ],
       [  1.34670575E+00 ,  6.03447487E-01 ],
       [  1.40383192E+00 ,  6.05453431E-01 ],
       [  1.47238333E+00 ,  6.07569209E-01 ],
       [  1.50000000E+00 ,  6.08377770E-01 ],
       [  1.58226169E+00 ,  6.10467014E-01 ],
       [  1.68097571E+00 ,  6.12609113E-01 ],
       [  1.79943254E+00 ,  6.14776381E-01 ],
       [  1.94158073E+00 ,  6.16948887E-01 ],
       [  2.00000000E+00 ,  6.17778899E-01 ],
       [  2.17057783E+00 ,  6.19818520E-01 ],
       [  2.37527123E+00 ,  6.21879842E-01 ],
       [  2.50000000E+00 ,  6.23020471E-01 ],
       [  2.74563208E+00 ,  6.24947576E-01 ],
       [  3.00000000E+00 ,  6.26688354E-01 ],
       [  3.30524151E+00 ,  6.28500226E-01 ],
       [  3.50000000E+00 ,  6.29560504E-01 ],
       [  3.86628981E+00 ,  6.31286165E-01 ],
       [  4.00000000E+00 ,  6.31883350E-01 ],
       [  4.43954777E+00 ,  6.33560411E-01 ],
       [  4.50000000E+00 ,  6.33785849E-01 ],
       [  5.00000000E+00 ,  6.35359770E-01 ],
     ]
   )

   rlptbl = pd.DataFrame(
     columns = ['Sat','kr1','kr2'],
     data = [
       [  0.00000000E+00 ,  0.00000000E+00 ,  1.00000000E+00 ],
       [  2.40000000E-01 ,  0.00000000E+00 ,  2.89500000E-01 ],
       [  2.40800000E-01 ,  1.00000000E-09 ,  2.88960000E-01 ],
       [  2.41500000E-01 ,  8.00000000E-09 ,  2.88430000E-01 ],
       [  2.43800000E-01 ,  1.25000000E-07 ,  2.86020000E-01 ],
       [  2.47600000E-01 ,  1.00000000E-06 ,  2.79900000E-01 ],
       [  2.55200000E-01 ,  8.00000000E-06 ,  2.63780000E-01 ],
       [  2.78000000E-01 ,  1.25000000E-04 ,  2.28540000E-01 ],
       [  3.16000000E-01 ,  1.00000000E-03 ,  1.86060000E-01 ],
       [  3.20000000E-01 ,  1.15330000E-03 ,  1.82010000E-01 ],
       [  3.31000000E-01 ,  1.72430000E-03 ,  1.71110000E-01 ],
       [  3.41000000E-01 ,  2.42000000E-03 ,  1.61690000E-01 ],
       [  3.63000000E-01 ,  4.46350000E-03 ,  1.42880000E-01 ],
       [  3.92000000E-01 ,  8.00000000E-03 ,  1.20810000E-01 ],
       [  4.10000000E-01 ,  1.10290000E-02 ,  1.08240000E-01 ],
       [  4.68000000E-01 ,  2.70000000E-02 ,  7.26500000E-02 ],
       [  4.78000000E-01 ,  3.05520000E-02 ,  6.70440000E-02 ],
       [  5.44000000E-01 ,  6.40000000E-02 ,  3.55120000E-02 ],
       [  5.62000000E-01 ,  7.58710000E-02 ,  2.84900000E-02 ],
       [  6.15000000E-01 ,  1.20240000E-01 ,  1.12220000E-02 ],
       [  6.20000000E-01 ,  1.25000000E-01 ,  9.85540000E-03 ],
       [  6.55000000E-01 ,  1.62780000E-01 ,  2.57890000E-03 ],
       [  6.98000000E-01 ,  2.02270000E-01 ,  1.57890000E-04 ],
       [  7.03000000E-01 ,  2.16000000E-01 ,  0.00000000E+00 ],
       [  7.10000000E-01 ,  2.36320000E-01 ,  0.00000000E+00 ],
       [  7.39000000E-01 ,  2.83110000E-01 ,  0.00000000E+00 ],
       [  7.58000000E-01 ,  3.16820000E-01 ,  0.00000000E+00 ],
       [  7.66000000E-01 ,  3.31650000E-01 ,  0.00000000E+00 ],
       [  7.72000000E-01 ,  3.43000000E-01 ,  0.00000000E+00 ],
       [  8.48000000E-01 ,  5.12000000E-01 ,  0.00000000E+00 ],
       [  9.24000000E-01 ,  7.29000000E-01 ,  0.00000000E+00 ],
       [  9.62000000E-01 ,  8.57370000E-01 ,  0.00000000E+00 ],
       [  9.84800000E-01 ,  9.41190000E-01 ,  0.00000000E+00 ],
       [  9.92400000E-01 ,  9.70300000E-01 ,  0.00000000E+00 ],
       [  9.96200000E-01 ,  9.85070000E-01 ,  0.00000000E+00 ],
       [  9.98500000E-01 ,  9.94010000E-01 ,  0.00000000E+00 ],
       [  9.99200000E-01 ,  9.97000000E-01 ,  0.00000000E+00 ],
       [  1.00000000E+00 ,  1.00000000E+00 ,  0.00000000E+00 ],
     ]
   )

   cprtbl = pd.DataFrame(
     columns = ['Sat','Pc'],
     data = [
       [  0.00000000E+00 , -0.00000000E+00 ],
       [  2.40000000E-01 , -0.00000000E+00 ],
       [  4.00000000E-01 , -3.80000000E-02 ],
       [  6.24000000E-01 , -1.14000000E-01 ],
       [  6.98000000E-01 , -2.28000000E-01 ],
       [  7.55000000E-01 , -4.56000000E-01 ],
       [  7.80000000E-01 , -6.10000000E-01 ],
       [  1.00000000E+00 , -1.00000000E+01 ],
     ]
   )

   schedule = pd.DataFrame(
     columns = ['StartTime','WellList','InjRate','Acceleration'],
     data = [
       [  0.00000000E+00 ,  7.68100000E+03 ,  0.00000000E+00 , -6.40000000E+03 ],
     ]
   )

   movie_schedule = np.array([
     4.96903995E-04 ,     1.09318879E-03 ,     1.80873054E-03 ,     2.66738065E-03 ,     3.69776077E-03 ,
     4.93421692E-03 ,     6.41796430E-03 ,     6.62208359E-03 ,     6.86702673E-03 ,     7.16095851E-03 ,
     7.51367664E-03 ,     7.93693840E-03 ,     8.44485251E-03 ,     9.05434945E-03 ,     9.78574577E-03 ,
     1.06634213E-02 ,     1.17166320E-02 ,     1.29804849E-02 ,     1.44971083E-02 ,     1.48610979E-02 ,
     1.52978855E-02 ,     1.58220305E-02 ,     1.64510046E-02 ,     1.72057734E-02 ,     1.81114961E-02 ,
     1.91983633E-02 ,     2.05026039E-02 ,     2.20676926E-02 ,     2.39457991E-02 ,     2.61995269E-02 ,
     2.89040002E-02 ,     3.21493682E-02 ,     3.60438098E-02 ,     4.07171397E-02 ,     4.63251356E-02 ,
     5.30547307E-02 ,     6.11302448E-02 ,     7.08208617E-02 ,     7.31466097E-02 ,     7.59375074E-02 ,
     7.92865846E-02 ,     8.33054772E-02 ,     8.81281484E-02 ,     9.39153538E-02 ,     1.00860000E-01 ,
     1.09193576E-01 ,     1.19193867E-01 ,     1.31194216E-01 ,     1.45594635E-01 ,     1.62875138E-01 ,
     1.83611741E-01 ,     2.08495665E-01 ,     2.38356374E-01 ,     2.74189224E-01 ,     3.17188645E-01 ,
     3.68787950E-01 ,     4.30707115E-01 ,     5.00000000E-01 ,     5.83151461E-01 ,     6.82933215E-01 ,
     8.02671320E-01 ,     9.46357045E-01 ,     9.57085636E-01 ,     9.69959945E-01 ,     9.85409116E-01 ,
     1.00000000E+00 ,     1.01853901E+00 ,     1.04078581E+00 ,     1.06748198E+00 ,     1.09951738E+00 ,
     1.10720588E+00 ,     1.11643207E+00 ,     1.12750351E+00 ,     1.14078923E+00 ,     1.15673209E+00 ,
     1.17586353E+00 ,     1.19882126E+00 ,     1.22637053E+00 ,     1.25942966E+00 ,     1.29910061E+00 ,
     1.34670575E+00 ,     1.40383192E+00 ,     1.47238333E+00 ,     1.50000000E+00 ,     1.58226169E+00 ,
     1.68097571E+00 ,     1.79943254E+00 ,     1.94158073E+00 ,     2.00000000E+00 ,     2.17057783E+00 ,
     2.37527123E+00 ,     2.50000000E+00 ,     2.74563208E+00 ,     3.00000000E+00 ,     3.30524151E+00 ,
     3.50000000E+00 ,     3.86628981E+00 ,     4.00000000E+00 ,     4.43954777E+00 ,     4.50000000E+00 ,
     5.00000000E+00 ,     5.50000000E+00 
   ])


   
   rlp_model = rlplib.Rlp2PCubic( rlptbl.Sat.values, 
                                  rlptbl.kr1.values, 
                                  rlptbl.kr2.values, 
                                  lex=0, rex=0 )    
                                  
   cpr_model = rlplib.CubicInterpolator( cprtbl.Sat.values, 
                                         cprtbl.Pc.values, 
                                         lex=0, rex=0 )
   
   model_parameters = dictn(    
        NX                 = 40, 
        core_length        = 5.0, # cm
        core_area          = 4.9, # cm2
        permeability       = 190.0, # mDarcy
        porosity           = 0.25, # v/v
        sw_initial         = 0.24, # v/v
        viscosity_w        = 1.0, # cP
        viscosity_n        = 20.0, # cP
        density_w          = 1000.0, # kg/m3
        density_n          = 810.0, # kg/m3
        rlp_model          = rlp_model,
        cpr_model          = cpr_model,
        time_end           = 5.0, # hour
        gravity_multiplier = 1.0, # 0: horizonal 1: vertical
        verbose            = 0,
        nr_tolerance       = 1e-5,
        max_dsw            = 0.1,
        start_step_size    = 10,
        max_nr_iter        = 10,
        centrifuge_rmid    = 13.5,  # cm
        flow_direction     = "imbibition",
        acceleration_schedule  = schedule,
        movie_schedule         = movie_schedule, # hour

    )
     
   sns_model = DisplacementModel1D2P(**model_parameters)
    
   results = sns_model.solve().results

   tss = results.tss_table

   sw_ref = np.interp( tss.TIME, reference.TIME.values, reference.Sw.values )

   delta_sw = tss.Sw_avg.values - sw_ref

   assert np.abs(delta_sw).mean() < SW_TOLERANCE
    

def test_imbibition6():

   SW_TOLERANCE = 0.01

   reference = pd.DataFrame(
     columns = ['TIME','Sw'],
     data = [
       [ -1.00000000E-07 ,  0.00000000E+00 ],
       [  2.77777778E-04 ,  7.50000000E-02 ],
       [  6.11111111E-04 ,  7.50002271E-02 ],
       [  7.02791104E-04 ,  7.50010521E-02 ],
       [  7.35016342E-04 ,  7.50013832E-02 ],
       [  7.73686627E-04 ,  7.50015260E-02 ],
       [  8.20090970E-04 ,  7.50016763E-02 ],
       [  8.75776181E-04 ,  7.50018622E-02 ],
       [  9.42598435E-04 ,  7.50021006E-02 ],
       [  1.02278514E-03 ,  7.50047755E-02 ],
       [  1.11900918E-03 ,  7.50051869E-02 ],
       [  1.23447804E-03 ,  7.50057323E-02 ],
       [  1.37304066E-03 ,  7.50064589E-02 ],
       [  1.53931581E-03 ,  7.50074333E-02 ],
       [  1.73884599E-03 ,  7.50087671E-02 ],
       [  1.97828221E-03 ,  7.50106722E-02 ],
       [  2.26560567E-03 ,  7.50126212E-02 ],
       [  2.61039382E-03 ,  7.50127402E-02 ],
       [  3.02413960E-03 ,  7.50127416E-02 ],
       [  3.52063454E-03 ,  7.50127416E-02 ],
       [  4.11642846E-03 ,  7.50127416E-02 ],
       [  4.83138117E-03 ,  7.50127416E-02 ],
       [  5.68932442E-03 ,  7.50127416E-02 ],
       [  6.71885632E-03 ,  7.50127416E-02 ],
       [  7.95429460E-03 ,  7.50127416E-02 ],
       [  9.43682054E-03 ,  7.50127416E-02 ],
       [  1.12158517E-02 ,  7.50127416E-02 ],
       [  1.33506890E-02 ,  7.50127416E-02 ],
       [  1.59124938E-02 ,  7.50127416E-02 ],
       [  1.89866596E-02 ,  7.50127416E-02 ],
       [  2.26756586E-02 ,  7.50127416E-02 ],
       [  2.71024573E-02 ,  7.50127416E-02 ],
       [  3.24146158E-02 ,  7.50127416E-02 ],
       [  3.87892059E-02 ,  7.50127416E-02 ],
       [  4.64387141E-02 ,  7.50127416E-02 ],
       [  5.56181240E-02 ,  7.50127416E-02 ],
       [  6.66334158E-02 ,  7.50127416E-02 ],
       [  7.98517660E-02 ,  7.50127416E-02 ],
       [  9.57137862E-02 ,  7.50127416E-02 ],
       [  1.14748210E-01 ,  7.50127416E-02 ],
       [  1.37589520E-01 ,  7.50127416E-02 ],
       [  1.64999090E-01 ,  7.50127416E-02 ],
       [  1.97890576E-01 ,  7.50127416E-02 ],
       [  2.37360358E-01 ,  7.50127416E-02 ],
       [  2.84724096E-01 ,  7.50127416E-02 ],
       [  3.41560583E-01 ,  7.50127416E-02 ],
       [  4.09764366E-01 ,  7.50127416E-02 ],
       [  4.91608906E-01 ,  7.50127416E-02 ],
       [  5.89822355E-01 ,  7.50127416E-02 ],
       [  7.07678493E-01 ,  7.50127416E-02 ],
       [  8.49105858E-01 ,  7.50127416E-02 ],
       [  1.01881870E+00 ,  7.50127416E-02 ],
       [  1.22247410E+00 ,  7.50127416E-02 ],
       [  1.46686059E+00 ,  7.50127416E-02 ],
       [  1.76012438E+00 ,  7.50127416E-02 ],
       [  2.11204092E+00 ,  7.50127416E-02 ],
       [  2.53434077E+00 ,  7.50127416E-02 ],
       [  3.04110059E+00 ,  7.50127416E-02 ],
       [  3.64921237E+00 ,  7.50127416E-02 ],
       [  4.37894652E+00 ,  7.50127416E-02 ],
       [  5.25462749E+00 ,  7.50127416E-02 ],
       [  6.30544465E+00 ,  7.50127416E-02 ],
       [  7.56642525E+00 ,  7.50127416E-02 ],
       [  9.07960196E+00 ,  7.50127416E-02 ],
       [  1.08954140E+01 ,  7.50127416E-02 ],
       [  1.30743885E+01 ,  7.50127416E-02 ],
       [  1.56891579E+01 ,  7.50127416E-02 ],
       [  1.88268811E+01 ,  7.50127416E-02 ],
       [  2.25921490E+01 ,  7.50127416E-02 ],
       [  2.71104705E+01 ,  7.50127416E-02 ],
       [  3.25324562E+01 ,  7.50127416E-02 ],
       [  3.80880118E+01 ,  7.50127416E-02 ],
       [  4.10000000E+01 ,  7.50127416E-02 ],
       [  4.65555556E+01 ,  7.50127416E-02 ],
       [  4.80000000E+01 ,  7.50127416E-02 ],
       [  4.80002778E+01 ,  7.50127416E-02 ],
       [  4.80005556E+01 ,  7.50131552E-02 ],
       [  4.80008333E+01 ,  7.50171757E-02 ],
       [  4.80011667E+01 ,  7.50185103E-02 ],
       [  4.80015667E+01 ,  7.50185541E-02 ],
       [  4.80020467E+01 ,  7.50185546E-02 ],
       [  4.80026227E+01 ,  7.50185546E-02 ],
       [  4.80033139E+01 ,  7.50185546E-02 ],
       [  4.80041433E+01 ,  7.50185546E-02 ],
       [  4.80051386E+01 ,  7.50185546E-02 ],
       [  4.80063330E+01 ,  7.50185546E-02 ],
       [  4.80077663E+01 ,  7.50185546E-02 ],
       [  4.80094862E+01 ,  7.50185546E-02 ],
       [  4.80115501E+01 ,  7.50185546E-02 ],
       [  4.80140268E+01 ,  7.50185546E-02 ],
       [  4.80169989E+01 ,  7.50185546E-02 ],
       [  4.80205653E+01 ,  7.50185546E-02 ],
       [  4.80248450E+01 ,  7.50185546E-02 ],
       [  4.80299807E+01 ,  7.50185546E-02 ],
       [  4.80361435E+01 ,  7.50185546E-02 ],
       [  4.80435389E+01 ,  7.50185546E-02 ],
       [  4.80524133E+01 ,  7.50185546E-02 ],
       [  4.80630627E+01 ,  7.50185546E-02 ],
       [  4.80758419E+01 ,  7.50185546E-02 ],
       [  4.80911769E+01 ,  7.50185546E-02 ],
       [  4.81095790E+01 ,  7.50185546E-02 ],
       [  4.81316614E+01 ,  7.50185546E-02 ],
       [  4.81581604E+01 ,  7.50185546E-02 ],
       [  4.81899591E+01 ,  7.50185546E-02 ],
       [  4.82281176E+01 ,  7.50185546E-02 ],
       [  4.82739078E+01 ,  7.50185546E-02 ],
       [  4.83288560E+01 ,  7.50185546E-02 ],
       [  4.83947939E+01 ,  7.50185546E-02 ],
       [  4.84739193E+01 ,  7.50185546E-02 ],
       [  4.85688698E+01 ,  7.50185546E-02 ],
       [  4.86828105E+01 ,  7.50185546E-02 ],
       [  4.88195392E+01 ,  7.50185546E-02 ],
       [  4.89836137E+01 ,  7.50185546E-02 ],
       [  4.91805031E+01 ,  7.50185546E-02 ],
       [  4.94167704E+01 ,  7.50185546E-02 ],
       [  4.97002912E+01 ,  7.50185546E-02 ],
       [  5.00405161E+01 ,  7.50185546E-02 ],
       [  5.04487859E+01 ,  7.50185546E-02 ],
       [  5.09387098E+01 ,  7.50185546E-02 ],
       [  5.15266184E+01 ,  7.50185546E-02 ],
       [  5.22321088E+01 ,  7.50185546E-02 ],
       [  5.30786972E+01 ,  7.50185546E-02 ],
       [  5.40946033E+01 ,  7.50185546E-02 ],
       [  5.53136906E+01 ,  7.50185546E-02 ],
       [  5.67765954E+01 ,  7.50185546E-02 ],
       [  5.85320812E+01 ,  7.50185546E-02 ],
       [  6.06386641E+01 ,  7.50185546E-02 ],
       [  6.31665636E+01 ,  7.50185546E-02 ],
       [  6.62000430E+01 ,  7.50185546E-02 ],
       [  6.98402182E+01 ,  7.50185546E-02 ],
       [  7.42084285E+01 ,  7.50185546E-02 ],
       [  7.94502809E+01 ,  7.50185546E-02 ],
       [  8.20000000E+01 ,  7.50185546E-02 ],
       [  8.75555556E+01 ,  7.50185546E-02 ],
       [  9.31111111E+01 ,  7.50185546E-02 ],
       [  9.86666667E+01 ,  7.50185546E-02 ],
       [  9.93300000E+01 ,  7.50185546E-02 ],
       [  9.93302778E+01 ,  7.50185546E-02 ],
       [  9.93305556E+01 ,  7.50220815E-02 ],
       [  9.93308333E+01 ,  7.50488684E-02 ],
       [  9.93311667E+01 ,  7.50665457E-02 ],
       [  9.93315667E+01 ,  7.50710669E-02 ],
       [  9.93320467E+01 ,  7.50720460E-02 ],
       [  9.93326227E+01 ,  7.50722714E-02 ],
       [  9.93333139E+01 ,  7.50723538E-02 ],
       [  9.93341433E+01 ,  7.50724204E-02 ],
       [  9.93351386E+01 ,  7.50724955E-02 ],
       [  9.93363330E+01 ,  7.50725850E-02 ],
       [  9.93377663E+01 ,  7.50726924E-02 ],
       [  9.93394862E+01 ,  7.50728211E-02 ],
       [  9.93415501E+01 ,  7.50729756E-02 ],
       [  9.93440268E+01 ,  7.50731608E-02 ],
       [  9.93469989E+01 ,  7.50733829E-02 ],
       [  9.93505653E+01 ,  7.50736492E-02 ],
       [  9.93548450E+01 ,  7.50739685E-02 ],
       [  9.93599807E+01 ,  7.50743512E-02 ],
       [  9.93661435E+01 ,  7.50748097E-02 ],
       [  9.93735389E+01 ,  7.50753589E-02 ],
       [  9.93824133E+01 ,  7.50760164E-02 ],
       [  9.93930627E+01 ,  7.50768030E-02 ],
       [  9.94058419E+01 ,  7.50777434E-02 ],
       [  9.94211769E+01 ,  7.50788665E-02 ],
       [  9.94395790E+01 ,  7.50802058E-02 ],
       [  9.94616614E+01 ,  7.50818000E-02 ],
       [  9.94881604E+01 ,  7.50836929E-02 ],
       [  9.95199591E+01 ,  7.50859332E-02 ],
       [  9.95581176E+01 ,  7.50885729E-02 ],
       [  9.96039078E+01 ,  7.50916651E-02 ],
       [  9.96588560E+01 ,  7.50952593E-02 ],
       [  9.97247939E+01 ,  7.50993945E-02 ],
       [  9.98039193E+01 ,  7.51040878E-02 ],
       [  9.98988698E+01 ,  7.51093201E-02 ],
       [  1.00012810E+02 ,  7.51150272E-02 ],
       [  1.00149539E+02 ,  7.51210962E-02 ],
       [  1.00313614E+02 ,  7.51273791E-02 ],
       [  1.00510503E+02 ,  7.51337328E-02 ],
       [  1.00746770E+02 ,  7.51400749E-02 ],
       [  1.01030291E+02 ,  7.51464307E-02 ],
       [  1.01370516E+02 ,  7.51529477E-02 ],
       [  1.01778786E+02 ,  7.51598701E-02 ],
       [  1.02268710E+02 ,  7.51674922E-02 ],
       [  1.02856618E+02 ,  7.51761103E-02 ],
       [  1.03562109E+02 ,  7.51859897E-02 ],
       [  1.04408697E+02 ,  7.51973226E-02 ],
       [  1.05424603E+02 ,  7.52101905E-02 ],
       [  1.06643691E+02 ,  7.52245270E-02 ],
       [  1.08106595E+02 ,  7.52400821E-02 ],
       [  1.09862081E+02 ,  7.52564537E-02 ],
       [  1.11968664E+02 ,  7.52732519E-02 ],
       [  1.14496564E+02 ,  7.52903653E-02 ],
       [  1.17530043E+02 ,  7.53081294E-02 ],
       [  1.21170218E+02 ,  7.53272588E-02 ],
       [  1.23000000E+02 ,  7.53364644E-02 ],
       [  1.27368210E+02 ,  7.53571728E-02 ],
       [  1.32610063E+02 ,  7.53807759E-02 ],
       [  1.38165618E+02 ,  7.54045428E-02 ],
       [  1.43721174E+02 ,  7.54270272E-02 ],
       [  1.47300000E+02 ,  7.54409359E-02 ],
       [  1.47300278E+02 ,  7.54409370E-02 ],
       [  1.47300333E+02 ,  7.54555994E-02 ],
       [  1.47300400E+02 ,  7.54670436E-02 ],
       [  1.47300480E+02 ,  7.54786322E-02 ],
       [  1.47300576E+02 ,  7.54914294E-02 ],
       [  1.47300691E+02 ,  7.55071165E-02 ],
       [  1.47300829E+02 ,  7.55235382E-02 ],
       [  1.47300995E+02 ,  7.55359187E-02 ],
       [  1.47301194E+02 ,  7.55465654E-02 ],
       [  1.47301433E+02 ,  7.55559436E-02 ],
       [  1.47301720E+02 ,  7.55645680E-02 ],
       [  1.47302064E+02 ,  7.55729599E-02 ],
       [  1.47302477E+02 ,  7.55815808E-02 ],
       [  1.47302972E+02 ,  7.55907875E-02 ],
       [  1.47303566E+02 ,  7.56007902E-02 ],
       [  1.47304280E+02 ,  7.56116659E-02 ],
       [  1.47305136E+02 ,  7.56233698E-02 ],
       [  1.47306163E+02 ,  7.56357628E-02 ],
       [  1.47307395E+02 ,  7.56486504E-02 ],
       [  1.47308874E+02 ,  7.56618353E-02 ],
       [  1.47310649E+02 ,  7.56751751E-02 ],
       [  1.47312779E+02 ,  7.56886301E-02 ],
       [  1.47315335E+02 ,  7.57023011E-02 ],
       [  1.47318402E+02 ,  7.57164663E-02 ],
       [  1.47322082E+02 ,  7.57315212E-02 ],
       [  1.47326499E+02 ,  7.57478949E-02 ],
       [  1.47331799E+02 ,  7.57660545E-02 ],
       [  1.47338158E+02 ,  7.57864320E-02 ],
       [  1.47345790E+02 ,  7.58093866E-02 ],
       [  1.47354948E+02 ,  7.58351751E-02 ],
       [  1.47365938E+02 ,  7.58639465E-02 ],
       [  1.47379125E+02 ,  7.58957819E-02 ],
       [  1.47394951E+02 ,  7.59308082E-02 ],
       [  1.47413941E+02 ,  7.59686104E-02 ],
       [  1.47436729E+02 ,  7.60090427E-02 ],
       [  1.47464075E+02 ,  7.60522565E-02 ],
       [  1.47496889E+02 ,  7.60987797E-02 ],
       [  1.47536267E+02 ,  7.61495042E-02 ],
       [  1.47583521E+02 ,  7.62055836E-02 ],
       [  1.47640225E+02 ,  7.62680518E-02 ],
       [  1.47708270E+02 ,  7.63375034E-02 ],
       [  1.47789924E+02 ,  7.64139540E-02 ],
       [  1.47887909E+02 ,  7.64969951E-02 ],
       [  1.48005490E+02 ,  7.65862892E-02 ],
       [  1.48146588E+02 ,  7.66822119E-02 ],
       [  1.48315906E+02 ,  7.67861863E-02 ],
       [  1.48519087E+02 ,  7.69003674E-02 ],
       [  1.48762905E+02 ,  7.70267514E-02 ],
       [  1.49055486E+02 ,  7.71661064E-02 ],
       [  1.49406583E+02 ,  7.73168516E-02 ],
       [  1.49827899E+02 ,  7.74753664E-02 ],
       [  1.50333479E+02 ,  7.76405265E-02 ],
       [  1.50940175E+02 ,  7.78147751E-02 ],
       [  1.51668210E+02 ,  7.80011673E-02 ],
       [  1.52541852E+02 ,  7.81994279E-02 ],
       [  1.53590223E+02 ,  7.84059714E-02 ],
       [  1.54848267E+02 ,  7.86198744E-02 ],
       [  1.56357921E+02 ,  7.88441826E-02 ],
       [  1.58169505E+02 ,  7.90794275E-02 ],
       [  1.60343406E+02 ,  7.93214673E-02 ],
       [  1.62952087E+02 ,  7.95704537E-02 ],
       [  1.64000000E+02 ,  7.96647009E-02 ],
       [  1.67130417E+02 ,  7.99108545E-02 ],
       [  1.70886918E+02 ,  8.01646770E-02 ],
       [  1.75394720E+02 ,  8.04277290E-02 ],
       [  1.80804081E+02 ,  8.06983006E-02 ],
       [  1.86359637E+02 ,  8.09389830E-02 ],
       [  1.91915192E+02 ,  8.11516295E-02 ],
       [  1.93200000E+02 ,  8.11994005E-02 ],
       [  1.93200278E+02 ,  8.11994109E-02 ],
       [  1.93200556E+02 ,  8.12674207E-02 ],
       [  1.93200833E+02 ,  8.14035043E-02 ],
       [  1.93201111E+02 ,  8.16167836E-02 ],
       [  1.93201389E+02 ,  8.19159497E-02 ],
       [  1.93201722E+02 ,  8.23313786E-02 ],
       [  1.93202122E+02 ,  8.28045462E-02 ],
       [  1.93202602E+02 ,  8.33532320E-02 ],
       [  1.93203178E+02 ,  8.39901234E-02 ],
       [  1.93203869E+02 ,  8.47304601E-02 ],
       [  1.93204699E+02 ,  8.55940221E-02 ],
       [  1.93205694E+02 ,  8.66012774E-02 ],
       [  1.93206889E+02 ,  8.77737962E-02 ],
       [  1.93208322E+02 ,  8.91328500E-02 ],
       [  1.93210042E+02 ,  9.07093315E-02 ],
       [  1.93212106E+02 ,  9.25344632E-02 ],
       [  1.93214582E+02 ,  9.46386235E-02 ],
       [  1.93217554E+02 ,  9.70491921E-02 ],
       [  1.93221121E+02 ,  9.98040895E-02 ],
       [  1.93225401E+02 ,  1.02935023E-01 ],
       [  1.93230536E+02 ,  1.06468361E-01 ],
       [  1.93236699E+02 ,  1.10438054E-01 ],
       [  1.93244094E+02 ,  1.14855217E-01 ],
       [  1.93252969E+02 ,  1.19748681E-01 ],
       [  1.93263618E+02 ,  1.25103643E-01 ],
       [  1.93276397E+02 ,  1.30929280E-01 ],
       [  1.93291732E+02 ,  1.37189088E-01 ],
       [  1.93310135E+02 ,  1.43821228E-01 ],
       [  1.93332217E+02 ,  1.50763399E-01 ],
       [  1.93358716E+02 ,  1.57881834E-01 ],
       [  1.93390515E+02 ,  1.65060966E-01 ],
       [  1.93428673E+02 ,  1.72121444E-01 ],
       [  1.93474463E+02 ,  1.78907602E-01 ],
       [  1.93529412E+02 ,  1.85270563E-01 ],
       [  1.93595349E+02 ,  1.91027228E-01 ],
       [  1.93674475E+02 ,  1.96115504E-01 ],
       [  1.93769425E+02 ,  2.00437647E-01 ],
       [  1.93883366E+02 ,  2.04021548E-01 ],
       [  1.94020095E+02 ,  2.06891975E-01 ],
       [  1.94184169E+02 ,  2.09151621E-01 ],
       [  1.94381059E+02 ,  2.10900731E-01 ],
       [  1.94617326E+02 ,  2.12224726E-01 ],
       [  1.94900847E+02 ,  2.13235469E-01 ],
       [  1.95241072E+02 ,  2.14031572E-01 ],
       [  1.95649342E+02 ,  2.14675187E-01 ],
       [  1.96139265E+02 ,  2.15203420E-01 ],
       [  1.96727174E+02 ,  2.15642893E-01 ],
       [  1.97432664E+02 ,  2.16018038E-01 ],
       [  1.98279253E+02 ,  2.16353693E-01 ],
       [  1.99295159E+02 ,  2.16663987E-01 ],
       [  2.00514246E+02 ,  2.16955391E-01 ],
       [  2.01977151E+02 ,  2.17229699E-01 ],
       [  2.03732637E+02 ,  2.17491555E-01 ],
       [  2.05000000E+02 ,  2.17653568E-01 ],
       [  2.07106583E+02 ,  2.17870184E-01 ],
       [  2.09634482E+02 ,  2.18080870E-01 ],
       [  2.12667962E+02 ,  2.18290688E-01 ],
       [  2.16308137E+02 ,  2.18498867E-01 ],
       [  2.20676347E+02 ,  2.18700471E-01 ],
       [  2.25918200E+02 ,  2.18897642E-01 ],
       [  2.31473755E+02 ,  2.19073779E-01 ],
       [  2.37029311E+02 ,  2.19223324E-01 ],
       [  2.40100000E+02 ,  2.19298206E-01 ],
       [  2.40100278E+02 ,  2.19298212E-01 ],
       [  2.40100556E+02 ,  2.19361629E-01 ],
       [  2.40100833E+02 ,  2.19486183E-01 ],
       [  2.40101111E+02 ,  2.19674746E-01 ],
       [  2.40101389E+02 ,  2.19930161E-01 ],
       [  2.40101722E+02 ,  2.20281291E-01 ],
       [  2.40102122E+02 ,  2.20696249E-01 ],
       [  2.40102602E+02 ,  2.21191796E-01 ],
       [  2.40103178E+02 ,  2.21783077E-01 ],
       [  2.40103869E+02 ,  2.22487841E-01 ],
       [  2.40104699E+02 ,  2.23326816E-01 ],
       [  2.40105694E+02 ,  2.24324084E-01 ],
       [  2.40106889E+02 ,  2.25507469E-01 ],
       [  2.40108322E+02 ,  2.26908846E-01 ],
       [  2.40110042E+02 ,  2.28564340E-01 ],
       [  2.40112106E+02 ,  2.30514450E-01 ],
       [  2.40114582E+02 ,  2.32804276E-01 ],
       [  2.40117554E+02 ,  2.35483403E-01 ],
       [  2.40121121E+02 ,  2.38603514E-01 ],
       [  2.40125401E+02 ,  2.42216714E-01 ],
       [  2.40130536E+02 ,  2.46380230E-01 ],
       [  2.40136699E+02 ,  2.51145012E-01 ],
       [  2.40144094E+02 ,  2.56546041E-01 ],
       [  2.40152969E+02 ,  2.62624149E-01 ],
       [  2.40163618E+02 ,  2.69371028E-01 ],
       [  2.40176397E+02 ,  2.76786520E-01 ],
       [  2.40191732E+02 ,  2.84790421E-01 ],
       [  2.40210135E+02 ,  2.93306350E-01 ],
       [  2.40232217E+02 ,  3.02178999E-01 ],
       [  2.40258716E+02 ,  3.11220827E-01 ],
       [  2.40290515E+02 ,  3.20255359E-01 ],
       [  2.40328673E+02 ,  3.29003898E-01 ],
       [  2.40374463E+02 ,  3.37313579E-01 ],
       [  2.40429412E+02 ,  3.44928598E-01 ],
       [  2.40495349E+02 ,  3.51766996E-01 ],
       [  2.40574475E+02 ,  3.57694764E-01 ],
       [  2.40669425E+02 ,  3.62651384E-01 ],
       [  2.40783366E+02 ,  3.66729601E-01 ],
       [  2.40920095E+02 ,  3.69980113E-01 ],
       [  2.41084169E+02 ,  3.72467001E-01 ],
       [  2.41281059E+02 ,  3.74320121E-01 ],
       [  2.41517326E+02 ,  3.75687409E-01 ],
       [  2.41800847E+02 ,  3.76680661E-01 ],
       [  2.42141072E+02 ,  3.77386830E-01 ],
       [  2.42549342E+02 ,  3.77884571E-01 ],
       [  2.43039265E+02 ,  3.78241378E-01 ],
       [  2.43627174E+02 ,  3.78506553E-01 ],
       [  2.44332664E+02 ,  3.78714333E-01 ],
       [  2.45179253E+02 ,  3.78890068E-01 ],
       [  2.46000000E+02 ,  3.79025073E-01 ],
       [  2.47015906E+02 ,  3.79163182E-01 ],
       [  2.48234993E+02 ,  3.79300372E-01 ],
       [  2.49697898E+02 ,  3.79432615E-01 ],
       [  2.51453384E+02 ,  3.79558401E-01 ],
       [  2.53559967E+02 ,  3.79681377E-01 ],
       [  2.56087866E+02 ,  3.79805863E-01 ],
       [  2.59121346E+02 ,  3.79931511E-01 ],
       [  2.62761521E+02 ,  3.80052389E-01 ],
       [  2.67129731E+02 ,  3.80163008E-01 ],
       [  2.72371584E+02 ,  3.80265353E-01 ],
       [  2.77927139E+02 ,  3.80354838E-01 ],
       [  2.83482695E+02 ,  3.80432001E-01 ],
       [  2.87000000E+02 ,  3.80476524E-01 ],
       [  2.88100000E+02 ,  3.80490035E-01 ],
       [  2.88100278E+02 ,  3.80490038E-01 ],
       [  2.88100611E+02 ,  3.80559003E-01 ],
       [  2.88101011E+02 ,  3.80736984E-01 ],
       [  2.88101491E+02 ,  3.81093003E-01 ],
       [  2.88102001E+02 ,  3.81664445E-01 ],
       [  2.88102512E+02 ,  3.82451468E-01 ],
       [  2.88103022E+02 ,  3.83463563E-01 ],
       [  2.88103634E+02 ,  3.84669190E-01 ],
       [  2.88104369E+02 ,  3.86095083E-01 ],
       [  2.88105251E+02 ,  3.87779346E-01 ],
       [  2.88106309E+02 ,  3.89763519E-01 ],
       [  2.88107579E+02 ,  3.92093597E-01 ],
       [  2.88109103E+02 ,  3.94819689E-01 ],
       [  2.88110931E+02 ,  3.97997290E-01 ],
       [  2.88113125E+02 ,  4.01688372E-01 ],
       [  2.88115758E+02 ,  4.05942455E-01 ],
       [  2.88118918E+02 ,  4.10812963E-01 ],
       [  2.88122710E+02 ,  4.16361935E-01 ],
       [  2.88127260E+02 ,  4.22598769E-01 ],
       [  2.88132720E+02 ,  4.29560215E-01 ],
       [  2.88139271E+02 ,  4.37204474E-01 ],
       [  2.88147134E+02 ,  4.45517720E-01 ],
       [  2.88156568E+02 ,  4.54368929E-01 ],
       [  2.88167890E+02 ,  4.63674244E-01 ],
       [  2.88181476E+02 ,  4.73260749E-01 ],
       [  2.88197779E+02 ,  4.82926017E-01 ],
       [  2.88217343E+02 ,  4.92505821E-01 ],
       [  2.88240819E+02 ,  5.01721293E-01 ],
       [  2.88268991E+02 ,  5.10426491E-01 ],
       [  2.88302797E+02 ,  5.18478282E-01 ],
       [  2.88343365E+02 ,  5.25761042E-01 ],
       [  2.88392046E+02 ,  5.32320676E-01 ],
       [  2.88450463E+02 ,  5.38209635E-01 ],
       [  2.88520563E+02 ,  5.43509454E-01 ],
       [  2.88604684E+02 ,  5.48353853E-01 ],
       [  2.88705629E+02 ,  5.52842664E-01 ],
       [  2.88826763E+02 ,  5.57032189E-01 ],
       [  2.88972123E+02 ,  5.60946665E-01 ],
       [  2.89146556E+02 ,  5.64599851E-01 ],
       [  2.89355875E+02 ,  5.67999102E-01 ],
       [  2.89607058E+02 ,  5.71143020E-01 ],
       [  2.89908477E+02 ,  5.74020666E-01 ],
       [  2.90270181E+02 ,  5.76616301E-01 ],
       [  2.90704225E+02 ,  5.78916371E-01 ],
       [  2.91225078E+02 ,  5.80912501E-01 ],
       [  2.91850101E+02 ,  5.82602950E-01 ],
       [  2.92600130E+02 ,  5.83993247E-01 ],
       [  2.93500163E+02 ,  5.85096968E-01 ],
       [  2.94580204E+02 ,  5.85937163E-01 ],
       [  2.95876253E+02 ,  5.86546803E-01 ],
       [  2.97431511E+02 ,  5.86967421E-01 ],
       [  2.99297822E+02 ,  5.87244376E-01 ],
       [  3.01537394E+02 ,  5.87421002E-01 ],
       [  3.04224881E+02 ,  5.87533191E-01 ],
       [  3.07449865E+02 ,  5.87606409E-01 ],
       [  3.11319846E+02 ,  5.87656064E-01 ],
       [  3.12100000E+02 ,  5.87664818E-01 ],
       [  3.12100278E+02 ,  5.87664821E-01 ],
       [  3.12100611E+02 ,  5.87733592E-01 ],
       [  3.12101011E+02 ,  5.87907503E-01 ],
       [  3.12101491E+02 ,  5.88250200E-01 ],
       [  3.12102067E+02 ,  5.88859896E-01 ],
       [  3.12102758E+02 ,  5.89881991E-01 ],
       [  3.12103524E+02 ,  5.91411162E-01 ],
       [  3.12104289E+02 ,  5.93391054E-01 ],
       [  3.12105208E+02 ,  5.95894385E-01 ],
       [  3.12106310E+02 ,  5.98750417E-01 ],
       [  3.12107633E+02 ,  6.02011901E-01 ],
       [  3.12109220E+02 ,  6.05720188E-01 ],
       [  3.12111125E+02 ,  6.09854319E-01 ],
       [  3.12113410E+02 ,  6.14417011E-01 ],
       [  3.12116153E+02 ,  6.19437461E-01 ],
       [  3.12119444E+02 ,  6.24827340E-01 ],
       [  3.12123394E+02 ,  6.30504990E-01 ],
       [  3.12128133E+02 ,  6.36477547E-01 ],
       [  3.12133820E+02 ,  6.42513054E-01 ],
       [  3.12140645E+02 ,  6.48492330E-01 ],
       [  3.12148835E+02 ,  6.54425783E-01 ],
       [  3.12158663E+02 ,  6.60091087E-01 ],
       [  3.12170456E+02 ,  6.65228829E-01 ],
       [  3.12184608E+02 ,  6.69902516E-01 ],
       [  3.12201590E+02 ,  6.74161480E-01 ],
       [  3.12221969E+02 ,  6.78076379E-01 ],
       [  3.12246423E+02 ,  6.81666382E-01 ],
       [  3.12275769E+02 ,  6.84941144E-01 ],
       [  3.12310983E+02 ,  6.87949842E-01 ],
       [  3.12353240E+02 ,  6.90768646E-01 ],
       [  3.12403949E+02 ,  6.93470284E-01 ],
       [  3.12464800E+02 ,  6.96108715E-01 ],
       [  3.12537821E+02 ,  6.98716681E-01 ],
       [  3.12625445E+02 ,  7.01307961E-01 ],
       [  3.12730595E+02 ,  7.03882283E-01 ],
       [  3.12856775E+02 ,  7.06430861E-01 ],
       [  3.13008190E+02 ,  7.08943727E-01 ],
       [  3.13189889E+02 ,  7.11411744E-01 ],
       [  3.13407928E+02 ,  7.13828218E-01 ],
       [  3.13669574E+02 ,  7.16189175E-01 ],
       [  3.13983549E+02 ,  7.18491426E-01 ],
       [  3.14360320E+02 ,  7.20729364E-01 ],
       [  3.14812445E+02 ,  7.22891543E-01 ],
       [  3.15354994E+02 ,  7.24959071E-01 ],
       [  3.16006054E+02 ,  7.26907466E-01 ],
       [  3.16787325E+02 ,  7.28711305E-01 ],
       [  3.17724851E+02 ,  7.30348177E-01 ],
       [  3.18849882E+02 ,  7.31801658E-01 ],
       [  3.20199919E+02 ,  7.33059955E-01 ],
       [  3.21819964E+02 ,  7.34117605E-01 ],
       [  3.23764017E+02 ,  7.34973930E-01 ],
       [  3.26096881E+02 ,  7.35634845E-01 ],
       [  3.28000000E+02 ,  7.36008488E-01 ],
       [  3.30799437E+02 ,  7.36342617E-01 ],
       [  3.30900000E+02 ,  7.36354348E-01 ],
       [  3.30900278E+02 ,  7.36354380E-01 ],
       [  3.30900611E+02 ,  7.36417751E-01 ],
       [  3.30901011E+02 ,  7.36584689E-01 ],
       [  3.30901491E+02 ,  7.36907603E-01 ],
       [  3.30902067E+02 ,  7.37469654E-01 ],
       [  3.30902758E+02 ,  7.38386909E-01 ],
       [  3.30903588E+02 ,  7.39810106E-01 ],
       [  3.30904583E+02 ,  7.41955475E-01 ],
       [  3.30905777E+02 ,  7.45089632E-01 ],
       [  3.30907053E+02 ,  7.49130708E-01 ],
       [  3.30908584E+02 ,  7.53962067E-01 ],
       [  3.30910421E+02 ,  7.58792844E-01 ],
       [  3.30912626E+02 ,  7.63453078E-01 ],
       [  3.30915271E+02 ,  7.67995594E-01 ],
       [  3.30918321E+02 ,  7.72248297E-01 ],
       [  3.30921982E+02 ,  7.76242973E-01 ],
       [  3.30926375E+02 ,  7.79866374E-01 ],
       [  3.30931646E+02 ,  7.83033039E-01 ],
       [  3.30937972E+02 ,  7.85749502E-01 ],
       [  3.30945563E+02 ,  7.88098912E-01 ],
       [  3.30954671E+02 ,  7.90194791E-01 ],
       [  3.30965602E+02 ,  7.92109540E-01 ],
       [  3.30978719E+02 ,  7.93889092E-01 ],
       [  3.30994459E+02 ,  7.95579142E-01 ],
       [  3.31013347E+02 ,  7.97214049E-01 ],
       [  3.31036013E+02 ,  7.98815540E-01 ],
       [  3.31063212E+02 ,  8.00392646E-01 ],
       [  3.31095850E+02 ,  8.01945073E-01 ],
       [  3.31135017E+02 ,  8.03473751E-01 ],
       [  3.31182016E+02 ,  8.04973950E-01 ],
       [  3.31238416E+02 ,  8.06448019E-01 ],
       [  3.31306095E+02 ,  8.07897308E-01 ],
       [  3.31387311E+02 ,  8.09329164E-01 ],
       [  3.31484769E+02 ,  8.10753787E-01 ],
       [  3.31601719E+02 ,  8.12182944E-01 ],
       [  3.31742060E+02 ,  8.13627817E-01 ],
       [  3.31910468E+02 ,  8.15097327E-01 ],
       [  3.32112558E+02 ,  8.16598048E-01 ],
       [  3.32355066E+02 ,  8.18134181E-01 ],
       [  3.32646075E+02 ,  8.19709085E-01 ],
       [  3.32995287E+02 ,  8.21324089E-01 ],
       [  3.33414340E+02 ,  8.22975218E-01 ],
       [  3.33917205E+02 ,  8.24653327E-01 ],
       [  3.34520642E+02 ,  8.26342998E-01 ],
       [  3.35244767E+02 ,  8.28021493E-01 ],
       [  3.36113716E+02 ,  8.29659848E-01 ],
       [  3.37156456E+02 ,  8.31224582E-01 ],
       [  3.38407744E+02 ,  8.32681248E-01 ],
       [  3.39909289E+02 ,  8.33997565E-01 ],
       [  3.41711143E+02 ,  8.35147085E-01 ],
       [  3.43873368E+02 ,  8.36110257E-01 ],
       [  3.46468038E+02 ,  8.36877635E-01 ],
       [  3.49581642E+02 ,  8.37452475E-01 ],
       [  3.53317966E+02 ,  8.37853559E-01 ],
       [  3.57801556E+02 ,  8.38111916E-01 ],
       [  3.63181863E+02 ,  8.38264129E-01 ],
       [  3.68737419E+02 ,  8.38339988E-01 ],
       [  3.69000000E+02 ,  8.38343401E-01 ],
       [  3.74555556E+02 ,  8.38378260E-01 ],
       [  3.78900000E+02 ,  8.38393100E-01 ],
       [  3.78900278E+02 ,  8.38393101E-01 ],
       [  3.78900611E+02 ,  8.38452298E-01 ],
       [  3.78901011E+02 ,  8.38588098E-01 ],
       [  3.78901491E+02 ,  8.38837919E-01 ],
       [  3.78902067E+02 ,  8.39257303E-01 ],
       [  3.78902758E+02 ,  8.39921814E-01 ],
       [  3.78903588E+02 ,  8.40940619E-01 ],
       [  3.78904583E+02 ,  8.42438054E-01 ],
       [  3.78905777E+02 ,  8.44500829E-01 ],
       [  3.78907211E+02 ,  8.47327822E-01 ],
       [  3.78908931E+02 ,  8.50761611E-01 ],
       [  3.78910995E+02 ,  8.54292312E-01 ],
       [  3.78913471E+02 ,  8.57015028E-01 ],
       [  3.78915620E+02 ,  8.58778459E-01 ],
       [  3.78918200E+02 ,  8.60362625E-01 ],
       [  3.78921294E+02 ,  8.61752151E-01 ],
       [  3.78925008E+02 ,  8.62937508E-01 ],
       [  3.78929465E+02 ,  8.63972487E-01 ],
       [  3.78934813E+02 ,  8.64908590E-01 ],
       [  3.78941230E+02 ,  8.65777901E-01 ],
       [  3.78948931E+02 ,  8.66599986E-01 ],
       [  3.78958172E+02 ,  8.67387540E-01 ],
       [  3.78969262E+02 ,  8.68147256E-01 ],
       [  3.78982569E+02 ,  8.68884230E-01 ],
       [  3.78998538E+02 ,  8.69601300E-01 ],
       [  3.79017700E+02 ,  8.70301158E-01 ],
       [  3.79040695E+02 ,  8.70990748E-01 ],
       [  3.79068290E+02 ,  8.71675151E-01 ],
       [  3.79101402E+02 ,  8.72360722E-01 ],
       [  3.79141138E+02 ,  8.73052586E-01 ],
       [  3.79188820E+02 ,  8.73754776E-01 ],
       [  3.79246039E+02 ,  8.74471424E-01 ],
       [  3.79314702E+02 ,  8.75206532E-01 ],
       [  3.79397098E+02 ,  8.75962823E-01 ],
       [  3.79495972E+02 ,  8.76743274E-01 ],
       [  3.79614621E+02 ,  8.77551574E-01 ],
       [  3.79757001E+02 ,  8.78391078E-01 ],
       [  3.79927856E+02 ,  8.79263706E-01 ],
       [  3.80132882E+02 ,  8.80169287E-01 ],
       [  3.80378913E+02 ,  8.81104844E-01 ],
       [  3.80674151E+02 ,  8.82064087E-01 ],
       [  3.81028436E+02 ,  8.83037210E-01 ],
       [  3.81453578E+02 ,  8.84010177E-01 ],
       [  3.81963748E+02 ,  8.84963913E-01 ],
       [  3.82575953E+02 ,  8.85874904E-01 ],
       [  3.83310599E+02 ,  8.86713924E-01 ],
       [  3.84192173E+02 ,  8.87452748E-01 ],
       [  3.85250063E+02 ,  8.88068514E-01 ],
       [  3.86519530E+02 ,  8.88548685E-01 ],
       [  3.88042891E+02 ,  8.88894324E-01 ],
       [  3.89870925E+02 ,  8.89122035E-01 ],
       [  3.92064564E+02 ,  8.89258966E-01 ],
       [  3.94696932E+02 ,  8.89333775E-01 ],
       [  3.95328700E+02 ,  8.89347726E-01 ],
       [  3.96086822E+02 ,  8.89360183E-01 ],
       [  3.96996569E+02 ,  8.89370785E-01 ],
       [  3.98088264E+02 ,  8.89379358E-01 ],
       [  3.99398299E+02 ,  8.89385949E-01 ],
       [  4.00970341E+02 ,  8.89390797E-01 ],
       [  4.02856791E+02 ,  8.89394261E-01 ],
       [  4.05120531E+02 ,  8.89396723E-01 ],
       [  4.07837019E+02 ,  8.89398516E-01 ],
       [  4.10000000E+02 ,  8.89399531E-01 ],
     ]
   )

   rlptbl = pd.DataFrame(
     columns = ['Sat','kr1','kr2'],
     data = [
       [  7.31000000E-02 ,  0.00000000E+00 ,  5.00499750E-01 ],
       [  7.39619000E-02 ,  8.00000000E-13 ,  4.98502248E-01 ],
       [  7.48238000E-02 ,  1.28000000E-11 ,  4.96510735E-01 ],
       [  7.74095000E-02 ,  5.00000000E-10 ,  4.90572002E-01 ],
       [  8.17190000E-02 ,  8.00000000E-09 ,  4.80792758E-01 ],
       [  9.03380000E-02 ,  1.28000000E-07 ,  4.61673835E-01 ],
       [  1.16195000E-01 ,  5.00000000E-06 ,  4.07727888E-01 ],
       [  1.59290000E-01 ,  8.00000000E-05 ,  3.28499775E-01 ],
       [  2.45480000E-01 ,  1.28000000E-03 ,  2.05199800E-01 ],
       [  3.31670000E-01 ,  6.48000000E-03 ,  1.20399825E-01 ],
       [  4.17860000E-01 ,  2.04800000E-02 ,  6.50998501E-02 ],
       [  5.04050000E-01 ,  5.00000000E-02 ,  3.14998751E-02 ],
       [  5.90240000E-01 ,  1.03680000E-01 ,  1.29999000E-02 ],
       [  6.76430000E-01 ,  1.92080000E-01 ,  4.19992504E-03 ],
       [  7.62620000E-01 ,  3.27680000E-01 ,  8.99950025E-04 ],
       [  8.48810000E-01 ,  5.24880000E-01 ,  9.99750125E-05 ],
       [  8.91905000E-01 ,  6.51605000E-01 ,  2.81125062E-05 ],
       [  9.17762000E-01 ,  7.37894528E-01 ,  1.00750025E-05 ],
       [  9.26381000E-01 ,  7.68476808E-01 ,  5.00250125E-06 ],
       [  9.30690500E-01 ,  7.84119600E-01 ,  2.49906312E-06 ],
       [  9.33276200E-01 ,  7.93619174E-01 ,  9.99508250E-07 ],
       [  9.34138100E-01 ,  7.96804797E-01 ,  4.99750625E-07 ],
       [  9.35000000E-01 ,  8.00000000E-01 ,  0.00000000E+00 ],
     ]
   )

   cprtbl = pd.DataFrame(
     columns = ['Sat','Pc'],
     data = [
       [  7.31000000E-02 , -3.05590000E-01 ],
       [  1.26000000E-01 , -5.05590000E-01 ],
       [  2.53000000E-01 , -6.05590000E-01 ],
       [  5.82000000E-01 , -8.21440000E-01 ],
       [  6.62000000E-01 , -1.00640000E+00 ],
       [  7.28000000E-01 , -1.25310000E+00 ],
       [  8.50600000E-01 , -2.35020000E+00 ],
       [  9.03000000E-01 , -5.00330000E+00 ],
       [  9.15000000E-01 , -6.79180000E+00 ],
       [  9.25000000E-01 , -8.59480000E+00 ],
       [  9.31000000E-01 , -1.06810000E+01 ],
       [  9.35000000E-01 , -1.38110000E+01 ],
     ]
   )

   schedule = pd.DataFrame(
     columns = ['StartTime','WellList','InjRate','Acceleration'],
     data = [
       [  0.00000000E+00 ,  7.68100000E+03 ,  0.00000000E+00 , -8.43700000E+02 ],
       [  4.80000000E+01 ,  7.68100000E+03 ,  0.00000000E+00 , -1.49990000E+03 ],
       [  9.93300000E+01 ,  7.68100000E+03 ,  0.00000000E+00 , -2.34360000E+03 ],
       [  1.47300000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -3.37480000E+03 ],
       [  1.93200000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -5.99960000E+03 ],
       [  2.40100000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -9.37440000E+03 ],
       [  2.88100000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -1.83738000E+04 ],
       [  3.12100000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -3.74976000E+04 ],
       [  3.30900000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -8.43697000E+04 ],
       [  3.78900000E+02 ,  7.68100000E+03 ,  0.00000000E+00 , -1.81488600E+05 ],
     ]
   )

   movie_schedule = np.array([
     2.77777778E-04 ,     6.11111111E-04 ,     7.02791104E-04 ,     7.35016342E-04 ,     7.73686627E-04 ,
     8.20090970E-04 ,     8.75776181E-04 ,     9.42598435E-04 ,     1.02278514E-03 ,     1.11900918E-03 ,
     1.23447804E-03 ,     1.37304066E-03 ,     1.53931581E-03 ,     1.73884599E-03 ,     1.97828221E-03 ,
     2.26560567E-03 ,     2.61039382E-03 ,     3.02413960E-03 ,     3.52063454E-03 ,     4.11642846E-03 ,
     4.83138117E-03 ,     5.68932442E-03 ,     6.71885632E-03 ,     7.95429460E-03 ,     9.43682054E-03 ,
     1.12158517E-02 ,     1.33506890E-02 ,     1.59124938E-02 ,     1.89866596E-02 ,     2.26756586E-02 ,
     2.71024573E-02 ,     3.24146158E-02 ,     3.87892059E-02 ,     4.64387141E-02 ,     5.56181240E-02 ,
     6.66334158E-02 ,     7.98517660E-02 ,     9.57137862E-02 ,     1.14748210E-01 ,     1.37589520E-01 ,
     1.64999090E-01 ,     1.97890576E-01 ,     2.37360358E-01 ,     2.84724096E-01 ,     3.41560583E-01 ,
     4.09764366E-01 ,     4.91608906E-01 ,     5.89822355E-01 ,     7.07678493E-01 ,     8.49105858E-01 ,
     1.01881870E+00 ,     1.22247410E+00 ,     1.46686059E+00 ,     1.76012438E+00 ,     2.11204092E+00 ,
     2.53434077E+00 ,     3.04110059E+00 ,     3.64921237E+00 ,     4.37894652E+00 ,     5.25462749E+00 ,
     6.30544465E+00 ,     7.56642525E+00 ,     9.07960196E+00 ,     1.08954140E+01 ,     1.30743885E+01 ,
     1.56891579E+01 ,     1.88268811E+01 ,     2.25921490E+01 ,     2.71104705E+01 ,     3.25324562E+01 ,
     3.80880118E+01 ,     4.10000000E+01 ,     4.65555556E+01 ,     4.80000000E+01 ,     4.80002778E+01 ,
     4.80005556E+01 ,     4.80008333E+01 ,     4.80011667E+01 ,     4.80015667E+01 ,     4.80020467E+01 ,
     4.80026227E+01 ,     4.80033139E+01 ,     4.80041433E+01 ,     4.80051386E+01 ,     4.80063330E+01 ,
     4.80077663E+01 ,     4.80094862E+01 ,     4.80115501E+01 ,     4.80140268E+01 ,     4.80169989E+01 ,
     4.80205653E+01 ,     4.80248450E+01 ,     4.80299807E+01 ,     4.80361435E+01 ,     4.80435389E+01 ,
     4.80524133E+01 ,     4.80630627E+01 ,     4.80758419E+01 ,     4.80911769E+01 ,     4.81095790E+01 ,
     4.81316614E+01 ,     4.81581604E+01 ,     4.81899591E+01 ,     4.82281176E+01 ,     4.82739078E+01 ,
     4.83288560E+01 ,     4.83947939E+01 ,     4.84739193E+01 ,     4.85688698E+01 ,     4.86828105E+01 ,
     4.88195392E+01 ,     4.89836137E+01 ,     4.91805031E+01 ,     4.94167704E+01 ,     4.97002912E+01 ,
     5.00405161E+01 ,     5.04487859E+01 ,     5.09387098E+01 ,     5.15266184E+01 ,     5.22321088E+01 ,
     5.30786972E+01 ,     5.40946033E+01 ,     5.53136906E+01 ,     5.67765954E+01 ,     5.85320812E+01 ,
     6.06386641E+01 ,     6.31665636E+01 ,     6.62000430E+01 ,     6.98402182E+01 ,     7.42084285E+01 ,
     7.94502809E+01 ,     8.20000000E+01 ,     8.75555556E+01 ,     9.31111111E+01 ,     9.86666667E+01 ,
     9.93300000E+01 ,     9.93302778E+01 ,     9.93305556E+01 ,     9.93308333E+01 ,     9.93311667E+01 ,
     9.93315667E+01 ,     9.93320467E+01 ,     9.93326227E+01 ,     9.93333139E+01 ,     9.93341433E+01 ,
     9.93351386E+01 ,     9.93363330E+01 ,     9.93377663E+01 ,     9.93394862E+01 ,     9.93415501E+01 ,
     9.93440268E+01 ,     9.93469989E+01 ,     9.93505653E+01 ,     9.93548450E+01 ,     9.93599807E+01 ,
     9.93661435E+01 ,     9.93735389E+01 ,     9.93824133E+01 ,     9.93930627E+01 ,     9.94058419E+01 ,
     9.94211769E+01 ,     9.94395790E+01 ,     9.94616614E+01 ,     9.94881604E+01 ,     9.95199591E+01 ,
     9.95581176E+01 ,     9.96039078E+01 ,     9.96588560E+01 ,     9.97247939E+01 ,     9.98039193E+01 ,
     9.98988698E+01 ,     1.00012810E+02 ,     1.00149539E+02 ,     1.00313614E+02 ,     1.00510503E+02 ,
     1.00746770E+02 ,     1.01030291E+02 ,     1.01370516E+02 ,     1.01778786E+02 ,     1.02268710E+02 ,
     1.02856618E+02 ,     1.03562109E+02 ,     1.04408697E+02 ,     1.05424603E+02 ,     1.06643691E+02 ,
     1.08106595E+02 ,     1.09862081E+02 ,     1.11968664E+02 ,     1.14496564E+02 ,     1.17530043E+02 ,
     1.21170218E+02 ,     1.23000000E+02 ,     1.27368210E+02 ,     1.32610063E+02 ,     1.38165618E+02 ,
     1.43721174E+02 ,     1.47300000E+02 ,     1.47300278E+02 ,     1.47300333E+02 ,     1.47300400E+02 ,
     1.47300480E+02 ,     1.47300576E+02 ,     1.47300691E+02 ,     1.47300829E+02 ,     1.47300995E+02 ,
     1.47301194E+02 ,     1.47301433E+02 ,     1.47301720E+02 ,     1.47302064E+02 ,     1.47302477E+02 ,
     1.47302972E+02 ,     1.47303566E+02 ,     1.47304280E+02 ,     1.47305136E+02 ,     1.47306163E+02 ,
     1.47307395E+02 ,     1.47308874E+02 ,     1.47310649E+02 ,     1.47312779E+02 ,     1.47315335E+02 ,
     1.47318402E+02 ,     1.47322082E+02 ,     1.47326499E+02 ,     1.47331799E+02 ,     1.47338158E+02 ,
     1.47345790E+02 ,     1.47354948E+02 ,     1.47365938E+02 ,     1.47379125E+02 ,     1.47394951E+02 ,
     1.47413941E+02 ,     1.47436729E+02 ,     1.47464075E+02 ,     1.47496889E+02 ,     1.47536267E+02 ,
     1.47583521E+02 ,     1.47640225E+02 ,     1.47708270E+02 ,     1.47789924E+02 ,     1.47887909E+02 ,
     1.48005490E+02 ,     1.48146588E+02 ,     1.48315906E+02 ,     1.48519087E+02 ,     1.48762905E+02 ,
     1.49055486E+02 ,     1.49406583E+02 ,     1.49827899E+02 ,     1.50333479E+02 ,     1.50940175E+02 ,
     1.51668210E+02 ,     1.52541852E+02 ,     1.53590223E+02 ,     1.54848267E+02 ,     1.56357921E+02 ,
     1.58169505E+02 ,     1.60343406E+02 ,     1.62952087E+02 ,     1.64000000E+02 ,     1.67130417E+02 ,
     1.70886918E+02 ,     1.75394720E+02 ,     1.80804081E+02 ,     1.86359637E+02 ,     1.91915192E+02 ,
     1.93200000E+02 ,     1.93200278E+02 ,     1.93200556E+02 ,     1.93200833E+02 ,     1.93201111E+02 ,
     1.93201389E+02 ,     1.93201722E+02 ,     1.93202122E+02 ,     1.93202602E+02 ,     1.93203178E+02 ,
     1.93203869E+02 ,     1.93204699E+02 ,     1.93205694E+02 ,     1.93206889E+02 ,     1.93208322E+02 ,
     1.93210042E+02 ,     1.93212106E+02 ,     1.93214582E+02 ,     1.93217554E+02 ,     1.93221121E+02 ,
     1.93225401E+02 ,     1.93230536E+02 ,     1.93236699E+02 ,     1.93244094E+02 ,     1.93252969E+02 ,
     1.93263618E+02 ,     1.93276397E+02 ,     1.93291732E+02 ,     1.93310135E+02 ,     1.93332217E+02 ,
     1.93358716E+02 ,     1.93390515E+02 ,     1.93428673E+02 ,     1.93474463E+02 ,     1.93529412E+02 ,
     1.93595349E+02 ,     1.93674475E+02 ,     1.93769425E+02 ,     1.93883366E+02 ,     1.94020095E+02 ,
     1.94184169E+02 ,     1.94381059E+02 ,     1.94617326E+02 ,     1.94900847E+02 ,     1.95241072E+02 ,
     1.95649342E+02 ,     1.96139265E+02 ,     1.96727174E+02 ,     1.97432664E+02 ,     1.98279253E+02 ,
     1.99295159E+02 ,     2.00514246E+02 ,     2.01977151E+02 ,     2.03732637E+02 ,     2.05000000E+02 ,
     2.07106583E+02 ,     2.09634482E+02 ,     2.12667962E+02 ,     2.16308137E+02 ,     2.20676347E+02 ,
     2.25918200E+02 ,     2.31473755E+02 ,     2.37029311E+02 ,     2.40100000E+02 ,     2.40100278E+02 ,
     2.40100556E+02 ,     2.40100833E+02 ,     2.40101111E+02 ,     2.40101389E+02 ,     2.40101722E+02 ,
     2.40102122E+02 ,     2.40102602E+02 ,     2.40103178E+02 ,     2.40103869E+02 ,     2.40104699E+02 ,
     2.40105694E+02 ,     2.40106889E+02 ,     2.40108322E+02 ,     2.40110042E+02 ,     2.40112106E+02 ,
     2.40114582E+02 ,     2.40117554E+02 ,     2.40121121E+02 ,     2.40125401E+02 ,     2.40130536E+02 ,
     2.40136699E+02 ,     2.40144094E+02 ,     2.40152969E+02 ,     2.40163618E+02 ,     2.40176397E+02 ,
     2.40191732E+02 ,     2.40210135E+02 ,     2.40232217E+02 ,     2.40258716E+02 ,     2.40290515E+02 ,
     2.40328673E+02 ,     2.40374463E+02 ,     2.40429412E+02 ,     2.40495349E+02 ,     2.40574475E+02 ,
     2.40669425E+02 ,     2.40783366E+02 ,     2.40920095E+02 ,     2.41084169E+02 ,     2.41281059E+02 ,
     2.41517326E+02 ,     2.41800847E+02 ,     2.42141072E+02 ,     2.42549342E+02 ,     2.43039265E+02 ,
     2.43627174E+02 ,     2.44332664E+02 ,     2.45179253E+02 ,     2.46000000E+02 ,     2.47015906E+02 ,
     2.48234993E+02 ,     2.49697898E+02 ,     2.51453384E+02 ,     2.53559967E+02 ,     2.56087866E+02 ,
     2.59121346E+02 ,     2.62761521E+02 ,     2.67129731E+02 ,     2.72371584E+02 ,     2.77927139E+02 ,
     2.83482695E+02 ,     2.87000000E+02 ,     2.88100000E+02 ,     2.88100278E+02 ,     2.88100611E+02 ,
     2.88101011E+02 ,     2.88101491E+02 ,     2.88102001E+02 ,     2.88102512E+02 ,     2.88103022E+02 ,
     2.88103634E+02 ,     2.88104369E+02 ,     2.88105251E+02 ,     2.88106309E+02 ,     2.88107579E+02 ,
     2.88109103E+02 ,     2.88110931E+02 ,     2.88113125E+02 ,     2.88115758E+02 ,     2.88118918E+02 ,
     2.88122710E+02 ,     2.88127260E+02 ,     2.88132720E+02 ,     2.88139271E+02 ,     2.88147134E+02 ,
     2.88156568E+02 ,     2.88167890E+02 ,     2.88181476E+02 ,     2.88197779E+02 ,     2.88217343E+02 ,
     2.88240819E+02 ,     2.88268991E+02 ,     2.88302797E+02 ,     2.88343365E+02 ,     2.88392046E+02 ,
     2.88450463E+02 ,     2.88520563E+02 ,     2.88604684E+02 ,     2.88705629E+02 ,     2.88826763E+02 ,
     2.88972123E+02 ,     2.89146556E+02 ,     2.89355875E+02 ,     2.89607058E+02 ,     2.89908477E+02 ,
     2.90270181E+02 ,     2.90704225E+02 ,     2.91225078E+02 ,     2.91850101E+02 ,     2.92600130E+02 ,
     2.93500163E+02 ,     2.94580204E+02 ,     2.95876253E+02 ,     2.97431511E+02 ,     2.99297822E+02 ,
     3.01537394E+02 ,     3.04224881E+02 ,     3.07449865E+02 ,     3.11319846E+02 ,     3.12100000E+02 ,
     3.12100278E+02 ,     3.12100611E+02 ,     3.12101011E+02 ,     3.12101491E+02 ,     3.12102067E+02 ,
     3.12102758E+02 ,     3.12103524E+02 ,     3.12104289E+02 ,     3.12105208E+02 ,     3.12106310E+02 ,
     3.12107633E+02 ,     3.12109220E+02 ,     3.12111125E+02 ,     3.12113410E+02 ,     3.12116153E+02 ,
     3.12119444E+02 ,     3.12123394E+02 ,     3.12128133E+02 ,     3.12133820E+02 ,     3.12140645E+02 ,
     3.12148835E+02 ,     3.12158663E+02 ,     3.12170456E+02 ,     3.12184608E+02 ,     3.12201590E+02 ,
     3.12221969E+02 ,     3.12246423E+02 ,     3.12275769E+02 ,     3.12310983E+02 ,     3.12353240E+02 ,
     3.12403949E+02 ,     3.12464800E+02 ,     3.12537821E+02 ,     3.12625445E+02 ,     3.12730595E+02 ,
     3.12856775E+02 ,     3.13008190E+02 ,     3.13189889E+02 ,     3.13407928E+02 ,     3.13669574E+02 ,
     3.13983549E+02 ,     3.14360320E+02 ,     3.14812445E+02 ,     3.15354994E+02 ,     3.16006054E+02 ,
     3.16787325E+02 ,     3.17724851E+02 ,     3.18849882E+02 ,     3.20199919E+02 ,     3.21819964E+02 ,
     3.23764017E+02 ,     3.26096881E+02 ,     3.28000000E+02 ,     3.30799437E+02 ,     3.30900000E+02 ,
     3.30900278E+02 ,     3.30900611E+02 ,     3.30901011E+02 ,     3.30901491E+02 ,     3.30902067E+02 ,
     3.30902758E+02 ,     3.30903588E+02 ,     3.30904583E+02 ,     3.30905777E+02 ,     3.30907053E+02 ,
     3.30908584E+02 ,     3.30910421E+02 ,     3.30912626E+02 ,     3.30915271E+02 ,     3.30918321E+02 ,
     3.30921982E+02 ,     3.30926375E+02 ,     3.30931646E+02 ,     3.30937972E+02 ,     3.30945563E+02 ,
     3.30954671E+02 ,     3.30965602E+02 ,     3.30978719E+02 ,     3.30994459E+02 ,     3.31013347E+02 ,
     3.31036013E+02 ,     3.31063212E+02 ,     3.31095850E+02 ,     3.31135017E+02 ,     3.31182016E+02 ,
     3.31238416E+02 ,     3.31306095E+02 ,     3.31387311E+02 ,     3.31484769E+02 ,     3.31601719E+02 ,
     3.31742060E+02 ,     3.31910468E+02 ,     3.32112558E+02 ,     3.32355066E+02 ,     3.32646075E+02 ,
     3.32995287E+02 ,     3.33414340E+02 ,     3.33917205E+02 ,     3.34520642E+02 ,     3.35244767E+02 ,
     3.36113716E+02 ,     3.37156456E+02 ,     3.38407744E+02 ,     3.39909289E+02 ,     3.41711143E+02 ,
     3.43873368E+02 ,     3.46468038E+02 ,     3.49581642E+02 ,     3.53317966E+02 ,     3.57801556E+02 ,
     3.63181863E+02 ,     3.68737419E+02 ,     3.69000000E+02 ,     3.74555556E+02 ,     3.78900000E+02 ,
     3.78900278E+02 ,     3.78900611E+02 ,     3.78901011E+02 ,     3.78901491E+02 ,     3.78902067E+02 ,
     3.78902758E+02 ,     3.78903588E+02 ,     3.78904583E+02 ,     3.78905777E+02 ,     3.78907211E+02 ,
     3.78908931E+02 ,     3.78910995E+02 ,     3.78913471E+02 ,     3.78915620E+02 ,     3.78918200E+02 ,
     3.78921294E+02 ,     3.78925008E+02 ,     3.78929465E+02 ,     3.78934813E+02 ,     3.78941230E+02 ,
     3.78948931E+02 ,     3.78958172E+02 ,     3.78969262E+02 ,     3.78982569E+02 ,     3.78998538E+02 ,
     3.79017700E+02 ,     3.79040695E+02 ,     3.79068290E+02 ,     3.79101402E+02 ,     3.79141138E+02 ,
     3.79188820E+02 ,     3.79246039E+02 ,     3.79314702E+02 ,     3.79397098E+02 ,     3.79495972E+02 ,
     3.79614621E+02 ,     3.79757001E+02 ,     3.79927856E+02 ,     3.80132882E+02 ,     3.80378913E+02 ,
     3.80674151E+02 ,     3.81028436E+02 ,     3.81453578E+02 ,     3.81963748E+02 ,     3.82575953E+02 ,
     3.83310599E+02 ,     3.84192173E+02 ,     3.85250063E+02 ,     3.86519530E+02 ,     3.88042891E+02 ,
     3.89870925E+02 ,     3.92064564E+02 ,     3.94696932E+02 ,     3.95328700E+02 ,     3.96086822E+02 ,
     3.96996569E+02 ,     3.98088264E+02 ,     3.99398299E+02 ,     4.00970341E+02 ,     4.02856791E+02 ,
     4.05120531E+02 ,     4.07837019E+02 ,     4.10000000E+02 ,     4.13259786E+02 
   ])


   
   rlp_model = rlplib.Rlp2PCubic( rlptbl.Sat.values, 
                                  rlptbl.kr1.values, 
                                  rlptbl.kr2.values, 
                                  lex=0, rex=0 )    
                                  
   cpr_model = rlplib.CubicInterpolator( cprtbl.Sat.values, 
                                         cprtbl.Pc.values, 
                                         lex=0, rex=0 )
   
   model_parameters = dictn(    
        NX                 = 50, 
        core_length        = 4.905, # cm
        core_area          = 11.26, # cm2
        permeability       = 25.3, # mDarcy
        porosity           = 0.292, # v/v
        sw_initial         = 0.075, # v/v
        viscosity_w        = 0.426, # cP
        viscosity_n        = 1.4, # cP
        density_w          = 1098.0, # kg/m3
        density_n          = 782.0, # kg/m3
        rlp_model          = rlp_model,
        cpr_model          = cpr_model,
        time_end           = 410.0, # hour
        gravity_multiplier = 1.0, # 0: horizonal 1: vertical
        verbose            = 0,
        nr_tolerance       = 1e-5,
        max_dsw            = 0.1,
        start_step_size    = 10,
        max_nr_iter        = 10,
        centrifuge_rmid    = 13.6775,  # cm
        flow_direction     = "imbibition",
        acceleration_schedule  = schedule,
        movie_schedule         = movie_schedule, # hour

    )
     
   sns_model = DisplacementModel1D2P(**model_parameters)
    
   results = sns_model.solve().results

   tss = results.tss_table

   sw_ref = np.interp( tss.TIME, reference.TIME.values, reference.Sw.values )

   delta_sw = tss.Sw_avg.values - sw_ref

   assert np.abs(delta_sw).mean() < SW_TOLERANCE
    
# test_centrifuge_drainage2b.py

import numpy as np
import pandas as pd
import scallib001.relpermlib001 as rlplib
from scallib001.displacementmodel1D2P001 import DisplacementModel1D2P 

def setup_and_solve2():
    rlptbl = pd.DataFrame([
    [  3.000000000000E-01,   0.000000000000E+00,   7.063393175400E-01    ],
    [  3.140000000000E-01,   3.684471999500E-07,   6.667009862200E-01    ],
    [  3.280000000000E-01,   5.085216753100E-06,   6.285381123800E-01    ],
    [  3.420000000000E-01,   2.361175316300E-05,   5.918248006400E-01    ],
    [  3.560000000000E-01,   7.018489875700E-05,   5.565350792900E-01    ],
    [  3.700000000000E-01,   1.633881388900E-04,   5.226428984100E-01    ],
    [  3.840000000000E-01,   3.258835533800E-04,   4.901221279600E-01    ],
    [  3.980000000000E-01,   5.842183206100E-04,   4.589465557100E-01    ],
    [  4.120000000000E-01,   9.686745428300E-04,   4.290898851300E-01    ],
    [  4.260000000000E-01,   1.513147304400E-03,   4.005257331400E-01    ],
    [  4.400000000000E-01,   2.255042516900E-03,   3.732276277400E-01    ],
    [  4.540000000000E-01,   3.235189356200E-03,   3.471690055400E-01    ],
    [  4.680000000000E-01,   4.497763873400E-03,   3.223232091600E-01    ],
    [  4.820000000000E-01,   6.090221418100E-03,   2.986634844500E-01    ],
    [  4.960000000000E-01,   8.063236175500E-03,   2.761629776000E-01    ],
    [  5.100000000000E-01,   1.047064655600E-02,   2.547947320300E-01    ],
    [  5.240000000000E-01,   1.336940547800E-02,   2.345316851500E-01    ],
    [  5.380000000000E-01,   1.681953480300E-02,   2.153466648700E-01    ],
    [  5.520000000000E-01,   2.088408331800E-02,   1.972123859600E-01    ],
    [  5.660000000000E-01,   2.562908780500E-02,   1.801014460600E-01    ],
    [  5.800000000000E-01,   3.112353679800E-02,   1.639863215400E-01    ],
    [  5.940000000000E-01,   3.743933671100E-02,   1.488393630200E-01    ],
    [  6.080000000000E-01,   4.465128006300E-02,   1.346327905500E-01    ],
    [  6.220000000000E-01,   5.283701558500E-02,   1.213386884500E-01    ],
    [  6.360000000000E-01,   6.207702000000E-02,   1.089289997900E-01    ],
    [  6.500000000000E-01,   7.245457132800E-02,   9.737552037800E-02    ],
    [  6.640000000000E-01,   8.405572355900E-02,   8.664989227000E-02    ],
    [  6.780000000000E-01,   9.696928258500E-02,   7.672359673200E-02    ],
    [  6.920000000000E-01,   1.112867832600E-01,   6.756794655800E-02    ],
    [  7.060000000000E-01,   1.271024675200E-01,   5.915407767400E-02    ],
    [  7.200000000000E-01,   1.445132634700E-01,   5.145293992300E-02    ],
    [  7.340000000000E-01,   1.636187653300E-01,   4.443528689800E-02    ],
    [  7.480000000000E-01,   1.845212142400E-01,   3.807166468800E-02    ],
    [  7.620000000000E-01,   2.073254798100E-01,   3.233239934300E-02    ],
    [  7.760000000000E-01,   2.321390423700E-01,   2.718758283800E-02    ],
    [  7.900000000000E-01,   2.590719759000E-01,   2.260705725800E-02    ],
    [  8.040000000000E-01,   2.882369315800E-01,   1.856039684400E-02    ],
    [  8.180000000000E-01,   3.197491218400E-01,   1.501688745800E-02    ],
    [  8.320000000000E-01,   3.537263051200E-01,   1.194550287800E-02    ],
    [  8.460000000000E-01,   3.902887709500E-01,   9.314877132800E-03    ],
    [  8.600000000000E-01,   4.295593256300E-01,   7.093271853300E-03    ],
    [  8.740000000000E-01,   4.716632783200E-01,   5.248537167100E-03    ],
    [  8.880000000000E-01,   5.167284275500E-01,   3.748064083300E-03    ],
    [  9.020000000000E-01,   5.648850481800E-01,   2.558725326800E-03    ],
    [  9.160000000000E-01,   6.162658786800E-01,   1.646799958700E-03    ],
    [  9.300000000000E-01,   6.710061087700E-01,   9.778742606500E-04    ],
    [  9.440000000000E-01,   7.292433674900E-01,   5.167058968200E-04    ],
    [  9.580000000000E-01,   7.911177115000E-01,   2.270268679000E-04    ],
    [  9.720000000000E-01,   8.567716137500E-01,   7.123276920300E-05    ],
    [  9.860000000000E-01,   9.263499523800E-01,   9.820107414300E-06    ],
    [  1.000000000000E+00,   1.000000000000E+00,   0.000000000000E+00    ],
    ],
    columns = ['Sat', 'kr1', 'kr2'] );


    cprtbl = pd.DataFrame([
    [  3.000000000000E-01,   8.911528066400E+00    ],
    [  3.140000000000E-01,   5.911562517500E+00    ],
    [  3.280000000000E-01,   4.432218494500E+00    ],
    [  3.420000000000E-01,   3.549546099000E+00    ],
    [  3.560000000000E-01,   2.962509794400E+00    ],
    [  3.700000000000E-01,   2.543584415200E+00    ],
    [  3.840000000000E-01,   2.229437222700E+00    ],
    [  3.980000000000E-01,   1.985031618200E+00    ],
    [  4.120000000000E-01,   1.789403078000E+00    ],
    [  4.260000000000E-01,   1.629234543300E+00    ],
    [  4.400000000000E-01,   1.495658454900E+00    ],
    [  4.540000000000E-01,   1.382540364700E+00    ],
    [  4.680000000000E-01,   1.285500504900E+00    ],
    [  4.820000000000E-01,   1.201327794100E+00    ],
    [  4.960000000000E-01,   1.127614092000E+00    ],
    [  5.100000000000E-01,   1.062517786900E+00    ],
    [  5.240000000000E-01,   1.004606310000E+00    ],
    [  5.380000000000E-01,   9.527484462200E-01    ],
    [  5.520000000000E-01,   9.060389821900E-01    ],
    [  5.660000000000E-01,   8.637449009500E-01    ],
    [  5.800000000000E-01,   8.252662577500E-01    ],
    [  5.940000000000E-01,   7.901072657300E-01    ],
    [  6.080000000000E-01,   7.578546111900E-01    ],
    [  6.220000000000E-01,   7.281609730100E-01    ],
    [  6.360000000000E-01,   7.007323445100E-01    ],
    [  6.500000000000E-01,   6.753181718800E-01    ],
    [  6.640000000000E-01,   6.517036046300E-01    ],
    [  6.780000000000E-01,   6.297033486200E-01    ],
    [  6.920000000000E-01,   6.091567475100E-01    ],
    [  7.060000000000E-01,   5.899238153900E-01    ],
    [  7.200000000000E-01,   5.718820127100E-01    ],
    [  7.340000000000E-01,   5.549236077000E-01    ],
    [  7.480000000000E-01,   5.389535029700E-01    ],
    [  7.620000000000E-01,   5.238874342100E-01    ],
    [  7.760000000000E-01,   5.096504687700E-01    ],
    [  7.900000000000E-01,   4.961757473400E-01    ],
    [  8.040000000000E-01,   4.834034240400E-01    ],
    [  8.180000000000E-01,   4.712797693600E-01    ],
    [  8.320000000000E-01,   4.597564074100E-01    ],
    [  8.460000000000E-01,   4.487896646300E-01    ],
    [  8.600000000000E-01,   4.383400113800E-01    ],
    [  8.740000000000E-01,   4.283715813500E-01    ],
    [  8.880000000000E-01,   4.188517563000E-01    ],
    [  9.020000000000E-01,   4.097508061700E-01    ],
    [  9.160000000000E-01,   4.010415759600E-01    ],
    [  9.300000000000E-01,   3.926992125700E-01    ],
    [  9.440000000000E-01,   3.847009256600E-01    ],
    [  9.580000000000E-01,   3.770257777800E-01    ],
    [  9.720000000000E-01,   3.696544996100E-01    ],
    [  9.860000000000E-01,   3.625693268900E-01    ],
    [  1.000000000000E+00,   3.557538561400E-01    ],
    ],
    columns = ['Sat', 'Pc'] );


    schedule = pd.DataFrame([
    [  0.000000000000E+00,   1.278311162000E+02    ],
    [  5.000000000000E+00,   7.989444762700E+02    ],
    [  1.000000000000E+01,   3.195777905100E+03    ],
    [  1.500000000000E+01,   1.278311162000E+04    ],
    [  2.000000000000E+01,   2.876200114600E+04    ],
    [  2.500000000000E+01,   7.989444762700E+04    ],
    [  3.000000000000E+01,   7.989444762700E+04    ],
    ],
    columns = ['StartTime', 'Acceleration'] );

    rlp_model1 = rlplib.Rlp2PCubic( rlptbl.Sat.values, rlptbl.kr1.values, rlptbl.kr2.values, lex=0, rex=0 )

    cpr_model1 = rlplib.CubicInterpolator( cprtbl.Sat.values, cprtbl.Pc.values, lex=0, rex=0 )

    movie_schedule = np.array([
     2.777777777778E-04,  5.833333333333E-04,  9.194444444444E-04,  1.289166666667E-03,
     1.695861111111E-03,  2.143225000000E-03,  2.635325277778E-03,  3.176635583333E-03,
     3.772076919444E-03,  4.427062389167E-03,  5.147546405861E-03,  5.940078824225E-03,
     6.811864484425E-03,  7.770828710646E-03,  8.825689359488E-03,  9.986036073214E-03,
     1.126241745831E-02,  1.266643698192E-02,  1.421085845789E-02,  1.590972208146E-02,
     1.777847206738E-02,  1.983409705190E-02,  2.209528453487E-02,  2.458259076613E-02,
     2.731862762052E-02,  3.032826816035E-02,  3.363887275417E-02,  3.728053780736E-02,
     4.128636936587E-02,  4.569278408024E-02,  5.053984026604E-02,  5.587160207042E-02,
     6.173654005524E-02,  6.818797183855E-02,  7.528454680018E-02,  8.309077925797E-02,
     9.167763496155E-02,  1.011231762355E-01,  1.115132716368E-01,  1.229423765783E-01,
     1.355143920139E-01,  1.493436089930E-01,  1.645557476701E-01,  1.812891002149E-01,
     1.996957880142E-01,  2.199431445934E-01,  2.422152368305E-01,  2.667145382913E-01,
     2.936637698982E-01,  3.233079246658E-01,  3.559164949102E-01,  3.917859221790E-01,
     4.312422921747E-01,  4.746442991699E-01,  5.223865068647E-01,  5.749029353289E-01,
     6.326710066396E-01,  6.962158850813E-01,  7.661152513672E-01,  8.430045542817E-01,
     9.275827874877E-01,  1.020618844014E+00,  1.122958506193E+00,  1.235532134591E+00,
     1.359363125827E+00,  1.495577216188E+00,  1.645412715584E+00,  1.810231764921E+00,
     1.991532719191E+00,  2.190963768887E+00,  2.410337923554E+00,  2.651649493687E+00,
     2.917092220833E+00,  3.209079220695E+00,  3.530264920542E+00,  3.883569190374E+00,
     4.272203887189E+00,  4.699702053686E+00,  5.000000000000E+00,  5.000277777778E+00,
     5.000583333333E+00,  5.000919444444E+00,  5.001289166667E+00,  5.001695861111E+00,
     5.002143225000E+00,  5.002635325278E+00,  5.003176635583E+00,  5.003772076919E+00,
     5.004427062389E+00,  5.005147546406E+00,  5.005940078824E+00,  5.006811864484E+00,
     5.007770828711E+00,  5.008825689359E+00,  5.009986036073E+00,  5.011262417458E+00,
     5.012666436982E+00,  5.014210858458E+00,  5.015909722081E+00,  5.017778472067E+00,
     5.019834097052E+00,  5.022095284535E+00,  5.024582590766E+00,  5.027318627621E+00,
     5.030328268160E+00,  5.033638872754E+00,  5.037280537807E+00,  5.041286369366E+00,
     5.045692784080E+00,  5.050539840266E+00,  5.055871602070E+00,  5.061736540055E+00,
     5.068187971839E+00,  5.075284546800E+00,  5.083090779258E+00,  5.091677634962E+00,
     5.101123176235E+00,  5.111513271637E+00,  5.122942376578E+00,  5.135514392014E+00,
     5.149343608993E+00,  5.164555747670E+00,  5.181289100215E+00,  5.199695788014E+00,
     5.219943144593E+00,  5.242215236830E+00,  5.266714538291E+00,  5.293663769898E+00,
     5.323307924666E+00,  5.355916494910E+00,  5.391785922179E+00,  5.431242292175E+00,
     5.474644299170E+00,  5.522386506865E+00,  5.574902935329E+00,  5.632671006640E+00,
     5.696215885081E+00,  5.766115251367E+00,  5.843004554282E+00,  5.927582787488E+00,
     6.020618844014E+00,  6.122958506193E+00,  6.235532134591E+00,  6.359363125827E+00,
     6.495577216188E+00,  6.645412715584E+00,  6.810231764921E+00,  6.991532719191E+00,
     7.190963768887E+00,  7.410337923554E+00,  7.651649493687E+00,  7.917092220833E+00,
     8.209079220695E+00,  8.530264920542E+00,  8.883569190374E+00,  9.272203887189E+00,
     9.699702053686E+00,  1.000000000000E+01,  1.000027777778E+01,  1.000058333333E+01,
     1.000091944444E+01,  1.000128916667E+01,  1.000169586111E+01,  1.000214322500E+01,
     1.000263532528E+01,  1.000317663558E+01,  1.000377207692E+01,  1.000442706239E+01,
     1.000514754641E+01,  1.000594007882E+01,  1.000681186448E+01,  1.000777082871E+01,
     1.000882568936E+01,  1.000998603607E+01,  1.001126241746E+01,  1.001266643698E+01,
     1.001421085846E+01,  1.001590972208E+01,  1.001777847207E+01,  1.001983409705E+01,
     1.002209528453E+01,  1.002458259077E+01,  1.002731862762E+01,  1.003032826816E+01,
     1.003363887275E+01,  1.003728053781E+01,  1.004128636937E+01,  1.004569278408E+01,
     1.005053984027E+01,  1.005587160207E+01,  1.006173654006E+01,  1.006818797184E+01,
     1.007528454680E+01,  1.008309077926E+01,  1.009167763496E+01,  1.010112317624E+01,
     1.011151327164E+01,  1.012294237658E+01,  1.013551439201E+01,  1.014934360899E+01,
     1.016455574767E+01,  1.018128910021E+01,  1.019969578801E+01,  1.021994314459E+01,
     1.024221523683E+01,  1.026671453829E+01,  1.029366376990E+01,  1.032330792467E+01,
     1.035591649491E+01,  1.039178592218E+01,  1.043124229217E+01,  1.047464429917E+01,
     1.052238650686E+01,  1.057490293533E+01,  1.063267100664E+01,  1.069621588508E+01,
     1.076611525137E+01,  1.084300455428E+01,  1.092758278749E+01,  1.102061884401E+01,
     1.112295850619E+01,  1.123553213459E+01,  1.135936312583E+01,  1.149557721619E+01,
     1.164541271558E+01,  1.181023176492E+01,  1.199153271919E+01,  1.219096376889E+01,
     1.241033792355E+01,  1.265164949369E+01,  1.291709222083E+01,  1.320907922069E+01,
     1.353026492054E+01,  1.388356919037E+01,  1.427220388719E+01,  1.469970205369E+01,
     1.500000000000E+01,  1.500027777778E+01,  1.500058333333E+01,  1.500091944444E+01,
     1.500128916667E+01,  1.500169586111E+01,  1.500214322500E+01,  1.500263532528E+01,
     1.500317663558E+01,  1.500377207692E+01,  1.500442706239E+01,  1.500514754641E+01,
     1.500594007882E+01,  1.500681186448E+01,  1.500777082871E+01,  1.500882568936E+01,
     1.500998603607E+01,  1.501126241746E+01,  1.501266643698E+01,  1.501421085846E+01,
     1.501590972208E+01,  1.501777847207E+01,  1.501983409705E+01,  1.502209528453E+01,
     1.502458259077E+01,  1.502731862762E+01,  1.503032826816E+01,  1.503363887275E+01,
     1.503728053781E+01,  1.504128636937E+01,  1.504569278408E+01,  1.505053984027E+01,
     1.505587160207E+01,  1.506173654006E+01,  1.506818797184E+01,  1.507528454680E+01,
     1.508309077926E+01,  1.509167763496E+01,  1.510112317624E+01,  1.511151327164E+01,
     1.512294237658E+01,  1.513551439201E+01,  1.514934360899E+01,  1.516455574767E+01,
     1.518128910021E+01,  1.519969578801E+01,  1.521994314459E+01,  1.524221523683E+01,
     1.526671453829E+01,  1.529366376990E+01,  1.532330792467E+01,  1.535591649491E+01,
     1.539178592218E+01,  1.543124229217E+01,  1.547464429917E+01,  1.552238650686E+01,
     1.557490293533E+01,  1.563267100664E+01,  1.569621588508E+01,  1.576611525137E+01,
     1.584300455428E+01,  1.592758278749E+01,  1.602061884401E+01,  1.612295850619E+01,
     1.623553213459E+01,  1.635936312583E+01,  1.649557721619E+01,  1.664541271558E+01,
     1.681023176492E+01,  1.699153271919E+01,  1.719096376889E+01,  1.741033792355E+01,
     1.765164949369E+01,  1.791709222083E+01,  1.820907922069E+01,  1.853026492054E+01,
     1.888356919037E+01,  1.927220388719E+01,  1.969970205369E+01,  2.000000000000E+01,
     2.000027777778E+01,  2.000058333333E+01,  2.000091944444E+01,  2.000128916667E+01,
     2.000169586111E+01,  2.000214322500E+01,  2.000263532528E+01,  2.000317663558E+01,
     2.000377207692E+01,  2.000442706239E+01,  2.000514754641E+01,  2.000594007882E+01,
     2.000681186448E+01,  2.000777082871E+01,  2.000882568936E+01,  2.000998603607E+01,
     2.001126241746E+01,  2.001266643698E+01,  2.001421085846E+01,  2.001590972208E+01,
     2.001777847207E+01,  2.001983409705E+01,  2.002209528453E+01,  2.002458259077E+01,
     2.002731862762E+01,  2.003032826816E+01,  2.003363887275E+01,  2.003728053781E+01,
     2.004128636937E+01,  2.004569278408E+01,  2.005053984027E+01,  2.005587160207E+01,
     2.006173654006E+01,  2.006818797184E+01,  2.007528454680E+01,  2.008309077926E+01,
     2.009167763496E+01,  2.010112317624E+01,  2.011151327164E+01,  2.012294237658E+01,
     2.013551439201E+01,  2.014934360899E+01,  2.016455574767E+01,  2.018128910021E+01,
     2.019969578801E+01,  2.021994314459E+01,  2.024221523683E+01,  2.026671453829E+01,
     2.029366376990E+01,  2.032330792467E+01,  2.035591649491E+01,  2.039178592218E+01,
     2.043124229217E+01,  2.047464429917E+01,  2.052238650686E+01,  2.057490293533E+01,
     2.063267100664E+01,  2.069621588508E+01,  2.076611525137E+01,  2.084300455428E+01,
     2.092758278749E+01,  2.102061884401E+01,  2.112295850619E+01,  2.123553213459E+01,
     2.135936312583E+01,  2.149557721619E+01,  2.164541271558E+01,  2.181023176492E+01,
     2.199153271919E+01,  2.219096376889E+01,  2.241033792355E+01,  2.265164949369E+01,
     2.291709222083E+01,  2.320907922069E+01,  2.353026492054E+01,  2.388356919037E+01,
     2.427220388719E+01,  2.469970205369E+01,  2.500000000000E+01,  2.500027777778E+01,
     2.500058333333E+01,  2.500091944444E+01,  2.500128916667E+01,  2.500169586111E+01,
     2.500214322500E+01,  2.500263532528E+01,  2.500317663558E+01,  2.500377207692E+01,
     2.500442706239E+01,  2.500514754641E+01,  2.500594007882E+01,  2.500681186448E+01,
     2.500777082871E+01,  2.500882568936E+01,  2.500998603607E+01,  2.501126241746E+01,
     2.501266643698E+01,  2.501421085846E+01,  2.501590972208E+01,  2.501777847207E+01,
     2.501983409705E+01,  2.502209528453E+01,  2.502458259077E+01,  2.502731862762E+01,
     2.503032826816E+01,  2.503363887275E+01,  2.503728053781E+01,  2.504128636937E+01,
     2.504569278408E+01,  2.505053984027E+01,  2.505587160207E+01,  2.506173654006E+01,
     2.506818797184E+01,  2.507528454680E+01,  2.508309077926E+01,  2.509167763496E+01,
     2.510112317624E+01,  2.511151327164E+01,  2.512294237658E+01,  2.513551439201E+01,
     2.514934360899E+01,  2.516455574767E+01,  2.518128910021E+01,  2.519969578801E+01,
     2.521994314459E+01,  2.524221523683E+01,  2.526671453829E+01,  2.529366376990E+01,
     2.532330792467E+01,  2.535591649491E+01,  2.539178592218E+01,  2.543124229217E+01,
     2.547464429917E+01,  2.552238650686E+01,  2.557490293533E+01,  2.563267100664E+01,
     2.569621588508E+01,  2.576611525137E+01,  2.584300455428E+01,  2.592758278749E+01,
     2.602061884401E+01,  2.612295850619E+01,  2.623553213459E+01,  2.635936312583E+01,
     2.649557721619E+01,  2.664541271558E+01,  2.681023176492E+01,  2.699153271919E+01,
     2.719096376889E+01,  2.741033792355E+01,  2.765164949369E+01,  2.791709222083E+01,
     2.820907922069E+01,  2.853026492054E+01,  2.888356919037E+01,  2.927220388719E+01,
     2.969970205369E+01,  3.000000000000E+01,    ]);

    model1 = DisplacementModel1D2P(
       NX                        =              100,
       core_length               =   1.00000000E+01,
       core_area                 =   1.91415927E+01,
       permeability              =   1.00000000E+02,
       porosity                  =   2.50000000E-01,
       sw_initial                =   9.99990000E-01,
       viscosity_w               =   1.00000000E+00,
       viscosity_n               =   5.00000000E+00,
       density_w                 =   1.00000000E+03,
       density_n                 =   8.00000000E+02,
       rlp_model                 =       rlp_model1,
       cpr_model                 =       cpr_model1,
       time_end                  =   3.00000000E+01,
       movie_schedule            =   movie_schedule,
       acceleration_schedule     =         schedule,
       centrifuge_rmid           =   2.91420000E+01,
       flow_direction            =       "drainage",
       nr_tolerance              =   1.00000000E-05,
       max_nr_iter               =               10,
       max_dsw                   =   1.00000000E-01,
    );
    model1.prepare();
    results = model1.solve().results;
    return model1


def test_drainage_tss_table(RTOL=0.001):

    results = setup_and_solve2().results

    # check that simulation results are identical to reference simulation

    # date of creation 12/07/2025, 14:45:09
    
    tss_table = results.tss_table
    
    assert np.allclose( tss_table.TIME           .values[-1],   3.000000000000E+01, rtol=RTOL)
    assert np.allclose( tss_table.DTIME          .values[-1],   3.002979463143E-01, rtol=RTOL)
    assert np.allclose( tss_table.PVinj          .values[-1],   3.761442493475E+01, rtol=RTOL)
    assert np.allclose( tss_table.tD             .values[-1],   3.761442493475E+01, rtol=RTOL)
    assert np.allclose( tss_table.dtD            .values[-1],   3.765178186567E-01, rtol=RTOL)
    assert np.allclose( tss_table.InjRate        .values[-1],   8.486675156746E-04, rtol=RTOL)
    assert np.allclose( tss_table.PVInjRate      .values[-1],   1.773452253495E-05, rtol=RTOL)
    assert np.allclose( tss_table.FracFlowInj    .values[-1],   0.000000000000E+00, rtol=RTOL)
    assert np.allclose( tss_table.FracFlowPrd    .values[-1],   8.486674866550E-04, rtol=RTOL)
    assert np.allclose( tss_table.WATERInj       .values[-1],   0.000000000000E+00, rtol=RTOL)
    assert np.allclose( tss_table.OILInj         .values[-1],   8.486675156746E-04, rtol=RTOL)
    assert np.allclose( tss_table.WATERProd      .values[-1],   8.486674866550E-04, rtol=RTOL)
    assert np.allclose( tss_table.OILProd        .values[-1],   7.680339620921E-12, rtol=RTOL)
    assert np.allclose( tss_table.CumWATERInj    .values[-1],   0.000000000000E+00, rtol=RTOL)
    assert np.allclose( tss_table.CumOILInj      .values[-1],   3.069066673595E+01, rtol=RTOL)
    assert np.allclose( tss_table.CumWATER       .values[-1],   3.069066692336E+01, rtol=RTOL)
    assert np.allclose( tss_table.CumOIL         .values[-1],   4.901862080055E-07, rtol=RTOL)
   #assert np.allclose( tss_table.P_inj          .values[-1],   1.197937665134E+04, rtol=RTOL)
   #assert np.allclose( tss_table.P_inj_wat      .values[-1],  -6.185131217409E+00, rtol=RTOL)
   #assert np.allclose( tss_table.P_inj_oil      .values[-1],   1.160919801942E-01, rtol=RTOL)
   #assert np.allclose( tss_table.P_prod         .values[-1],   6.395444304398E+01, rtol=RTOL)
   #assert np.allclose( tss_table.P_prod_wat     .values[-1],   6.395451791692E+01, rtol=RTOL)
   #assert np.allclose( tss_table.P_prod_oil     .values[-1],   6.431027177306E+01, rtol=RTOL)
    assert np.allclose( tss_table.delta_P        .values[-1],   1.191542220830E+04, rtol=RTOL)
    assert np.allclose( tss_table.delta_P_w      .values[-1],  -7.013964913432E+01, rtol=RTOL)
    assert np.allclose( tss_table.delta_P_o      .values[-1],  -6.419417979287E+01, rtol=RTOL)
    assert np.allclose( tss_table.Sw_avg         .values[-1],   3.586501181134E-01, rtol=RTOL)
    assert np.allclose( tss_table.Acceleration   .values[-1],   7.989444762700E+04, rtol=RTOL)
    assert (1156 < results.movie_nr.sum()) & (results.movie_nr.sum() < 1277)


